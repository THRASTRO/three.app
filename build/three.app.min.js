/* autogenerated by webmerge (compile context) */
;
/*
ThreeApp Framework (https://github.com/mgreter/three.app)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
(function(g,b){function d(a,c){for(var e=a.split(/\./),k=d,h=0;h<e.length-1;h++)k[e[h]]||(k[e[h]]={}),k=k[e[h]];if(1==arguments.length)return k[e[h]];var f=typeof k[e[h]];if("object"==f){var f=k[e[h]],b;for(b in f)f.hasOwnProperty(b)&&(c[b]=f[b])}else if("undefined"!=f)throw Error("Namespace already taken!");return k[e[h]]=c}function a(){var c,b=!1,e=0,d=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(b=arguments[0],e++);for(c=arguments[e++];e<d;e++){var h=arguments[e],
f=void 0;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&(b&&"[object Object]"===Object.prototype.toString.call(h[f])?c[f]=a(!0,c[f],h[f]):b&&h[f]instanceof Array?("undefined"==typeof c[f]&&(c[f]=[]),c[f]=c[f].concat(h[f])):c[f]=h[f])}return c}b=g.THREEAPP;if("object"==typeof b)for(var c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);d("extend",a);d("mixin",function(c,b){if(!b||!c)debugger;c=c.prototype;b=b.prototype;for(var e in b)b.hasOwnProperty(e)&&(b[e]instanceof Array?(c[e]||(c[e]=[]),c[e]=c[e].concat(b[e])):
b[e]instanceof Function?(c[e]=b[e],a(c[e],b[e])):b[e]instanceof Object?(c[e]||(c[e]={}),a(!0,c[e],b[e])):c[e]=b[e])});d("tmpl",function(a,c){return a.replace(/%([a-zA-Z][a-zA-Z0-9]*)%/g,function(a,b){return c[b]?c[b]:"[%"+b+"%]"})});g.THREEAPP=d})(self,THREE);
(function(g,b){function d(a,c){}function a(){for(var a={},c=this.ctor,b=0;b<c.length;b++)a[c[b]]||(c[b].apply(this,arguments),a[c[b]]=!0);c=this.init;this.__proto__.wait=n;for(b=0;b<c.length;b++)a[c[b]]||(c[b].apply(this,arguments),a[c[b]]=!0)}function c(){if(0<this.pending)return this;delete this.__proto__.wait;for(var a=0;a<this.ready.length;a++)this.ready[a].apply(this,arguments);if(this.listeners)for(var c=this.listeners.ready||[],a=0;a<c.length;a++)c[a].apply(this,arguments);delete this.pending;
this.isReady=!0;return this}function l(a,c,d){c||(c=b.Class);Array.isArray(d)||(d=[d]);if(!d)throw Error("Undefined mixin!");a.prototype.ctor||(a.prototype.ctor=[]);a.prototype.init||(a.prototype.init=[]);a.prototype.ready||(a.prototype.ready=[]);a.prototype.defaults||(a.prototype.defaults={});a.prototype.listeners||(a.prototype.listeners={});if(d&&d.length)for(var f=0,g=d.length;f<g;f++){if(!d[f])throw Error("Undefined mixin!");if(!(d[f]instanceof Function)){var l=b(d[f]);if("undefined"==typeof l)throw Error("Unknown mixin: "+
d[f]);d[f]=l}}a.prototype.listeners=b.extend(!0,{},a.prototype.listeners);for(f=0;f<d.length;f++)b.mixin(a,d[f]);b.mixin(a,c);c&&(a.prototype.__proto__=c.prototype);a.static=function(c,b){a[c]=b;return this};a.method=function(c,b){a.prototype[c]=b;return this};a.proto=function(c,b){a.prototype[c](b);return this};a.defaults=function(c){b.extend(a.prototype.defaults,c);return this};a.ctor=function(c){a.prototype.ctor.push(c);return this};a.init=function(c){a.prototype.init.push(c);return this};a.ready=
function(c){a.prototype.ready.push(c);return this};a.listen=function(c,b){var d=a.prototype.listeners;d[c]||(d[c]=[]);d[c].push(b);"ready"==c&&this.isReady&&b.call(this);return this};return a}function n(a){function b(){--f.pending;c.apply(f)}function d(a){throw a;}var f=this;f.pending++;if(!a)debugger;if("function"==typeof a.listen)a.listen("ready",b);else if("function"==typeof a.then)a.then(b,d);else throw Error("Invalid wait promise");return c.apply(f)}d.create=function(){var e="string"==typeof arguments[0]?
[].shift.call(arguments):null,g=arguments[0]||d,h=arguments[1]||[],f=function(){this.pending=0;this.options=b.extend({},this.defaults);a.apply(this,arguments);c.apply(this,arguments)};e&&eval("Klass = "+f.toString().replace(/\(\)/,e+"()"));return l.call(d,f,g,h)};d.mixin=function(a){1>arguments.length&&(a=[]);return l.call(d,function(){throw Error("Can't instantiate mixins");},null,a)};d.virtual=function(a,c){0==arguments.length&&(a=d);if(!a)throw Error("Undefined virtual base!");2>arguments.length&&
(c=[]);return l.call(d,function(){throw Error("cannot instantiate virtual class");},a,c)};d.prototype.constructor=d;b("Class",d)})(THREE,THREEAPP);(function(g,b){g=b.Class.mixin().ctor(function(d,a){this.app=d;b.extend(this.options,a)});b("Options",g)})(THREE,THREEAPP);
(function(g,b){function d(a,c){return(c.prio||0)-(a.prio||0)}g=b.Class.mixin(["Options"]).ctor(function(a,c){this.listeners=b.extend(!0,{},this.listeners,this.options.listeners);this.deferred={}}).method("listen",function(a,c){"ready"==a&&this.isReady&&c.call(this);this.listeners.hasOwnProperty(a)||(this.listeners[a]=[]);a=this.listeners[a];-1==a.indexOf(c)&&a.push(c);a.sort(d)}).method("invoke",function(a){for(var c=Array.prototype.slice.call(arguments,1),b=this.listeners[a],d=0,e=b?b.length:0;d<
e;d++)b[d].apply(this,c);this.deferred[a]=!1}).method("trigger",function(a){var c=this;if(!c.deferred[a]){var b=Array.prototype.slice.call(arguments,1);c.deferred[a]=window.setTimeout(function(){for(var d=c.listeners[a],e=0,g=d?d.length:0;e<g;e++)d[e].apply(c,b);c.deferred[a]=!1},0)}});b("Events",g)})(THREE,THREEAPP);
(function(g,b){g=b.Class.mixin(["Events"]).method("required",[]).method("provided",{}).method("requires",function(b){Array.isArray(b)?this.required=this.required.concat(b):this.required.push(b);return this}).method("provides",function(b){var a=this.provided;Array.isArray(b)||(b=[b]);for(var c=0,g=b.length;c<g;++c){if(a.hasOwnProperty(b[c]))throw Error("Duplicate service provider");a[b[c]]=!0}return this});b("Plugin",g)})(THREE,THREEAPP);
(function(g,b){var d=b.Class.virtual(g.Object3D).ctor(function(a,c){g.Object3D.call(this);this.sortObjects=this.matrixAutoUpdate=!0});b("Object3D",d)})(THREE,THREEAPP);(function(){var g=THREEAPP.Class.virtual(THREE.Scene).ctor(function(b,d){THREE.Scene.call(this)});THREEAPP("Scene",g)})();
(function(g,b){var d=b.Class.create("Clock",null,["Plugin"]).proto("provides","time").proto("provides","clock").ctor(function(a){a.time=0;a.clock=new g.Clock(!1);a.clock.speed=1/3600;a.listen("clock.pause",function(){a.clock.stop();a.clock.paused=!0;a.trigger("clock.adjusted")});a.listen("clock.resume",function(){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});a.listen("clock.faster",function(){a.clock.speed*=2;a.trigger("clock.adjusted")});a.listen("clock.slower",function(){a.clock.speed/=
2;a.trigger("clock.adjusted")});a.listen("clock.reverse",function(){a.clock.speed*=-1;a.trigger("clock.adjusted")});a.listen("clock.reset",function(){a.clock.speed=1/3600;a.trigger("clock.adjusted")});a.listen("preframe",function(){var c=a.clock.getDelta();a.time+=c*a.clock.speed});a.clock.setSpeed=function(c){a.clock.speed=c;a.trigger("clock.adjusted")}}).ready(function(a){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});b("Plugin.Clock",d)})(THREE,THREEAPP);
(function(g,b){var d=b.Class.create("Scene",null,["Plugin"]).proto("provides","scene").ctor(function(a){a.scene=a.options.scene?new a.options.scene(a):new g.Scene(a)});b("Plugin.Scene",d)})(THREE,THREEAPP);
(function(g,b){function d(a){a.resize(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)}g=b.Class.create("AutoSize",null,["Plugin"]).ctor(function(a){addEventListener("resize",function(){d(a)},!0);d(a)});b("Plugin.AutoSize",g)})(THREE,THREEAPP);
(function(g,b){var d=b.Class.create("WebGLRenderer",null,["Plugin"]).proto("provides","renderer").ctor(function(a){a.renderer=new g.WebGLRenderer({sortObjects:!0,antialias:!0,precision:"highp",alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0,logarithmicDepthBuffer:!0});a.renderer.autoClear=!1;a.listen("resized",function(){a.renderer.setSize(a.width,a.height)});a.renderer.setSize(a.width,a.height);a.viewport.appendChild(a.renderer.domElement);a.listen("preframe",function(){a.renderer.clear()});
a.listen("render",function(){a.invoke("render-scene");a.renderer.render(a.scene,a.camera)})});b("Plugin.WebGLRenderer",d)})(THREE,THREEAPP);
(function(g,b){var d=b.Class.create("PerspectiveCamera",null,["Plugin"]).proto("provides","camera").ctor(function(a){a.camera=new g.PerspectiveCamera(this.options.fov||65,a.width/a.height,this.options.near||1E-6,this.options.far||1E20);a.camera.position.x=1E-11;a.listen("resized",function(){a.camera.aspect=a.width/a.height;a.camera.updateProjectionMatrix()})});b("Plugin.PerspectiveCamera",d)})(THREE,THREEAPP);
(function(g,b){var d=b.Class.create("TrackballControls",null,["Plugin"]).proto("requires","camera").proto("requires","renderer").ctor(function(a){a.controls=new g.TrackballControls(a.camera,a.renderer.domElement);a.listen("preframe",function(){a.controls.update()})});b("Plugin.TrackballControls",d)})(THREE,THREEAPP);
(function(g,b,d){var a=requestAnimationFrame;g=d.Class.create("ThreeApp",null,["Events"]).ctor(function(a,b){this.frames=9999;this.viewport=a;d.extend(this.options,b)}).init(function(a){a=this;for(var b=this.options.plugins||[],d=[].concat(b),e=0;e<d.length;){var g=d[e].prototype.required;if(g&&g.length)++e;else{g=d.splice(e,1)[0];if(g.prototype.provided){for(var h=g.prototype.provided,f=0;f<d.length;f++)for(var p in h){var e=d[f].prototype.required,m=(e||[]).indexOf(p);-1!=m&&e.splice(m,1)}e=0}b[f]=
new g(this)}}if(d.length){for(f=0;f<d.length;f++)a=d[f].name,e=d[f].prototype.required,console.warn(a,"is missing",e);throw Error("Missing or circular dependencies");}a.plugins=b}).ready(function(){var a=this;this.options.start&&window.setTimeout(function(){a.start()},0)}).method("start",function(){var b=this;b.started||b.paused||(a(function(){b.render.call(b)}),b.started=!0)}).method("resize",function(a,b){this.width=a;this.height=b;this.invoke("resized")}).method("render",function(){var b=this;
b.invoke("preframe");b.invoke("render");b.invoke("postframe");b.started&&a(function(){b.render.call(b)});++b.frames});d("App",g)})(self,THREE,THREEAPP);

/* crc: 2CC85B940D3855AE7D7895E1888C839E */
