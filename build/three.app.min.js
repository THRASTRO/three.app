/* autogenerated by webmerge (compile context) */
;
/*
ThreeApp Framework (https://github.com/mgreter/three.app)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
(function(c,d){function b(a,e){for(var h=a.split(/\./),d=b,c=0;c<h.length-1;c++)d[h[c]]||(d[h[c]]={}),d=d[h[c]];if(1==arguments.length)return d[h[c]];var g=typeof d[h[c]];if("object"==g){var g=d[h[c]],r;for(r in g)g.hasOwnProperty(r)&&(e[r]=g[r])}else if("undefined"!=g)throw Error("Namespace already taken!");return d[h[c]]=e}function a(){var b,e=!1,h=0,c=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],h++);for(b=arguments[h++];h<c;h++){var d=arguments[h],
g=void 0;for(g in d)Object.prototype.hasOwnProperty.call(d,g)&&(e&&"[object Object]"===Object.prototype.toString.call(d[g])?b[g]=a(!0,b[g],d[g]):e&&d[g]instanceof Array?("undefined"==typeof b[g]&&(b[g]=[]),b[g]=b[g].concat(d[g])):b[g]=d[g])}return b}d=c.THREEAPP;if("object"==typeof d)for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e]);b("extend",a);b("mixin",function(b,e){if(!e||!b)debugger;b=b.prototype;e=e.prototype;for(var h in e)e.hasOwnProperty(h)&&(e[h]instanceof Array?(b[h]||(b[h]=[]),b[h]=b[h].concat(e[h])):
e[h]instanceof Function?(b[h]=e[h],a(b[h],e[h])):e[h]instanceof Object?(b[h]||(b[h]={}),a(!0,b[h],e[h])):b[h]=e[h])});b("tmpl",function(a,b){return a.replace(/%([a-zA-Z][a-zA-Z0-9]*)%/g,function(a,e){return b[e]?b[e]:"[%"+e+"%]"})});c.THREEAPP=b})(self,THREE);
(function(c,d){function b(a,b){}function a(){for(var a={},b=this.ctor,e=0;e<b.length;e++)a[b[e]]||(b[e].apply(this,arguments),a[b[e]]=!0);b=this.init;this.__proto__.wait=t;for(e=0;e<b.length;e++)a[b[e]]||(b[e].apply(this,arguments),a[b[e]]=!0)}function e(){if(0<this.pending)return this;delete this.__proto__.wait;for(var a=0;a<this.ready.length;a++)this.ready[a].apply(this,arguments);if(this.listeners)for(var b=this.listeners.ready||[],a=0;a<b.length;a++)b[a].apply(this,arguments);delete this.pending;
this.isReady=!0;return this}function l(a,b,e){b||(b=d.Class);Array.isArray(e)||(e=[e]);if(!e)throw Error("Undefined mixin!");a.prototype.ctor||(a.prototype.ctor=[]);a.prototype.init||(a.prototype.init=[]);a.prototype.ready||(a.prototype.ready=[]);a.prototype.defaults||(a.prototype.defaults={});a.prototype.listeners||(a.prototype.listeners={});if(e&&e.length)for(var c=0,t=e.length;c<t;c++){if(!e[c])throw Error("Undefined mixin!");if(!(e[c]instanceof Function)){var l=d(e[c]);if("undefined"==typeof l)throw Error("Unknown mixin: "+
e[c]);e[c]=l}}a.prototype.listeners=d.extend(!0,{},a.prototype.listeners);for(c=0;c<e.length;c++)d.mixin(a,e[c]);d.mixin(a,b);b&&(a.prototype.__proto__=b.prototype);a.static=function(b,e){a[b]=e;return this};a.method=function(b,e){a.prototype[b]=e;return this};a.proto=function(b,e){a.prototype[b](e);return this};a.defaults=function(b){d.extend(a.prototype.defaults,b);return this};a.ctor=function(b){a.prototype.ctor.push(b);return this};a.init=function(b){a.prototype.init.push(b);return this};a.ready=
function(b){a.prototype.ready.push(b);return this};a.listen=function(b,e,c){var d=a.prototype.listeners;d[b]||(d[b]=[]);null!=c&&(e.prio=c);d[b].push(e);"ready"==b&&this.isReady&&e.call(this);return this};return a}function t(a){function b(){--d.pending;e.apply(d)}function c(a){throw a;}var d=this;d.pending++;if(!a)throw Error("Invalid wait call");if("function"==typeof a.listen)a.listen("ready",b);else if("function"==typeof a.then)a.then(b,c);else throw Error("Invalid wait promise");return e.apply(d)}
b.create=function(){var c="string"==typeof arguments[0]?[].shift.call(arguments):null,t=arguments[0]||b,q=arguments[1]||[],g=function(){this.pending=0;this.options=d.extend({},this.defaults);a.apply(this,arguments);e.apply(this,arguments)};c&&eval("Klass = "+g.toString().replace(/\(\)/,c+"()"));return l.call(b,g,t,q)};b.mixin=function(a){1>arguments.length&&(a=[]);return l.call(b,function(){throw Error("Can't instantiate mixins");},null,a)};b.virtual=function(a,e){0==arguments.length&&(a=b);if(!a)throw Error("Undefined virtual base!");
2>arguments.length&&(e=[]);return l.call(b,function(){throw Error("cannot instantiate virtual class");},a,e)};b.prototype.constructor=b;d("Class",b)})(THREE,THREEAPP);(function(c,d){c=d.Class.mixin().ctor(function(b,a){this.app=b;d.extend(this.options,a)});d("Options",c)})(THREE,THREEAPP);
(function(c,d){function b(a,b){return(b.prio||0)-(a.prio||0)}c=d.Class.mixin(["Options"]).ctor(function(a,b){this.listeners=d.extend(!0,{},this.listeners,this.options.listeners);this.deferred={}}).method("listen",function(a,e,c){"ready"==a&&this.isReady&&e.call(this);null!=c&&(e.prio=c);this.listeners.hasOwnProperty(a)||(this.listeners[a]=[]);a=this.listeners[a];-1==a.indexOf(e)&&a.push(e);a.sort(b)}).method("invoke",function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.listeners[a],
d=0,h=c?c.length:0;d<h;d++)c[d].apply(this,b);this.deferred[a]=!1}).method("trigger",function(a){var b=this;if(!b.deferred[a]){var c=Array.prototype.slice.call(arguments,1);b.deferred[a]=window.setTimeout(function(){for(var d=b.listeners[a],h=0,p=d?d.length:0;h<p;h++)d[h].apply(b,c);b.deferred[a]=!1},0)}});d("Events",c)})(THREE,THREEAPP);
(function(c,d){c=d.Class.mixin(["Events"]).method("required",[]).method("provided",{}).method("requires",function(b){Array.isArray(b)?this.required=this.required.concat(b):this.required.push(b);return this}).method("provides",function(b){var a=this.provided;Array.isArray(b)||(b=[b]);for(var e=0,c=b.length;e<c;++e){if(a.hasOwnProperty(b[e]))throw Error("Duplicate service provider");a[b[e]]=!0}return this});d("Plugin",c)})(THREE,THREEAPP);
(function(c,d){function b(a){for(var b in a)this.resources[b]=a[b]}function a(a,b){return this.assets[a]?this.assets[a][2].data:b}var e={},l=d.Class.mixin(["Options","Events"]).ctor(function(a,c){this.assets={};this.prefetch=b;a.resources=e;this.resources=jQuery.extend({},this.resources,this.options.resources);a.listen("loader.complete",function(a,b){for(var e=a.cbs.length,c=0;c<e;c++)a.cbs[c].assets[2]=a,a.cbs[c].resolve&&a.cbs[c].resolve(),a.complete=!0,a.data=b})}).init(function(a){var b=this,
e=b.resources,d;for(d in e){var g=e[d][0],l=e[d][1];this.assets[d]=e[d];if(a.resources[l]){var m={obj:this,assets:e[d]};a.resources[l].complete?e[d][2]=a.resources[l]:this.wait(new Promise(function(b,e){m.reject=e;m.resolve=b;a.resources[l].cbs.push(m)}))}else{var g=g.substr(0,1).toUpperCase(),n;if("S"==g)n=new c.TextLoader(a.manager);else if("I"==g)n=new c.ImageLoader(a.manager);else if("T"==g)n=new c.BlobLoader(a.manager);else if("J"==g)n=new c.JsonLoader(a.manager);else if("A"==g)n=new c.ArrayLoader(a.manager);
else if("B"==g)n=new c.BlobLoader(a.manager);else if("R"==g)n=new c.BinaryLoader(a.manager);else if("O"==g)n=new c.ObjectLoader(a.manager);else if("L"==g)n=new c.OBJLoader(a.manager);else throw"Unknown loader type for resource";m={obj:this,assets:e[d]};this.wait(new Promise(function(e,d){m.reject=d;m.resolve=e;a.resources[l]={total:0,loaded:0,cbs:[m]};(function(e,l,g){var p=function(e){a.invoke("loader.progress",b,g,e)};"T"==e?n.load(l,function(){n=new c.TextureLoader(a.manager);n.load(l,function(b){"T"==
e&&(a.loader.texLoaded+=1);a.invoke("loader.complete",g,b)},p,d);a.loader.texLoading+=1},p,d):n.load(l,function(b){a.invoke("loader.complete",g,b)},p,d)})(g,l,a.resources[l])}))}}}).ready(function(){this.asset=a}).listen("ready",function(){this.options.container&&this.options.container.add(this)});d("Resources",l)})(THREE,THREEAPP);THREE.ArrayLoader=function(c){this.manager=void 0!==c?c:THREE.DefaultLoadingManager};
THREE.ArrayLoader.prototype={constructor:THREE.ArrayLoader,load:function(c,d,b,a){var e=this.manager,l=e.app,e=new THREE.FileLoader(e);c.match(/\.lzma$/)?(e.setResponseType("arraybuffer"),e.load(c,function(b){l.wlzma.decode(b).then(function(a){a=a.toUint8Array();d.call(this,a.buffer)}).catch(a)},b,a)):(e.setResponseType("arraybuffer"),e.load(c,d,b,a))}};THREE.BlobLoader=function(c){this.manager=void 0!==c?c:THREE.DefaultLoadingManager};
THREE.BlobLoader.prototype={constructor:THREE.BlobLoader,load:function(c,d,b,a){var e=this.manager,l=e.app,e=new THREE.FileLoader(e);c.match(/\.lzma$/)?(e.setResponseType("arraybuffer"),e.load(c,function(b){l.wlzma.decode(b).then(function(a){a=new Blob(a.buffers);if("object"!=typeof a)throw Error("Invalid BLOB");d.call(this,a)}).catch(a)},b,a)):(e.setResponseType("blob"),e.load(c,function(a){if(a)return d.apply(this,arguments);throw Error("Invalid BLOB");},b,a))}};
THREE.DataLoader=function(c){this.manager=void 0!==c?c:THREE.DefaultLoadingManager};
THREE.DataLoader.prototype={constructor:THREE.DataLoader,load:function(c,d,b,a){var e=this.manager,l=e.app,e=new THREE.FileLoader(e);c.match(/\.lzma$/)?(e.setResponseType("arraybuffer"),e.load(c,function(b){l.wlzma.decode(b).then(function(a){a=JSON.parse(a);if("object"!=typeof a)throw Error("Invalid JSON");d.call(this,a)}).catch(a)},b,a)):(e.setResponseType("json"),e.load(c,function(a){if(a)return d.apply(this,arguments);throw Error("Invalid JSON");},b,a))}};
THREE.JsonLoader=function(c){this.manager=void 0!==c?c:THREE.DefaultLoadingManager};
THREE.JsonLoader.prototype={constructor:THREE.JsonLoader,load:function(c,d,b,a){var e=this.manager,l=e.app,e=new THREE.FileLoader(e);c.match(/\.lzma$/)?(e.setResponseType("arraybuffer"),e.load(c,function(b){l.wlzma.decode(b).then(function(a){a=JSON.parse(a);if("object"!=typeof a)throw Error("Invalid JSON");d.call(this,a)}).catch(a)},b,a)):(e.setResponseType("json"),e.load(c,function(a){if(a)return d.apply(this,arguments);throw Error("Invalid JSON");},b,a))}};
THREE.TextLoader=function(c){this.manager=void 0!==c?c:THREE.DefaultLoadingManager};THREE.TextLoader.prototype={constructor:THREE.TextLoader,load:function(c,d,b,a){var e=this.manager.app,l=new THREE.FileLoader(this.manager);c.match(/\.lzma$/)?(l.setResponseType("arraybuffer"),l.load(c,function(b){e.wlzma.decode(b).then(function(a){a=a.toString();if("string"!=typeof a)throw Error("Invalid Text");d.call(this,a)}).catch(a)},b,a)):(l.setResponseType("text"),l.load(c,d,b,a))}};
(function(c,d){var b=d.Class.virtual(c.Object3D).ctor(function(a,b){c.Object3D.call(this);this.sortObjects=this.matrixAutoUpdate=!0});d("Object3D",b)})(THREE,THREEAPP);(function(){var c=THREEAPP.Class.virtual(THREE.Scene).ctor(function(c,b){THREE.Scene.call(this)});THREEAPP("Scene",c)})();
(function(c,d){c=d.Class.virtual(d.Object3D,["Events"]).ctor(function(b,a){this.lod=[]}).ready(function(b){b.lods.push(this);this.trigger("lod")}).listen("lod",function(){if(this.current!=this.level&&-1!=this.level){if(!this.lod[this.level]){var b=this.options.lod[this.level],a={},e;for(e in this.options.resources){var c=this.options.resources[e];a[e]=[c[0],d.tmpl(c[1],b)]}b=d.extend({},this.options,b,{resources:a,container:this});this.lod[this.level]=new this.options.ctor(this.app,b)}this.lod[this.level].isReady&&
(this.lod[this.current]&&this.remove(this.lod[this.current]),this.add(this.lod[this.level]),this.current=this.level)}});d("LOD",c)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("Clock",null,["Plugin"]).proto("provides","time").proto("provides","clock").ctor(function(a){a.time=0;a.clock=new c.Clock(!1);a.clock.speed=1/3600;a.listen("clock.pause",function(){a.clock.stop();a.clock.paused=!0;a.trigger("clock.adjusted")});a.listen("clock.resume",function(){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});a.listen("clock.faster",function(){a.clock.speed*=2;a.trigger("clock.adjusted")});a.listen("clock.slower",function(){a.clock.speed/=
2;a.trigger("clock.adjusted")});a.listen("clock.reverse",function(){a.clock.speed*=-1;a.trigger("clock.adjusted")});a.listen("clock.reset",function(){a.clock.speed=1/3600;a.trigger("clock.adjusted")});a.listen("preframe",function(){var b=a.clock.getDelta();a.time+=b*a.clock.speed});a.clock.setSpeed=function(b){a.clock.speed=b;a.trigger("clock.adjusted")}}).ready(function(a){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});d("Plugin.Clock",b)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("Scene",null,["Plugin"]).proto("provides","scene").ctor(function(a){a.scene=a.options.scene?new a.options.scene(a):new c.Scene(a)});d("Plugin.Scene",b)})(THREE,THREEAPP);
(function(c,d){function b(a){a.resize(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)}c=d.Class.create("AutoSize",null,["Plugin"]).ctor(function(a){addEventListener("resize",function(){b(a)},!0);b(a)});d("Plugin.AutoSize",c)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("WebGLRenderer",null,["Plugin"]).proto("provides","renderer").ctor(function(a){a.renderer=new c.WebGLRenderer({sortObjects:!0,antialias:!0,precision:"highp",alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0,logarithmicDepthBuffer:!0});a.renderer.autoClear=!1;a.listen("resized",function(){a.renderer.setSize(a.width,a.height)});a.renderer.setSize(a.width,a.height);a.viewport.appendChild(a.renderer.domElement);a.listen("preframe",function(){a.renderer.clear()});
a.listen("render",function(){a.invoke("render-scene");a.renderer.render(a.scene,a.camera)})});d("Plugin.WebGLRenderer",b)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("PerspectiveCamera",null,["Plugin"]).proto("provides","camera").ctor(function(a){a.camera=new c.PerspectiveCamera(this.options.fov||65,a.width/a.height,this.options.near||1E-6,this.options.far||1E20);a.camera.position.x=1E-11;a.listen("resized",function(){a.camera.aspect=a.width/a.height;a.camera.updateProjectionMatrix()})});d("Plugin.PerspectiveCamera",b)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("TrackballControls",null,["Plugin"]).proto("requires","camera").proto("requires","renderer").ctor(function(a){a.controls=new c.TrackballControls(a.camera,a.renderer.domElement);a.listen("preframe",function(){a.controls.update()})});d("Plugin.TrackballControls",b)})(THREE,THREEAPP);
(function(c,d){function b(a,b){for(var e=a.cbs.length,c=0;c<e;c++)a.cbs[c].assets[2]=a,a.cbs[c].resolve&&a.cbs[c].resolve(),a.complete=!0,a.data=b}function a(){this.invoke("fetch.error",{})}function e(){1==++this.loader.completed&&this.trigger("prefetch.complete",this.loader);this.trigger("fetch.complete",this.loader)}function l(a){var b=this.loader;b.filesTotal=a[2]-b.texLoading;b.filesLoaded=a[1]-b.texLoaded;this.trigger("fetch.progress",{filesTotal:b.filesTotal,filesLoaded:b.filesLoaded,bytesTotal:b.bytesTotal,
bytesLoaded:b.bytesLoaded})}function t(a,b,e){a=this.loader;0==b.total&&(a.bytesTotal+=e.total);a.bytesLoaded+=e.loaded-b.loaded;b.loaded=e.loaded;b.total=e.total;this.trigger("fetch.progress",{filesTotal:a.filesTotal,filesLoaded:a.filesLoaded,bytesTotal:a.bytesTotal,bytesLoaded:a.bytesLoaded})}var h=d.Class.create("Loader",null,["Plugin"]).proto("provides","loader").ctor(function(c){c.loader=this;this.texLoaded=this.texLoading=this.bytesLoaded=this.bytesTotal=this.filesLoaded=this.filesTotal=this.completed=
0;c.listen("loader.step",l);c.listen("loader.start",e);c.listen("loader.error",a);c.listen("loader.complete",b);c.listen("loader.progress",t)}).init(function(a){a.manager=new c.LoadingManager(function(){a.invoke("loader.start",arguments)},function(){a.invoke("loader.step",arguments)},function(){a.invoke("loader.error",arguments)});a.manager.app=a});d("Plugin.Loader",h)})(THREE,THREEAPP);
(function(c,d,b){d=b.Class.create("Progress",null,["Plugin"]).ctor(function(a){this.el=c('<div id="progressbar"/>');this.wrapper=c('<div class="indicator"/>').appendTo(this.el);this.indicator=c('<div class="bg"/>').appendTo(this.wrapper);this.text=c('<div class="text"/>').appendTo(this.el);this.el.appendTo(a.viewport);this.thresholdBytes=this.thresholdFiles=0;this.stopped=!0;this.el.hide();this.indicator.css("width","0%");var b=this;a.listen("fetch.progress",function(a){b.stopped&&(!0!==b.stopped&&
clearTimeout(b.stopped),b.el.fadeIn(200),b.stopped=!1);var c=sprintf("%d/%d (%S/%S)",a.filesLoaded,a.filesTotal,a.bytesLoaded-b.thresholdBytes,a.bytesTotal-b.thresholdBytes);b.indicator.css("width",(a.bytesLoaded-b.thresholdBytes)/(a.bytesTotal-b.thresholdBytes)*100+"%");b.text.html(c)});a.listen("fetch.complete",function(a){b.thresholdBytes=a.bytesLoaded;b.thresholdFiles=a.filesLoaded;b.stopped=setTimeout(function(){b.el.fadeOut(600,function(){b.stopped=!0})},1E3)})}).init(function(){}).ready(function(){});
b("Plugin.Progress",d)})(jQuery,THREE,THREEAPP);(function(c,d){function b(a,b,c){b||(b="f");this.uniforms[a]||(this.uniforms[a]={type:b,value:c||0});return this.uniforms[a]}c=d.Class.create("Uniforms",null,["Plugin"]).ctor(function(a){a.uniforms=[];a.uniform=b}).ready(function(a){a.hasOwnProperty("time")&&a.listen("preframe",function(){a.uniform("time").value=a.time},999999)});d("Plugin.Uniforms",c)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("Background",null,["Plugin"]).proto("requires","renderer").proto("provides","background").ctor(function(a){a.bg=a.options.bg?new a.options.bg(a):new c.Scene(a);a.listen("render",function(){a.invoke("render-background");a.renderer.render(a.bg,a.camera)},99)});d("Plugin.Background",b)})(THREE,THREEAPP);
(function(c,d){c=d.Class.create("Tween",null,["Plugin"]).proto("provides","tween").ready(function(b){b.listen("preframe",function(){TWEEN.update()})});d("Plugin.Tween",c)})(THREE,THREEAPP);(function(c,d){c=d.Class.create("LZMA",null,["Plugin"]).proto("provides","lzma").ctor(function(b){b.wlzma=new WLZMA.Manager(2)});d("Plugin.LZMA",c)})(THREE,THREEAPP);
(function(c,d){var b=d.Class.create("LOD",d.Object3D,["Plugin"]).proto("provides","lod").proto("requires","camera").proto("requires","ui").ctor(function(a){a.lods=[]}).ready(function(a){a.listen("update-ui",function(){var b=new c.Matrix4;b.multiplyMatrices(a.camera.projectionMatrix,a.camera.matrixWorldInverse);var d=new c.Frustum;d.setFromMatrix(b);for(var b=a.camera.getWorldPosition(),t="",h=document.getElementById("lodInfo"),p=0,q=a.lods.length;p<q;p++){var g=a.lods[p].getWorldPosition(),r=b.distanceToSquared(g);
a.lods[p].inFrustum=d.intersectsSphere({center:g,radius:a.lods[p].radius||100});t+=sprintf("%02d) %.5f",p,r);if(a.lods[p].inFrustum){var r=r*Math.pow(a.camera.fov,2),g=a.lods[p].options.lod,m=0,n=g.length;if(m<n&&!g[m])debugger;for(;m<n&&r<g[m].min;)++m;m==n&&(m=-1);a.lods[p].level!=m&&(a.lods[p].level=m,a.lods[p].trigger("lod"));t+=" - lvl "+m+"<br>"}else t+=" - hidden<br>"}h&&(h.innerHTML=t)})});d("Plugin.LOD",b)})(THREE,THREEAPP);
(function(c,d){c=d.Class.create("UI",null,["Plugin"]).proto("provides","ui").ctor(function(b){var a=this;a.frames=9999;b.listen("postframe",function(){6<++a.frames&&(a.frames=0,b.trigger("update-ui"))})});d("Plugin.UI",c)})(THREE,THREEAPP);
(function(c,d){c=d.Class.mixin(["Events","Options"]).ctor(function(b,a){this.items=[];this.length=0}).defaults({softLimit:8,hardLimit:2E3,increment:2}).method("belowSoftLimit",function(b){return this.items.length<this.options.softLimit}).method("belowHardLimit",function(b){return this.items.length<this.options.hardLimit}).method("delete",function(b){isNaN(b)&&(b=this.items.indexOf(b));if(0>b||b>this.items.length)throw"cannot remove unknown group item";var a=this.items[b];this.items.splice(b,1);--this.length;
this.trigger("decrease");this.invoke("deleted",a);this.trigger("resized")}).method("insert",function(b){if(this.belowSoftLimit())this.items.push(b),this.length+=1,this.trigger("increase");else if(this.belowHardLimit())this.items.push(b),this.options.softLimit*=this.options.increment||2,this.options.softLimit>this.options.hardLimit&&(this.options.softLimit=this.options.hardLimit),this.length+=1,this.invoke("resize");else throw Error("group reached hard limit");this.invoke("inserted",b);this.trigger("resized")});
d("Group",c)})(THREE,THREEAPP);
(function(c,d){c=d.Class.create("Grouped",null,["Events","Options"]).ctor(function(b,a){this.length=0;this.groups=[];this.current=null;this.compacting=!1}).defaults({softLimit:3,hardLimit:2E3,increment:8,compact:.75}).method("add",function(b){this.length+=1;if(this.current){if(this.current.belowHardLimit())return this.current.insert(b),this;for(var a=0;a<this.groups.length;a++)if(this.groups[a].belowHardLimit())return this.current=this.groups[a],this.current.insert(b),this}this.current=new this.options.ctor(this.app,
this.options);this.groups.push(this.current);this.current.insert(b);this.current.trigger("enable");return this}).method("delete",function(b){var a=0,c=-1;if(isNaN(b)){for(a=0;a<this.groups.length&&!(-1<(c=this.groups[a].indexOf(b)));a++);b=c}else for((0>b||b>=this.length)&&console.warn("access out of bound");a<this.groups.length&&!(b<this.groups[a].length);)b-=this.groups[a].length,a+=1;a!=this.groups.length&&(this.groups[a].delete(b),0==this.groups[a].length&&(this.groups[a].removed=!0,this.groups[a].trigger("disable"),
this.groups.splice(a,1)),--this.length,this.compacting||this.options.compact&&2<this.groups.length&&this.length/this.options.hardLimit<this.groups.length*this.options.compact&&this.compact(75))}).method("compact",function(b,a){var c=this;isNaN(a)&&(a=0);for(this.compacting=!0;a<this.groups.length;){if(this.groups[a].belowHardLimit()){for(;this.groups[a].belowHardLimit();){var d=this.groups.length-1,t=this.groups[d].length-1,h=this.groups[d].items[t];if(-1==t||d==a)break;this.groups[d].delete(t);this.groups[a].insert(h);
0==this.groups[d].length&&(this.groups[d].removed=!0,this.groups[d].trigger("disable"),this.groups.splice(d,1))}isNaN(b)||setTimeout(function(){c.compact(b,a)},b);break}a+=1}this.compacting=!1});d("Grouped",c)})(THREE,THREEAPP);(function(c,d){c=d.Class.create("DATUI",null,["Plugin"]).proto("provides","datui").ctor(function(b){b.datui=new dat.GUI}).init(function(b){b.datui.close()});d("Plugin.DATUI",c)})(THREE,THREEAPP);
var StatsGPU=function(){function c(a,b,c){a=document.createElement(a);a.id=b;a.style.cssText=c;return a}function d(a,b,d){var e=c("div",a,"padding:0 0 3px 3px;text-align:left;background:"+d),f=c("div",a+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+b);f.innerHTML=a.toUpperCase();e.appendChild(f);a=c("div",a+"Graph","width:94px;height:30px;background:"+b);e.appendChild(a);for(b=0;94>b;b++)a.appendChild(c("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
d));return e}function b(a){for(var b=q.children,c=0;c<b.length;c++)b[c].style.display=c===a?"block":"none";p=a}function a(a,b){a.appendChild(a.firstChild).style.height=Math.min(30,30-30*b)+"px"}var e=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,l=e(),t=l,h=0,p=0,q=c("div","statsGPU","width:100px;opacity:0.9;cursor:pointer");q.addEventListener("mousedown",function(a){a.preventDefault();b(++p%q.children.length)},!1);var g=0,r=Infinity,m=0,n=d("fps","#0ff","#002"),
y=n.children[0],w=n.children[1];q.appendChild(n);var x=0,z=Infinity,A=0,n=d("ms","#0f0","#020"),D=n.children[0],C=n.children[1];q.appendChild(n);if(self.performance&&self.performance.memory){var k=0,f=Infinity,B=0,n=d("mb","#f08","#201"),E=n.children[0],u=n.children[1];q.appendChild(n)}b(p);return{REVISION:14,domElement:q,setMode:b,begin:function(){l=e()},end:function(){var b=e();x=b-l;z=Math.min(z,x);A=Math.max(A,x);D.textContent=(x|0)+" MS ("+(z|0)+"-"+(A|0)+")";a(C,x/200);h++;if(b>t+1E3&&(g=Math.round(1E3*
h/(b-t)),r=Math.min(r,g),m=Math.max(m,g),y.textContent=g+" FPS ("+r+"-"+m+")",a(w,g/100),t=b,h=0,void 0!==k)){var c=performance.memory.usedJSHeapSize,d=performance.memory.jsHeapSizeLimit;k=Math.round(9.54E-7*c);f=Math.min(f,k);B=Math.max(B,k);E.textContent=k+" MB ("+f+"-"+B+")";a(u,c/d)}return b},update:function(){l=this.end()}}};"object"===typeof module&&(module.exports=StatsGPU);
(function(c,d){c=d.Class.create("MonitorGPU",null,["Plugin"]).ready(function(b){var a=new StatsGPU;b.viewport.appendChild(a.domElement);b.listen("preframe",function(){a.begin()});b.listen("postframe",function(){a.end()})});d("Plugin.MonitorGPU",c)})(THREE,THREEAPP);
(function(c){function d(){var a=arguments[0],b=d.cache;b[a]&&b.hasOwnProperty(a)||(b[a]=d.parse(a));return d.format.call(null,b[a],arguments)}function b(a){return"number"===typeof a?"number":"string"===typeof a?"string":Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var a=/[^T]/,e=/[^v]/,l=/[diefg]/,t=/bcdiefguxXS/,h=/[j]/,p=/^[^\x25]+/,q=/^\x25{2}/,g=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxXSDR])/,r=/^([a-z_][a-z_\d]*)/i,m=/^\.([a-z_][a-z_\d]*)/i,
n=/^\[(\d+)\]/,y=/^[\+\-]/;d.format=function(c,g){var n=1,p=c.length,k,f,m=[],r,u,q,w=!0,v;for(r=0;r<p;r++)if(k=b(c[r]),"string"===k)m[m.length]=c[r];else if("array"===k){k=c[r];if(k[2])for(f=g[n],u=0;u<k[2].length;u++){if(!f.hasOwnProperty(k[2][u]))throw Error(d('[sprintf] property "%s" does not exist',k[2][u]));f=f[k[2][u]]}else f=k[1]?g[k[1]]:g[n++];a.test(k[8])&&e.test(k[8])&&"function"==b(f)&&(f=f());if(t.test(k[8])&&"number"!=b(f)&&isNaN(f))throw new TypeError(d("[sprintf] expecting number but found %s",
b(f)));l.test(k[8])&&(w=0<=f);switch(k[8]){case "b":f=parseInt(f,10).toString(2);break;case "c":f=String.fromCharCode(parseInt(f,10));break;case "d":case "i":f=parseInt(f,10);break;case "j":f=JSON.stringify(f,null,k[6]?parseInt(k[6]):0);break;case "e":f=k[7]?parseFloat(f).toExponential(k[7]):parseFloat(f).toExponential();break;case "f":f=k[7]?parseFloat(f).toFixed(k[7]):parseFloat(f);break;case "g":f=k[7]?parseFloat(f).toPrecision(k[7]):parseFloat(f);break;case "o":f=f.toString(8);break;case "s":f=
String(f);f=k[7]?f.substring(0,k[7]):f;break;case "t":f=String(!!f);f=k[7]?f.substring(0,k[7]):f;break;case "S":if(1024>Math.abs(f))f+=" B";else{u="KiB MiB GiB TiB PiB EiB ZiB YiB".split(" ");v=-1;do f/=1024,++v;while(1024<=Math.abs(f)&&v<u.length-1);f=f.toFixed(1)+u[v]}break;case "R":v=f/Math.PI*180;f=v%1*60;u=f%1*60;f=d("%02d\u00b0 %02d' %0.2f\"",v,f,u);break;case "D":f+=Math.PI;v=f/Math.PI*12;f=v%1*60;u=f%1*60;f=d("%02dh %02dm %0.2fs",v,f,u);break;case "T":f=b(f);f=k[7]?f.substring(0,k[7]):f;break;
case "u":f=parseInt(f,10)>>>0;break;case "v":f=f.valueOf();f=k[7]?f.substring(0,k[7]):f;break;case "x":f=parseInt(f,10).toString(16);break;case "X":f=parseInt(f,10).toString(16).toUpperCase()}h.test(k[8])?m[m.length]=f:(!l.test(k[8])||w&&!k[3]?v="":(v=w?"+":"-",f=f.toString().replace(y,"")),u=k[4]?"0"===k[4]?"0":k[4].charAt(1):" ",q=k[6]-(v+f).length,q=k[6]?0<q?0<=q&&7>=q&&x[u]?x[u][q]:Array(q+1).join(u):"":"",m[m.length]=k[5]?v+f+q:"0"===u?v+q+f:q+v+f)}return m.join("")};d.cache={};d.parse=function(a){for(var b,
c=[],d=0;a;){if(null!==(b=p.exec(a)))c[c.length]=b[0];else if(null!==(b=q.exec(a)))c[c.length]="%";else if(null!==(b=g.exec(a))){if(b[2]){var d=d|1,e=[],f=b[2],h;if(null!==(h=r.exec(f)))for(e[e.length]=h[1];""!==(f=f.substring(h[0].length));)if(null!==(h=m.exec(f)))e[e.length]=h[1];else if(null!==(h=n.exec(f)))e[e.length]=h[1];else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");b[2]=e}else d|=2;if(3===
d)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");c[c.length]=b}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(b[0].length)}return c};var w=function(a,b,c){c=(b||[]).slice(0);c.splice(0,0,a);return d.apply(null,c)},x={0:" 0 00 000 0000 00000 000000 0000000".split(" ")," ":"; ;  ;   ;    ;     ;      ;       ".split(";"),_:" _ __ ___ ____ _____ ______ _______".split(" ")};"undefined"!==typeof exports?(exports.sprintf=d,exports.vsprintf=
w):(c.sprintf=d,c.vsprintf=w,"function"===typeof define&&define.amd&&define(function(){return{sprintf:d,vsprintf:w}}))})("undefined"===typeof window?this:window);
(function(c,d,b){var a=requestAnimationFrame;c=b.Class.create("ThreeApp",null,["Events"]).ctor(function(a,c){this.frames=9999;this.viewport=a;b.extend(this.options,c)}).init(function(a){a=this;for(var b=this.options.plugins||[],c=[].concat(b),d=0;d<c.length;){var p=c[d].prototype.required;if(p&&p.length)++d;else{p=c.splice(d,1)[0];if(p.prototype.provided){for(var q=p.prototype.provided,g=0;g<c.length;g++)for(var r in q){var d=c[g].prototype.required,m=(d||[]).indexOf(r);-1!=m&&d.splice(m,1)}d=0}b[g]=
new p(this);a.wait&&a.wait(b[g])}}if(c.length){for(g=0;g<c.length;g++)a=c[g].name,d=c[g].prototype.required,console.warn(a,"is missing",d);throw Error("Missing or circular dependencies");}a.plugins=b}).ready(function(){var a=this;this.options.start&&window.setTimeout(function(){a.start()},0)}).method("start",function(){var b=this;b.started||b.paused||(a(function(){b.render.call(b)}),b.started=!0)}).method("resize",function(a,b){this.width=a;this.height=b;this.invoke("resized")}).method("log",function(){console.log(sprintf.apply(this,
arguments))}).method("warn",function(){console.warn(sprintf.apply(this,arguments))}).method("info",function(){console.info(sprintf.apply(this,arguments))}).method("render",function(){var b=this;b.invoke("preframe");b.invoke("render");b.invoke("postframe");b.started&&a(function(){b.render.call(b)});++b.frames});b("App",c)})(self,THREE,THREEAPP);

/* crc: 299C5EFFD3712EB8BCF0752877931905 */
