/* autogenerated by webmerge (compile context) */
;
/*
Three.js App Framework (https://github.com/mgreter/three.app)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
(function(b,c){function e(a,d){for(var h=a.split(/\./),l=e,b=0;b<h.length-1;b++)l[h[b]]||(l[h[b]]={}),l=l[h[b]];if(1==arguments.length)return l[h[b]];var c=typeof l[h[b]];if("object"==c){c=l[h[b]];for(var g in c)c.hasOwnProperty(g)&&(d[g]=c[g])}else if("undefined"!=c)throw Error("Namespace already taken!");return l[h[b]]=d}function a(){var d,b=!1,h=0,l=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(b=arguments[0],h++);for(d=arguments[h++];h<l;h++){var c=void 0,
e=arguments[h];for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(b&&"[object Object]"===Object.prototype.toString.call(e[c])?d[c]=a(!0,d[c],e[c]):b&&e[c]instanceof Array?("undefined"==typeof d[c]&&(d[c]=[]),d[c]=d[c].concat(e[c])):d[c]=e[c])}return d}c=b.THREEAPP;if("object"==typeof c)for(var d in c)c.hasOwnProperty(d)&&(e[d]=c[d]);e("extend",a);e("mixin",function(d,b){if(!b||!d)debugger;d=d.prototype;b=b.prototype;for(var h in b)b.hasOwnProperty(h)&&(b[h]instanceof Array?(d[h]||(d[h]=[]),d[h]=
d[h].concat(b[h])):b[h]instanceof Function?(d[h]=b[h],a(d[h],b[h])):b[h]instanceof Object?(d[h]||(d[h]={}),a(!0,d[h],b[h])):d[h]=b[h])});e("tmpl",function(a,d){return a.replace(/%([a-zA-Z][a-zA-Z0-9]*)%/g,function(a,b){return d[b]?d[b]:"[%"+b+"%]"})});b.THREEAPP=e})(self,THREE);
(function(b,c){function e(a,d){}function a(){for(var a={},d=this.ctor,b=0;b<d.length;b++)a[d[b]]||(d[b].apply(this,arguments),a[d[b]]=!0);d=this.init;this.__proto__.wait=r;for(b=0;b<d.length;b++)a[d[b]]||(d[b].apply(this,arguments),a[d[b]]=!0)}function d(){if(0<this.pending)return this;delete this.__proto__.wait;for(var a=0;a<this.ready.length;a++)this.ready[a].apply(this,arguments);if(this.listeners){var d=this.listeners.ready||[];for(a=0;a<d.length;a++)d[a].apply(this,arguments)}delete this.pending;
this.isReady=!0;return this}function g(a,d,b){d||(d=c.Class);Array.isArray(b)||(b=[b]);if(!b)throw Error("Undefined mixin!");a.prototype.ctor||(a.prototype.ctor=[]);a.prototype.init||(a.prototype.init=[]);a.prototype.ready||(a.prototype.ready=[]);a.prototype.defaults||(a.prototype.defaults={});a.prototype.listeners||(a.prototype.listeners={});if(b&&b.length)for(var h=0,e=b.length;h<e;h++){if(!b[h])throw Error("Undefined mixin!");if(!(b[h]instanceof Function)){var l=c(b[h]);if("undefined"==typeof l)throw Error("Unknown mixin: "+
b[h]);b[h]=l}}a.prototype.listeners=c.extend(!0,{},a.prototype.listeners);for(h=0;h<b.length;h++)c.mixin(a,b[h]);c.mixin(a,d);d&&(a.prototype.__proto__=d.prototype);a.static=function(b,d){a[b]=d;return this};a.method=function(b,d){a.prototype[b]=d;return this};a.proto=function(b,d){a.prototype[b](d);return this};a.defaults=function(b){c.extend(a.prototype.defaults,b);return this};a.ctor=function(b){a.prototype.ctor.push(b);return this};a.init=function(b){a.prototype.init.push(b);return this};a.ready=
function(b){a.prototype.ready.push(b);return this};a.listen=function(b,d,h){var c=a.prototype.listeners;c[b]||(c[b]=[]);null!=h&&(d.prio=h);c[b].push(d);"ready"==b&&this.isReady&&d.call(this);return this};return a}function r(a){function b(){--h.pending;d.apply(h)}function c(a){throw a;}var h=this;h.pending++;if(!a)throw Error("Invalid wait call");if("function"==typeof a.listen)a.listen("ready",b);else if("function"==typeof a.then)a.then(b,c);else throw Error("Invalid wait promise");return d.apply(h)}
e.create=function(){var b="string"==typeof arguments[0]?[].shift.call(arguments):null,l=arguments[0]||e,r=arguments[1]||[],m=function(){this.pending=0;this.options=c.extend({},this.defaults);a.apply(this,arguments);d.apply(this,arguments)};if(b)try{eval("Klass = "+m.toString().replace(/\(\)/," "+b+"()"))}catch(q){console.warn("Could not eval new fn body\n"+q+"\n"+klass)}m.prototype.name=b;return g.call(e,m,l,r)};e.mixin=function(a){1>arguments.length&&(a=[]);return g.call(e,function(){throw Error("Can't instantiate mixins");
},null,a)};e.virtual=function(a,b){0==arguments.length&&(a=e);if(!a)throw Error("Undefined virtual base!");2>arguments.length&&(b=[]);return g.call(e,function(){throw Error("cannot instantiate virtual class");},a,b)};e.prototype.constructor=e;c("Class",e)})(THREE,THREEAPP);(function(b,c){b=c.Class.mixin().ctor(function(b,a){this.app=b;c.extend(this.options,a)});c("Options",b)})(THREE,THREEAPP);
(function(b,c){function e(a,b){return(b.prio||0)-(a.prio||0)}b=c.Class.mixin(["Options"]).ctor(function(a,b){this.listeners=c.extend(!0,{},this.listeners,this.options.listeners);this.deferred={}}).method("listen",function(a,b,c){"ready"==a&&this.isReady&&b.call(this);null!=c&&(b.prio=c);this.listeners.hasOwnProperty(a)||(this.listeners[a]=[]);a=this.listeners[a];-1==a.indexOf(b)&&a.push(b);a.sort(e)}).method("invoke",function(a){for(var b=Array.prototype.slice.call(arguments,1),c=this.listeners[a],
e=0,h=c?c.length:0;e<h;e++)c[e].apply(this,b);this.deferred[a]=!1}).method("trigger",function(a){var b=this;if(!b.deferred[a]){var c=Array.prototype.slice.call(arguments,1);b.deferred[a]=window.setTimeout(function(){for(var d=b.listeners[a],h=0,e=d?d.length:0;h<e;h++)d[h].apply(b,c);b.deferred[a]=!1},0)}});c("Events",b)})(THREE,THREEAPP);
(function(b,c){b=c.Class.mixin(["Events"]).method("required",[]).method("provided",{}).method("requires",function(b){Array.isArray(b)?this.required=this.required.concat(b):this.required.push(b);return this}).method("provides",function(b){var a=this.provided;Array.isArray(b)||(b=[b]);for(var d=0,c=b.length;d<c;++d){if(a.hasOwnProperty(b[d]))throw Error("Duplicate service provider");a[b[d]]=!0}return this});c("Plugin",b)})(THREE,THREEAPP);
(function(b,c){function e(a){for(var b in a)this.resources[b]=a[b]}function a(a,b){return this.assets[a]?this.assets[a][2].data:b}var d={},g=c.Class.mixin(["Options","Events"]).ctor(function(a,b){this.assets={};this.prefetch=e;a.resources=d;this.resources=jQuery.extend({},this.resources,this.options.resources);a.listen("loader.complete",function(a,b){for(var d=a.cbs.length,c=0;c<d;c++)a.cbs[c].assets[2]=a,a.cbs[c].resolve&&a.cbs[c].resolve(),a.complete=!0,a.data=b})}).init(function(a){var d=this,
c=a.manager,e=d.resources,g;for(g in e){var r=e[g][0],n=e[g][1];this.assets[g]=e[g];if(a.resources[n]){var p={obj:this,assets:e[g]};a.resources[n].complete?e[g][2]=a.resources[n]:this.wait(new Promise(function(b,d){p.reject=d;p.resolve=b;a.resources[n].cbs.push(p)}))}else{r=r.substr(0,1).toUpperCase();if("S"==r)var x=new b.TextLoader(c);else if("T"==r)x=new b.TextureLoader(c);else if("I"==r)x=new b.ImageLoader(c);else if("J"==r)x=new b.JsonLoader(c);else if("A"==r)x=new b.ArrayLoader(c);else if("B"==
r)x=new b.BlobLoader(c);else if("R"==r)x=new b.BinaryLoader(c);else if("O"==r)x=new b.ObjectLoader(c);else if("L"==r)x=new b.OBJLoader(c);else throw"Unknown loader type for resource";p={obj:this,assets:e[g]};this.wait(new Promise(function(b,c){p.reject=c;p.resolve=b;a.resources[n]={total:0,loaded:0,cbs:[p]};(function(b,h,e){x.load(h,function(b){a.invoke("loader.complete",e,b)},function(b){a.invoke("loader.progress",d,e,b)},c)})(r,n,a.resources[n])}))}}}).ready(function(){this.asset=a}).listen("ready",
function(){this.options.container&&this.options.container.add(this)});c("Resources",g)})(THREE,THREEAPP);THREE.ArrayLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};
THREE.ArrayLoader.prototype={constructor:THREE.ArrayLoader,load:function(b,c,e,a){var d=this.manager,g=d.app;d=new THREE.FileLoader(d);b.match(/\.lzma$/)?(d.setResponseType("arraybuffer"),d.load(b,function(b){g.wlzma.decode(b).then(function(a){a=a.toUint8Array();c.call(this,a.buffer)}).catch(a)},e,a)):(d.setResponseType("arraybuffer"),d.load(b,c,e,a))}};THREE.BlobLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};
THREE.BlobLoader.prototype={constructor:THREE.BlobLoader,load:function(b,c,e,a){var d=this.manager,g=d.app;d=new THREE.FileLoader(d);b.match(/\.lzma$/)?(d.setResponseType("arraybuffer"),d.load(b,function(b){g.wlzma.decode(b).then(function(a){a=new Blob(a.buffers);if("object"!=typeof a)throw Error("Invalid BLOB");c.call(this,a)}).catch(a)},e,a)):(d.setResponseType("blob"),d.load(b,function(a){if(a)return c.apply(this,arguments);throw Error("Invalid BLOB");},e,a))}};
THREE.DataLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};
THREE.DataLoader.prototype={constructor:THREE.DataLoader,load:function(b,c,e,a){var d=this.manager,g=d.app;d=new THREE.FileLoader(d);b.match(/\.lzma$/)?(d.setResponseType("arraybuffer"),d.load(b,function(b){g.wlzma.decode(b).then(function(a){a=JSON.parse(a);if("object"!=typeof a)throw Error("Invalid JSON");c.call(this,a)}).catch(a)},e,a)):(d.setResponseType("json"),d.load(b,function(a){if(a)return c.apply(this,arguments);throw Error("Invalid JSON");},e,a))}};
THREE.JsonLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};
THREE.JsonLoader.prototype={constructor:THREE.JsonLoader,load:function(b,c,e,a){var d=this.manager,g=d.app;d=new THREE.FileLoader(d);b.match(/\.lzma$/)?(d.setResponseType("arraybuffer"),d.load(b,function(b){g.wlzma.decode(b).then(function(a){a=JSON.parse(a);if("object"!=typeof a)throw Error("Invalid JSON");c.call(this,a)}).catch(a)},e,a)):(d.setResponseType("json"),d.load(b,function(a){if(a)return c.apply(this,arguments);throw Error("Invalid JSON");},e,a))}};
THREE.TextLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};THREE.TextLoader.prototype={constructor:THREE.TextLoader,load:function(b,c,e,a){var d=this.manager.app,g=new THREE.FileLoader(this.manager);b.match(/\.lzma$/)?(g.setResponseType("arraybuffer"),g.load(b,function(b){d.wlzma.decode(b).then(function(a){a=a.toString();if("string"!=typeof a)throw Error("Invalid Text");c.call(this,a)}).catch(a)},e,a)):(g.setResponseType("text"),g.load(b,c,e,a))}};
THREE.TextureLoader=function(b){this.manager=void 0!==b?b:THREE.DefaultLoadingManager};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(b,c,e,a){var d=new THREE.FileLoader(this.manager),g=new THREE.Texture;d.setResponseType("arraybuffer");d.load(b,function(a){var d="application/octet-stream";b.search(/\.(jpe?g)$/)?d="image/jpeg":b.search(/\.(png)$/)?d="image/png":b.search(/\.(gif)$/)&&(d="image/gif");a=new Blob([a],{type:d});var e=new FileReader(a);g.image=document.createElementNS("http://www.w3.org/1999/xhtml","img");g.image.addEventListener("load",function(){g.format=
"image/jpeg"==d?THREE.RGBFormat:THREE.RGBAFormat;g.needsUpdate=!0;void 0!==c&&c(g)});e.addEventListener("load",function(a){g.image.src=e.result},!1);e.readAsDataURL(a)},e,a);return window.texture=g},setCrossOrigin:function(b){this.crossOrigin=b;return this},setPath:function(b){this.path=b;return this}};(function(b,c){var e=c.Class.virtual(b.Object3D).ctor(function(a,d){b.Object3D.call(this);this.sortObjects=this.matrixAutoUpdate=!0});c("Object3D",e)})(THREE,THREEAPP);
(function(){var b=THREEAPP.Class.virtual(THREE.Scene).ctor(function(b,e){THREE.Scene.call(this)});THREEAPP("Scene",b)})();
(function(b,c){b=c.Class.virtual(c.Object3D,["Events"]).ctor(function(b,a){this.lod=[]}).ready(function(b){b.lods.push(this);this.trigger("lod")}).listen("lod",function(){if(this.current!=this.level&&-1!=this.level){if(!this.lod[this.level]){var b=this.options.lod[this.level],a={},d;for(d in this.options.resources){var g=this.options.resources[d];a[d]=[g[0],c.tmpl(g[1],b)]}b=c.extend({},this.options,b,{resources:a,container:this});this.lod[this.level]=new this.options.ctor(this.app,b)}this.lod[this.level].isReady&&
(this.lod[this.current]&&this.remove(this.lod[this.current]),this.add(this.lod[this.level]),this.current=this.level)}});c("LOD",b)})(THREE,THREEAPP);
(function(b,c){function e(a,b,d,c){d=d.shader||"";c=c?1:0;Array.isArray(d)&&(d=d.join("\n"));return a.splice(b,c,d)}function a(a,b){if(a&&a.length)for(var d=0;d<a.length;d++){for(var c=!1,g=a[d],m=0;m<b.length;m++)g.after&&g.after.test(b[m])?(e(b,m+1,g,!1),m+=2,c=!0):g.before&&g.before.test(b[m])?(e(b,m,g,!1),m+=2,c=!0):g.replace&&g.replace.test(b[m])&&(e(b,m,g,!0),m+=1,c=!0);if(!c)throw Error("Shader Chunk not found");}}var d=c.Class.virtual(b.ShaderMaterial).ctor(function(a,b,d){a=this._args={chunks:b||
{},uniforms:d||{},parameters:a||{}};a.chunks.vertex||(a.chunks.vertex=[]);a.chunks.fragment||(a.chunks.fragment=[]);a.parameters.defines||(a.parameters.defines={})}).init(function(){var d=this._args.chunks,c=this._args.uniforms;"string"==typeof this._shaderLib&&(this._shaderLib=b.ShaderLib[this._shaderLib]||console.error("Unknown THREE.ShaderLib: "+this._shaderLib));var e=this._shaderLib,l=e.vertexShader.split(/\n+/),u=e.fragmentShader.split(/\n+/);a(d.vertex,l);a(d.fragment,u);b.ShaderMaterial.call(this,
{uniforms:b.UniformsUtils.merge([c,e.uniforms]),vertexShader:l.join("\n"),fragmentShader:u.join("\n"),lights:!0});this.type="CustomMaterial"});c("CustomMaterial",d)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.virtual(c.CustomMaterial).ctor(function(a,b,c){this._shaderLib="phong";this.isMeshPhongMaterial=!0}).init(function(){var a=this._args.parameters;this.type="MeshCustomPhongMaterial";this.color=new b.Color(16777215);this.specular=new b.Color(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new b.Color(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=
null;this.normalScale=new b.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=b.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)});c("CustomPhong",e)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("Clock",null,["Plugin"]).proto("provides","time").proto("provides","clock").ctor(function(a){a.time=0;a.clock=new b.Clock(!1);a.clock.speed=1/3600;a.listen("clock.pause",function(){a.clock.stop();a.clock.paused=!0;a.trigger("clock.adjusted")});a.listen("clock.resume",function(){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});a.listen("clock.faster",function(){a.clock.speed*=2;a.trigger("clock.adjusted")});a.listen("clock.slower",function(){a.clock.speed/=
2;a.trigger("clock.adjusted")});a.listen("clock.reverse",function(){a.clock.speed*=-1;a.trigger("clock.adjusted")});a.listen("clock.reset",function(){a.clock.speed=1/3600;a.trigger("clock.adjusted")});a.listen("preframe",function(){var b=a.clock.getDelta();a.time+=b*a.clock.speed});a.clock.setSpeed=function(b){a.clock.speed=b;a.trigger("clock.adjusted")}}).ready(function(a){a.clock.start();a.clock.paused=!1;a.trigger("clock.adjusted")});c("Plugin.Clock",e)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("Scene",null,["Plugin"]).proto("provides","scene").ctor(function(a){a.scene=a.options.scene?new a.options.scene(a):new b.Scene(a)});c("Plugin.Scene",e)})(THREE,THREEAPP);
(function(b,c){function e(a){a.resize(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)}b=c.Class.create("AutoSize",null,["Plugin"]).ctor(function(a){addEventListener("resize",function(){e(a)},!0);e(a)});c("Plugin.AutoSize",b)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("WebGLRenderer",null,["Plugin"]).proto("provides","renderer").ctor(function(a){a.renderer=new b.WebGLRenderer({sortObjects:!0,antialias:!0,precision:"highp",alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0,logarithmicDepthBuffer:!0});a.renderer.autoClear=!1;a.listen("resized",function(){a.renderer.setSize(a.width,a.height)});a.renderer.setSize(a.width,a.height);a.viewport.appendChild(a.renderer.domElement);a.listen("preframe",function(){a.renderer.clear()});
a.listen("render",function(){a.invoke("render-scene");a.renderer.render(a.scene,a.camera)})});c("Plugin.WebGLRenderer",e)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("PerspectiveCamera",null,["Plugin"]).proto("provides","camera").ctor(function(a){a.camera=new b.PerspectiveCamera(this.options.fov||65,a.width/a.height,this.options.near||1E-6,this.options.far||1E20);a.camera.position.x=1E-11;a.listen("resized",function(){a.camera.aspect=a.width/a.height;a.camera.updateProjectionMatrix()})});c("Plugin.PerspectiveCamera",e)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("TrackballControls",null,["Plugin"]).proto("requires","camera").proto("requires","renderer").ctor(function(a){a.controls=new b.TrackballControls(a.camera,a.renderer.domElement);a.listen("preframe",function(){a.controls.update()})});c("Plugin.TrackballControls",e)})(THREE,THREEAPP);
(function(b,c){function e(a,b){for(var d=a.cbs.length,c=0;c<d;c++)a.cbs[c].assets[2]=a,a.cbs[c].resolve&&a.cbs[c].resolve(),a.complete=!0,a.data=b}function a(){this.invoke("fetch.error",{})}function d(){1==++this.loader.completed&&this.trigger("prefetch.complete",this.loader);this.trigger("fetch.complete",this.loader)}function g(a){var b=this.loader;b.filesTotal=a[2];b.filesLoaded=a[1];this.trigger("fetch.progress",{filesTotal:b.filesTotal,filesLoaded:b.filesLoaded,bytesTotal:b.bytesTotal,bytesLoaded:b.bytesLoaded})}
function r(a,b,d){a=this.loader;0==b.total&&(b.total=d.total,a.bytesTotal+=d.total,a.filesTotal+=1);a.bytesLoaded+=d.loaded-b.loaded;b.loaded=d.loaded;this.trigger("fetch.progress",{filesTotal:a.filesTotal,filesLoaded:a.filesLoaded,bytesTotal:a.bytesTotal,bytesLoaded:a.bytesLoaded})}var h=c.Class.create("Loader",null,["Plugin"]).proto("provides","loader").ctor(function(b){b.loader=this;this.bytesLoaded=this.bytesTotal=this.filesLoaded=this.filesTotal=this.completed=0;b.listen("loader.step",g);b.listen("loader.start",
d);b.listen("loader.error",a);b.listen("loader.complete",e);b.listen("loader.progress",r)}).init(function(a){a.manager=new b.LoadingManager(function(){a.invoke("loader.start",arguments)},function(){a.invoke("loader.step",arguments)},function(){a.invoke("loader.error",arguments)});a.manager.app=a});c("Plugin.Loader",h)})(THREE,THREEAPP);
(function(b,c,e){c=e.Class.create("Progress",null,["Plugin"]).ctor(function(a){this.el=b('<div id="progressbar"/>');this.wrapper=b('<div class="indicator"/>').appendTo(this.el);this.indicator=b('<div class="bg"/>').appendTo(this.wrapper);this.text=b('<div class="text"/>').appendTo(this.el);this.el.appendTo(a.viewport);this.thresholdBytes=this.thresholdFiles=0;this.stopped=!0;this.el.hide();this.indicator.css("width","0%");var d=this;a.listen("fetch.progress",function(a){d.stopped&&(!0!==d.stopped&&
clearTimeout(d.stopped),d.el.fadeIn(200),d.stopped=!1);var b=sprintf("%d/%d (%S/%S)",a.filesLoaded,a.filesTotal,a.bytesLoaded-d.thresholdBytes,a.bytesTotal-d.thresholdBytes);d.indicator.css("width",(a.bytesLoaded-d.thresholdBytes)/(a.bytesTotal-d.thresholdBytes)*100+"%");d.text.html(b)});a.listen("fetch.complete",function(a){d.thresholdBytes=a.bytesLoaded;d.thresholdFiles=a.filesLoaded;d.stopped=setTimeout(function(){d.el.fadeOut(600,function(){d.stopped=!0})},1E3)})}).init(function(){}).ready(function(){});
e("Plugin.Progress",c)})(jQuery,THREE,THREEAPP);(function(b,c){function e(a,b,c){b||(b="f");this.uniforms[a]||(this.uniforms[a]={type:b,value:c||0});return this.uniforms[a]}b=c.Class.create("Uniforms",null,["Plugin"]).ctor(function(a){a.uniforms=[];a.uniform=e}).ready(function(a){a.hasOwnProperty("time")&&a.listen("preframe",function(){a.uniform("time").value=a.time},999999)});c("Plugin.Uniforms",b)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("Background",null,["Plugin"]).proto("requires","renderer").proto("provides","background").ctor(function(a){a.bg=a.options.bg?new a.options.bg(a):new b.Scene(a);a.listen("render",function(){a.invoke("render-background");a.renderer.render(a.bg,a.camera)},99)});c("Plugin.Background",e)})(THREE,THREEAPP);
(function(b,c){var e=c.Class.create("LOD",c.Object3D,["Plugin"]).proto("provides","lod").proto("requires","camera").proto("requires","ui").ctor(function(a){a.lods=[]}).ready(function(a){a.listen("update-ui",function(){var d=new b.Matrix4;d.multiplyMatrices(a.camera.projectionMatrix,a.camera.matrixWorldInverse);var c=new b.Frustum;c.setFromMatrix(d);d=a.camera.getWorldPosition();for(var e="",h=document.getElementById("lodInfo"),l=0,u=a.lods.length;l<u;l++){var m=a.lods[l].getWorldPosition(),q=d.distanceToSquared(m);
a.lods[l].inFrustum=c.intersectsSphere({center:m,radius:a.lods[l].radius||100});e+=sprintf("%02d) %.5f",l,q);if(a.lods[l].inFrustum){q*=Math.pow(a.camera.fov,2);m=a.lods[l].options.lod;var n=0,p=m.length;if(n<p&&!m[n])debugger;for(;n<p&&q<m[n].min;)++n;n==p&&(n=-1);a.lods[l].level!=n&&(a.lods[l].level=n,a.lods[l].trigger("lod"));e+=" - lvl "+n+"<br>"}else e+=" - hidden<br>"}h&&(h.innerHTML=e)})});c("Plugin.LOD",e)})(THREE,THREEAPP);
(function(b,c){b=c.Class.create("UI",null,["Plugin"]).proto("provides","ui").ctor(function(b){var a=this;a.frames=9999;b.listen("postframe",function(){6<++a.frames&&(a.frames=0,b.trigger("update-ui"))})});c("Plugin.UI",b)})(THREE,THREEAPP);
var StatsGPU=function(){function b(a,b,d){a=document.createElement(a);a.id=b;a.style.cssText=d;return a}function c(a,d,c){var e=b("div",a,"padding:0 0 3px 3px;text-align:left;background:"+c),f=b("div",a+"Text","font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:"+d);f.innerHTML=a.toUpperCase();e.appendChild(f);a=b("div",a+"Graph","width:94px;height:30px;background:"+d);e.appendChild(a);for(d=0;94>d;d++)a.appendChild(b("span","","width:1px;height:30px;float:left;opacity:0.9;background:"+
c));return e}function e(a){for(var b=u.children,d=0;d<b.length;d++)b[d].style.display=d===a?"block":"none";l=a}function a(a,b){a.appendChild(a.firstChild).style.height=Math.min(30,30-30*b)+"px"}var d=self.performance&&self.performance.now?self.performance.now.bind(performance):Date.now,g=d(),r=g,h=0,l=0,u=b("div","statsGPU","width:100px;opacity:0.9;cursor:pointer");u.addEventListener("mousedown",function(a){a.preventDefault();e(++l%u.children.length)},!1);var m=0,q=Infinity,n=0,p=c("fps","#0ff","#002"),
x=p.children[0],z=p.children[1];u.appendChild(p);var y=0,w=Infinity,v=0;p=c("ms","#0f0","#020");var C=p.children[0],D=p.children[1];u.appendChild(p);if(self.performance&&self.performance.memory){var A=0,B=Infinity,t=0;p=c("mb","#f08","#201");var E=p.children[0],k=p.children[1];u.appendChild(p)}e(l);return{REVISION:14,domElement:u,setMode:e,begin:function(){g=d()},end:function(){var b=d();y=b-g;w=Math.min(w,y);v=Math.max(v,y);C.textContent=(y|0)+" MS ("+(w|0)+"-"+(v|0)+")";a(D,y/200);h++;if(b>r+1E3&&
(m=Math.round(1E3*h/(b-r)),q=Math.min(q,m),n=Math.max(n,m),x.textContent=m+" FPS ("+q+"-"+n+")",a(z,m/100),r=b,h=0,void 0!==A)){var c=performance.memory.usedJSHeapSize,e=performance.memory.jsHeapSizeLimit;A=Math.round(9.54E-7*c);B=Math.min(B,A);t=Math.max(t,A);E.textContent=A+" MB ("+B+"-"+t+")";a(k,c/e)}return b},update:function(){g=this.end()}}};"object"===typeof module&&(module.exports=StatsGPU);
(function(b,c){b=c.Class.create("MonitorGPU",null,["Plugin"]).ready(function(b){var a=new StatsGPU;b.viewport.appendChild(a.domElement);b.listen("preframe",function(){a.begin()});b.listen("postframe",function(){a.end()})});c("Plugin.MonitorGPU",b)})(THREE,THREEAPP);
(function(b){function c(){var a=arguments[0],b=c.cache;b[a]&&b.hasOwnProperty(a)||(b[a]=c.parse(a));return c.format.call(null,b[a],arguments)}function e(a){return"number"===typeof a?"number":"string"===typeof a?"string":Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var a=/[^T]/,d=/[^v]/,g=/[diefg]/,r=/bcdiefguxXS/,h=/[j]/,l=/^[^\x25]+/,u=/^\x25{2}/,m=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxXSDR])/,q=/^([a-z_][a-z_\d]*)/i,n=/^\.([a-z_][a-z_\d]*)/i,
p=/^\[(\d+)\]/,x=/^[\+\-]/;c.format=function(b,l){var m=1,p=b.length,n=[],u,t,q=!0;for(u=0;u<p;u++){var k=e(b[u]);if("string"===k)n[n.length]=b[u];else if("array"===k){k=b[u];if(k[2]){var f=l[m];for(t=0;t<k[2].length;t++){if(!f.hasOwnProperty(k[2][t]))throw Error(c('[sprintf] property "%s" does not exist',k[2][t]));f=f[k[2][t]]}}else f=k[1]?l[k[1]]:l[m++];a.test(k[8])&&d.test(k[8])&&"function"==e(f)&&(f=f());if(r.test(k[8])&&"number"!=e(f)&&isNaN(f))throw new TypeError(c("[sprintf] expecting number but found %s",
e(f)));g.test(k[8])&&(q=0<=f);switch(k[8]){case "b":f=parseInt(f,10).toString(2);break;case "c":f=String.fromCharCode(parseInt(f,10));break;case "d":case "i":f=parseInt(f,10);break;case "j":f=JSON.stringify(f,null,k[6]?parseInt(k[6]):0);break;case "e":f=k[7]?parseFloat(f).toExponential(k[7]):parseFloat(f).toExponential();break;case "f":f=k[7]?parseFloat(f).toFixed(k[7]):parseFloat(f);break;case "g":f=k[7]?parseFloat(f).toPrecision(k[7]):parseFloat(f);break;case "o":f=f.toString(8);break;case "s":f=
String(f);f=k[7]?f.substring(0,k[7]):f;break;case "t":f=String(!!f);f=k[7]?f.substring(0,k[7]):f;break;case "S":if(1024>Math.abs(f))f+=" B";else{t="KiB MiB GiB TiB PiB EiB ZiB YiB".split(" ");var v=-1;do f/=1024,++v;while(1024<=Math.abs(f)&&v<t.length-1);f=f.toFixed(1)+t[v]}break;case "R":v=f/Math.PI*180;f=v%1*60;t=f%1*60;f=c("%02d\u00b0 %02d' %0.2f\"",v,f,t);break;case "D":f+=Math.PI;v=f/Math.PI*12;f=v%1*60;t=f%1*60;f=c("%02dh %02dm %0.2fs",v,f,t);break;case "T":f=e(f);f=k[7]?f.substring(0,k[7]):
f;break;case "u":f=parseInt(f,10)>>>0;break;case "v":f=f.valueOf();f=k[7]?f.substring(0,k[7]):f;break;case "x":f=parseInt(f,10).toString(16);break;case "X":f=parseInt(f,10).toString(16).toUpperCase()}if(h.test(k[8]))n[n.length]=f;else{!g.test(k[8])||q&&!k[3]?v="":(v=q?"+":"-",f=f.toString().replace(x,""));t=k[4]?"0"===k[4]?"0":k[4].charAt(1):" ";var w=k[6]-(v+f).length;w=k[6]?0<w?0<=w&&7>=w&&y[t]?y[t][w]:Array(w+1).join(t):"":"";n[n.length]=k[5]?v+f+w:"0"===t?v+w+f:w+v+f}}}return n.join("")};c.cache=
{};c.parse=function(a){for(var b,d=[],c=0;a;){if(null!==(b=l.exec(a)))d[d.length]=b[0];else if(null!==(b=u.exec(a)))d[d.length]="%";else if(null!==(b=m.exec(a))){if(b[2]){c|=1;var e=[],h=b[2],g;if(null!==(g=q.exec(h)))for(e[e.length]=g[1];""!==(h=h.substring(g[0].length));)if(null!==(g=n.exec(h)))e[e.length]=g[1];else if(null!==(g=p.exec(h)))e[e.length]=g[1];else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");
b[2]=e}else c|=2;if(3===c)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");d[d.length]=b}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(b[0].length)}return d};var z=function(a,b,d){d=(b||[]).slice(0);d.splice(0,0,a);return c.apply(null,d)},y={0:" 0 00 000 0000 00000 000000 0000000".split(" ")," ":"; ;  ;   ;    ;     ;      ;       ".split(";"),_:" _ __ ___ ____ _____ ______ _______".split(" ")};"undefined"!==typeof exports?(exports.sprintf=
c,exports.vsprintf=z):(b.sprintf=c,b.vsprintf=z,"function"===typeof define&&define.amd&&define(function(){return{sprintf:c,vsprintf:z}}))})("undefined"===typeof window?this:window);
(function(b,c,e){var a=requestAnimationFrame;b=e.Class.create("ThreeApp",null,["Events","Options"]).defaults({root:".",log:{debug:!1,info:!1,warn:!0}}).ctor(function(a,b){this.frames=9999;this.viewport=a;this.root=this.options.root.split(/\/+/);e.extend(this.options,b)}).init(function(a,b){a=this;b=this.options;for(var d=this.options.plugins||[],c=[].concat(d),e=0;e<c.length;){var g=c[e].prototype.required;if(g&&g.length)++e;else{g=c.splice(e,1)[0];if(g.prototype.provided){for(var m=g.prototype.provided,
q=0;q<c.length;q++)for(var n in m){e=c[q].prototype.required;var p=(e||[]).indexOf(n);-1!=p&&e.splice(p,1)}e=0}m=g.prototype.name;g=new g(this,b[m]);d[q]=d[m]=g;a.wait&&a.wait(d[q])}}if(c.length){for(q=0;q<c.length;q++)m=c[q].name,e=c[q].prototype.required,console.warn(m,"is missing",e);throw Error("Missing or circular dependencies");}a.plugins=d}).ready(function(){var a=this;this.options.start&&window.setTimeout(function(){a.start()},0)}).method("start",function(){var b=this;b.started||b.paused||
(a(function(){b.render.call(b)}),b.started=!0)}).method("resize",function(a,b){this.width=a;this.height=b;this.invoke("resized")}).method("log",function(){this.options.log.debug&&console.log(sprintf.apply(this,arguments))}).method("warn",function(){this.options.log.warn&&console.warn(sprintf.apply(this,arguments))}).method("info",function(){this.options.log.info&&console.info(sprintf.apply(this,arguments))}).method("path",function a(a){a=a.split(/\/+/);return this.root.concat(a).join("/")}).method("render",
function(){var b=this;b.invoke("preframe");b.invoke("render");b.invoke("postframe");b.started&&a(function(){b.render.call(b)});++b.frames});e("App",b)})(self,THREE,THREEAPP);

/* crc: 2F2C0FEB633D96F0062A3FAC3FD37017 */
