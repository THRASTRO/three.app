/* autogenerated by webmerge (join context) */
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (module, THREE)
{
	"use strict";

	// preserve old stuff
	var preserve = module.THREEAPP;

	// declare global namespace
	function THREEAPP(name, obj)
	{
		// split the name (by dots) into parts
		var parts = name.split(/\./), ns = THREEAPP;
		// process each part and create objects
		for (var i = 0; i < parts.length - 1; i ++) {
			// create namespace part
			if (!ns[parts[i]]) {
				ns[parts[i]] = {};
			}
			// climb the namespace
			ns = ns[parts[i]];
		}
		// return value if only name is given
		if (arguments.length == 1) {
			return ns[parts[i]];
		}
		// trying to overwrite existing
		// move object values to function
		var existingType = typeof ns[parts[i]];
		if (existingType == "object") {
			var old = ns[parts[i]];
			for (var key in old) {
				if (old.hasOwnProperty(key)) {
					obj[key] = old[key];
				}
			}
		}
		// error out to avoid unexpected bugs
		else if (existingType != "undefined") {
			throw Error("Namespace already taken!")
		}
		// assign to final result
		return ns[parts[i]] = obj;
	};
	// EO THREEAPP

	// copy over preserved stuff
	if (typeof preserve == "object") {
		for (var key in preserve) {
			if (preserve.hasOwnProperty(key)) {
				THREEAPP[key] = preserve[key];
			}
		}
	}

	// Pass in the objects to merge as arguments.
	// Vanilla JavaScript version of jQuery extend
	// For a deep extend, set the first argument to `true`.
	// http://gomakethings.com/vanilla-javascript-version-of-jquery-extend/
	function extend() {

		// Variables
		var extended;
		var deep = false;
		var i = 0;
		var length = arguments.length;

		// Check if a deep merge
		if ( Object.prototype.toString.call( arguments[0] ) === '[object Boolean]' ) {
			deep = arguments[0];
			i++;
		}

		// Merge the object into the extended object
		function merge (obj) {
			for ( var prop in obj ) {
				if ( Object.prototype.hasOwnProperty.call( obj, prop ) ) {
					// If deep merge and property is an object, merge properties
					if ( deep && Object.prototype.toString.call(obj[prop]) === '[object Object]' ) {
						extended[prop] = extend( true, extended[prop], obj[prop] );
					}
					// needed to properly mixin listeners
					// otherwise we would share the array
					// ToDo: solve this more elegantly
					else if (deep && obj[prop] instanceof Array) {
						if (typeof extended[prop] == "undefined") extended[prop] = [];
						extended[prop] = extended[prop].concat(obj[prop]);
					} else {
						extended[prop] = obj[prop];
					}
				}
			}
		};

		// Extend first object
		extended = arguments[i++];
		// Loop and merge objects
		for ( ; i < length; i++ ) {
			merge(arguments[i]);
		}

		// Return results
		return extended;

	}
	// EO extend

	// simple template function
	// replace %key% with props
	function tmpl (str, props)
	{
		return str.replace(/%([a-zA-Z][a-zA-Z0-9]*)%/g, function (match, token) {
			return props[token] ? props[token] : '[%' + token + '%]';
		});
	}

	// merges prototypes
	function mixin(dst, src)
	{
		if (!src || !dst) debugger;
		var p_dst = dst.prototype;
		var p_src = src.prototype;
		for (var name in p_src) {

			if (p_src.hasOwnProperty(name)) {
				// Concatenate arrays (i.e. listeners)
				if (p_src[name] instanceof Array) {
					if (!p_dst[name]) p_dst[name] = [];
					p_dst[name] = p_dst[name].concat(p_src[name]);
				}
				// Functions are also instances of Object!
				else if (p_src[name] instanceof Function) {
					p_dst[name] = p_src[name];
					extend(p_dst[name], p_src[name]);
				}
				// Deep merge objects (hash maps)
				else if (p_src[name] instanceof Object) {
					if (!p_dst[name]) p_dst[name] = {};
					extend(true, p_dst[name], p_src[name]);
				}
				// Otherwise just assign
				else {
					p_dst[name] = p_src[name];
				}
			}
		}

	}
	// EO mixin

	// assign static functions
	THREEAPP('extend', extend);
	THREEAPP('mixin', mixin);
	THREEAPP('tmpl', tmpl);

	module.THREEAPP = THREEAPP;

// EO private scope
})(self, THREE);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// class constructor
	function Class (klass, base)
	{
		// must not be called, but ctor proto is needed
		// throw Error("cannot instantiate static class");
	}
	// EO class constructor

	// method: initialize
	function initialize ()
	{
		// duplicates are often unavoidable
		// best example is THREE.Object3D
		var seen = {}, ctors = this.ctor;
		// execute all constructors once
		for (var i = 0; i < ctors.length; i++) {
			if (seen[ctors[i]]) continue;
			ctors[i].apply(this, arguments);
			seen[ctors[i]] = true;
		}
		// local access var
		var inits = this.init;
		// enable the wait method
		this.__proto__.wait = wait;
		// then call init for all mixins
		for (var i = 0; i < inits.length; i++) {
			if (seen[inits[i]]) continue;
			inits[i].apply(this, arguments);
			seen[inits[i]] = true;
		}
	}
	// EO initialize

	// method: startup
	// tests if we are ready first
	// invokes handlers once we are
	function startup ()
	{
		// assert that we have no pendings
		if (this.pending > 0) return this;
		// remove the wait method
		delete this.__proto__.wait;
		// execute all ready events (mixins and base)
		for (var i = 0; i < this.ready.length; i++) {
			this.ready[i].apply(this, arguments);
		}
		// listeners is part of events!?
		if (this.listeners) {
			var readies = this.listeners.ready || [];
			for (var i = 0; i < readies.length; i++) {
				readies[i].apply(this, arguments);
			}
		}
		// remove temporary flag
		delete this.pending;
		// set status flag
		this.isReady = true;
		// chainable
		return this;
	}
	// EO startup

	// bread and butter mixin function
	function mixin (klass, base, mixins)
	{

		if (!base) base = THREEAPP.Class;
		// upgrade single mixin to an array
		if (!Array.isArray(mixins)) mixins = [mixins];
		// error out to catch missing mixins
		if (!mixins) throw Error("Undefined mixin!");
		// create mandatory arrays
		if (!klass.prototype.ctor)
			klass.prototype.ctor = [];
		if (!klass.prototype.init)
			klass.prototype.init = [];
		if (!klass.prototype.ready)
			klass.prototype.ready = [];
		if (!klass.prototype.defaults)
			klass.prototype.defaults = {};
		if (!klass.prototype.listeners)
			klass.prototype.listeners = {};

		// check for valid mixins
		// resolve strings to classes
		if (mixins && mixins.length) {
			for (var i = 0, L = mixins.length; i < L; i++) {
				// hard assert that all mixins are loaded
				if (!(mixins[i])) throw Error('Undefined mixin!');
				// mixins may optionally be strings (remove?)
				if (!(mixins[i] instanceof Function)) {
					var resolved = THREEAPP(mixins[i]);
					if (typeof resolved == 'undefined') {
						throw Error('Unknown mixin: ' + mixins[i]);
					}
					mixins[i] = resolved;
				}
			}
		}

		// listeners is part of events!?
		// copy listeners to our own prototype
		// ToDo: unsure if this is still needed
		// intention: stop inheritance sharing
		klass.prototype.listeners = THREEAPP.extend
			(true, {}, klass.prototype.listeners);

		// copy everyting from mixins to final class
		for (var i = 0; i < mixins.length; i ++) {
			// mixin stuff from source class
			THREEAPP.mixin(klass, mixins[i]);
		}
		// mixin stuff from base class
		THREEAPP.mixin(klass, base);

		// can only have one base class (last counts)
		// this line enables the instanceof functionality
		// in this sense JS does not have true polymorphism
		if (base) klass.prototype.__proto__ = base.prototype;

		// declare a few chainable prototype helper functions
		// these are used to construct the actual class definition
		// functions are called on the prototype of a class to extend it
		// this is an example of the neat/evil extensibility of javascript!

		// create a static function on the klass namespace (has no `this`!)
		klass.static = function (name, fn) { klass[name] = fn; return this; };
		// create a regular method that gets passed a valid object instace as `this`
		klass.method = function (name, fn) { klass.prototype[name] = fn; return this; };

		// not very happy with this solution, but it works reasonable (use by service)
		klass.proto = function (name, arg) { klass.prototype[name](arg); return this; };

		// add default options to the class (different mixins might overwrite each other)
		klass.defaults = function (obj) { THREEAPP.extend(klass.prototype.defaults, obj); return this; };

		// register main setup functions for the three different life-cycle stages
		klass.ctor = function (fn) { klass.prototype.ctor.push(fn); return this; };
		klass.init = function (fn) { klass.prototype.init.push(fn); return this; };
		klass.ready = function (fn) { klass.prototype.ready.push(fn); return this; };


		// register event listeners
		// listeners is part of events!?
		klass.listen = function (name, fn, prio) {
			var listeners = klass.prototype.listeners;
			if (!listeners[name]) listeners[name] = [];
			if (prio != null) fn.prio = prio;
			listeners[name].push(fn);
			// dispatch late registered ready events
			if (name == "ready" && this.isReady) {
				fn.call(this);
			}
			return this;
		};
		// return function
		return klass;

	}

	// static function to create a new class
	Class.create = function ()
	{
		// name is optional first argument (shift aways to get to other args)
		var name = typeof arguments[0] == 'string' ? [].shift.call(arguments) : null;
		// get the additional arguments (init with usefull defaults)
		var base = arguments[0] || Class, mixins = arguments[1] || [];
		// create new constructor
		var Klass = function () {
			// waiting promises
			this.pending = 0;
			// instance options (defaults are shared)
			this.options = THREEAPP.extend ({}, this.defaults);
			// call all init functions
			initialize.apply(this, arguments);
			// tests if anything is pending
			startup.apply(this, arguments);
		}
		// give the function a name (there is some cost attached to eval)
		// there is no other way and it helps debugging in the console a lot!
		if (name) eval("Klass = " + Klass.toString().replace(/\(\)/, name + '()'));
		// dispatch to the bread and butter mixin fn
		return mixin.call(Class, Klass, base, mixins);
	}

	// static function to create a new mixin
	// var Mixin = Class.mixin(['a','b'])
	Class.mixin = function (mixins)
	{
		// base constructor
		var klass = function () {
			// must not be called, but ctor proto is needed
			// errors out if you try to instantiate a mixin
			throw Error("Can't instantiate mixins");
		}
		// dispatch to the bread and butter mixin fn
		if (arguments.length < 1) mixins = [];
		return mixin.call(Class, klass, null, mixins);
	}

	// static function to create virtual mixin
	Class.virtual = function (base, mixins)
	{
		// ensure valid defaults
		if (arguments.length == 0) base = Class;
		if (!base) throw Error("Undefined virtual base!");
		// virtual constructor
		var klass = function () {
			// must not be called, but ctor proto is needed
			throw Error("cannot instantiate virtual class");
		}
		// upgrade single mixin to an array
		if (arguments.length < 2) mixins = [];
		// dispatch to the bread and butter mixin fn
		return mixin.call(Class, klass, base, mixins);
	}


	// method: wait
	// disabled after ready!
	function wait (promise)
	{
		var obj = this;
		// one more pending
		obj.pending ++;
		// continuation fn
		function resolve () {
			// decrement and check
			obj.pending -= 1;
			// has own check
			startup.apply(obj);
		}
		// bail out hard
		function reject (err) {
			throw err;
		}
		// developer assertion (forgot to load deps?)
		if (!promise) throw Error('Invalid wait call');

		// register class observers via listen
		if (typeof promise.listen == "function") {
			promise.listen('ready', resolve);
		}
		// register generic promise observers
		else if (typeof promise.then == "function") {
			promise.then(resolve, reject);
		}
		// throw if passed object is invalid
		else throw Error("Invalid wait promise");
		// return chainable result
		return startup.apply(obj);
	}
	// EO initialize

	// Explicitly set the constructor again
	Class.prototype.constructor = Class;

	// assign class to global namespace
	THREEAPP('Class', Class);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) class
	var Options = THREEAPP.Class.mixin()

	.ctor(function (app, options) {
		// store app ref
		this.app = app;
		// extend the existing options
		// this.options is already a copy
		THREEAPP.extend(this.options, options);
	})

	// end of class
	;

	// assign class to global namespace
	THREEAPP('Options', Options);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// sort listener functions
	// supports prio property
	function prioSort(a, b)
	{
		return (b.prio || 0) - (a.prio || 0);
	}

	// create a new (augmented) class
	var Events = THREEAPP.Class.mixin(['Options'])

	// copy some object over
	.ctor(function ctor(app, options) {
		// inherit listeners from prototype (make a copy)
		// if (options && options.listeners) debugger;
		this.listeners = THREEAPP.extend(true, {}, this.listeners, this.options.listeners);
		// status object to defer only once
		this.deferred = {};
	})

	// register listener for an event
	.method('listen', function listen(name, fn, prio) {
		// invoke late registered ready event handler
		if (name == "ready" && this.isReady) fn.call(this);
		// set handler priority if passed
		// use when passing anonymous functions
		if (prio != null) fn.prio = prio;
		// make sure event already has an array
		if (!this.listeners.hasOwnProperty(name))
			this.listeners[name] = [];
		// get listeners array for the event
		var listeners = this.listeners[name];
		// check if function is already known
		var idx = listeners.indexOf(fn);
		// only add unique listeners
		if (idx == -1) listeners.push(fn);
		// sort by priorities
		listeners.sort(prioSort);
	})

	// invoke all listeners (synchronous)
	.method('invoke', function invoke(name) {
		var self = this; // scope closure
		var args = Array.prototype.slice.call(arguments, 1);
		var listeners = self.listeners[name];
		var i = 0, L = listeners ? listeners.length : 0;
		for (; i < L; i++) listeners[i].apply(self, args);
		self.deferred[name] = false;
	})

	// trigger all listeners (asynchronous)
	// call multiple times, execute only once
	.method('trigger', function trigger(name) {
		var self = this; // scope closure
		if (!self.deferred[name]) { // only once
			var args = Array.prototype.slice.call(arguments, 1);
			self.deferred[name] = window.setTimeout(function() {
				var listeners = self.listeners[name];
				var i = 0, L = listeners ? listeners.length : 0;
				for (; i < L; i++) listeners[i].apply(self, args);
				self.deferred[name] = false;
			}, 0);
		}
	})

	// end of class
	;

	// assign class to global namespace
	THREEAPP('Events', Events);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) mixin class
	var Plugin = THREEAPP.Class.mixin(['Events'])

	// create data structures
	.method('required', [])
	.method('provided', {})

	// delay init until requirements are met
	.method('requires', function (requires)
	{
		// add provides to array
		if (Array.isArray(requires)) {
			this.required = this.required
				.concat(requires);
		}
		else {
			this.required.push(requires);
		}
		// chainable
		return this;
	})
	// EO method requires

	// plugins can provide services
	.method('provides', function (provides)
	{
		// local variable access
		var provided = this.provided;
		// upgrade single item to an array (overhead is ok)
		if (!Array.isArray(provides)) provides = [provides];
		// process and add each provided service
		for (var i = 0, iL = provides.length; i < iL; ++ i) {
			// assert that only one provider exists
			if (provided.hasOwnProperty(provides[i])) {
				throw Error("Duplicate service provider");
			}
			// flag provided service
			provided[provides[i]] = true;
		}
		// chainable
		return this;
	})
	// EO method provides

	;

	// assign class to global namespace
	THREEAPP('Plugin', Plugin);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var resources = {};

	// if you get "prefetch not a function"
	// you probably calling it too early
	// only available after constructor
	// actual load starts on object init
	function prefetch (obj)
	{
		for (var name in obj) {
			this.resources[name] = obj[name]
		}
	}

	// mixin function to get asset
	// only available after ready
	function asset (name, def) {
		// return default if not existing
		if (!this.assets[name]) return def;
		// return the shared asset
		return this.assets[name][2].data;
	}

	// create new mixin class
	var Resources = THREEAPP.Class.mixin(['Options', 'Events'])

	// constructor
	.ctor(function(app, options) {

		// loaded assets
		this.assets = {};
		// add prefetch method
		this.prefetch = prefetch;
		// expose shared object
		app.resources = resources;
		// copy static class resources to instance
		// may add or change resources for instances
		this.resources = jQuery.extend({}, this.resources, this.options.resources);
		// hook up event listener to complete resource loading
		app.listen('loader.complete', function (resource, data)
		{
			var L = resource.cbs.length;
			// store result on resources
			for (var i = 0; i < L; i++) {
				// store received data on asset
				resource.cbs[i].assets[2] = resource;
				// resolve optional promise
				if (resource.cbs[i].resolve)
				{ resource.cbs[i].resolve(); }
				// mark resource as complete
				resource.complete = true;
				// attach the result
				resource.data = data;
			}
		});

	})

	.init(function (app) {

		var self = this;
		var manager = app.manager;
		var assets = self.resources;
		for (var name in assets) {
			// type is first array item
			var type = assets[name][0];
			// url is second array item
			var url = assets[name][1];
			// further items are internal
			// shared accross instances
			this.assets[name] = assets[name];
			// check if we already load that url
			// loading same url with different types
			// is not supported, aka undefined behavior
			if (app.resources[url]) {
				// initialize defaults and store references
				var asset = { obj: this, assets: assets[name] };
				// maybe the asset was already loaded
				if (app.resources[url].complete) {
					// attach data to other object (why copy?)
					assets[name][2] = app.resources[url];
					// next asset
					continue;
				}
				// the whole loader chain will be async!
				this.wait(new Promise(function (resolve, reject) {
					// attach promise handlers
					asset.reject = reject;
					asset.resolve = resolve;
					// register another handler
					app.resources[url].cbs.push(asset);
				}));
				// next asset
				continue;
			}
			// otherwise add asset to our loader queue
			var type = type.substr(0, 1).toUpperCase(), loader;
			if (type == 'S') loader = new THREE.TextLoader( manager );
			else if (type == 'T') loader = new THREE.TextureLoader( manager );
			else if (type == 'I') loader = new THREE.ImageLoader( manager );
			else if (type == 'J') loader = new THREE.JsonLoader( manager );
			else if (type == 'A') loader = new THREE.ArrayLoader( manager );
			else if (type == 'B') loader = new THREE.BlobLoader( manager );
			else if (type == 'R') loader = new THREE.BinaryLoader( manager );
			else if (type == 'O') loader = new THREE.ObjectLoader( manager );
			else if (type == 'L') loader = new THREE.OBJLoader( manager );
			else throw('Unknown loader type for resource');
			// initialize defaults and store references
			var asset = { obj: this, assets: assets[name] };
			// the whole loader chain will be async!
			this.wait(new Promise(function (resolve, reject) {
				// attach promise handlers
				asset.reject = reject;
				asset.resolve = resolve;
				// create status object on initial/first load
				app.resources[url] = { total: 0, loaded: 0, cbs: [asset] };
				// invoke the choosen loader implementation
				(function (type, url, resource) {
					// no way around a closure
					loader.load( url, function loaded(data) {
						app.invoke('loader.complete', resource, data);
					}, function progress(evt) {
						app.invoke('loader.progress', self, resource, evt);
					}, reject);
				})(type, url, app.resources[url]);
			}));
		}
	})

	.ready(function () {
		// add asset method
		this.asset = asset;
	})

	.listen('ready', function () {
		if (this.options.container) {
			this.options.container.add(this);
		}
	})

	// end
	;

	// assign class to global namespace
	THREEAPP('Resources', Resources);

})(THREE, THREEAPP);
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.ArrayLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.ArrayLoader.prototype = {
	constructor: THREE.ArrayLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( manager );
		if (url.match(/\.lzma$/)) {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, function (buffer) {
				app.wlzma.decode(buffer)
				.then(function (outStream) {
					var arr = outStream.toUint8Array();
					onLoad.call(this, arr.buffer);
				})
				.catch(onError);
			}, onProgress, onError );
		} else {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, onLoad, onProgress, onError );
		}
	}
};
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.BlobLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.BlobLoader.prototype = {
	constructor: THREE.BlobLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( manager );
		if (url.match(/\.lzma$/)) {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, function (buffer) {
				app.wlzma.decode(buffer)
				.then(function (outStream) {
					var blob = new Blob(outStream.buffers);
					if (typeof blob != "object") {
						throw Error("Invalid BLOB");
					}
					else onLoad.call(this, blob);
				})
				.catch(onError);
			}, onProgress, onError );
		} else {
			loader.setResponseType( "blob" );
			loader.load( url, function (blob) {
				if (!blob) throw Error("Invalid BLOB");
				else return onLoad.apply(this, arguments);
			}, onProgress, onError );
		}
	}
};
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.DataLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.DataLoader.prototype = {
	constructor: THREE.DataLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( manager );
		if (url.match(/\.lzma$/)) {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, function (buffer) {
				app.wlzma.decode(buffer)
				.then(function (outStream) {
					var json = JSON.parse(outStream);
					if (typeof json != "object") {
						throw Error("Invalid JSON");
					}
					else onLoad.call(this, json);
				})
				.catch(onError);
			}, onProgress, onError );
		} else {
			loader.setResponseType( "json" );
			loader.load( url, function (json) {
				if (!json) throw Error("Invalid JSON");
				else return onLoad.apply(this, arguments);
			}, onProgress, onError );
		}
	}
};
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.JsonLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.JsonLoader.prototype = {
	constructor: THREE.JsonLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( manager );
		if (url.match(/\.lzma$/)) {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, function (buffer) {
				app.wlzma.decode(buffer)
				.then(function (outStream) {
					var json = JSON.parse(outStream);
					if (typeof json != "object") {
						throw Error("Invalid JSON");
					}
					else onLoad.call(this, json);
				})
				.catch(onError);
			}, onProgress, onError );
		} else {
			loader.setResponseType( "json" );
			loader.load( url, function (json) {
				if (!json) throw Error("Invalid JSON");
				else return onLoad.apply(this, arguments);
			}, onProgress, onError );
		}
	}
};
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.TextLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.TextLoader.prototype = {
	constructor: THREE.TextLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( this.manager );
		if (url.match(/\.lzma$/)) {
			loader.setResponseType( "arraybuffer" );
			loader.load( url, function (buffer) {
				app.wlzma.decode(buffer)
				.then(function (outStream) {
					var string = outStream.toString();
					if (typeof string != "string") {
						throw Error("Invalid Text");
					}
					else onLoad.call(this, string);
				})
				.catch(onError);
			}, onProgress, onError );
		} else {
			loader.setResponseType( "text" );
			loader.load( url, onLoad, onProgress, onError );
		}
	}
};
;
/**
 * @author mgreter / https://www.github.com/mgreter
 */

THREE.TextureLoader = function ( manager ) {
	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;
};

THREE.TextureLoader.prototype = {
	constructor: THREE.TextureLoader,
	load: function ( url, onLoad, onProgress, onError ) {
		// debugger;
		var manager = this.manager, app = manager.app;
		var loader = new THREE.FileLoader( manager );
		var texture = new THREE.Texture();
		loader.setResponseType( "arraybuffer" );
		loader.load( url, function (buffer) {
			var type = 'application/octet-stream';
			if (url.search( /\.(jpe?g)$/ )) type = "image/jpeg";
			else if (url.search( /\.(png)$/ )) type = "image/png";
			else if (url.search( /\.(gif)$/ )) type = "image/gif";
			var blob = new Blob([buffer], { type: type });	
			var reader = new FileReader(blob);
			texture.image = document.createElementNS( 'http://www.w3.org/1999/xhtml', 'img' );
			texture.image.addEventListener( 'load', function () {
				// JPEGs can't have an alpha channel, so memory can be saved by storing them as RGB.
				texture.format = type == "image/jpeg" ? THREE.RGBFormat : THREE.RGBAFormat;
				texture.needsUpdate = true;
				if ( onLoad !== undefined ) {
					onLoad( texture );
				}
			});
			reader.addEventListener("load", function (result) {
				texture.image.src = reader.result;
			}, false);
			reader.readAsDataURL(blob);
		}, onProgress, onError );
		window.texture = texture;
		return texture;
	},
	setCrossOrigin: function ( value ) {
		this.crossOrigin = value;
		return this;
	},
	setPath: function ( value ) {
		this.path = value;
		return this;
	}
};
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create new virtual class (inherit THREE.Object3D)
	var Object3D = THREEAPP.Class.virtual(THREE.Object3D)

	// constructor
	.ctor(function(app, options) {
		// Call Object3D initializer
		THREE.Object3D.call(this);
		this.matrixAutoUpdate = true;
		this.sortObjects = true;
	})

	// end
	;

	// assign class to global namespace
	THREEAPP('Object3D', Object3D);

})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function ()
{
	"use strict";

	// create new virtual class (inherit THREE.Scene)
	var Scene = THREEAPP.Class.virtual(THREE.Scene)

	// constructor
	.ctor(function(app, options) {
		// Call Scene initializer
		THREE.Scene.call(this);
	})

	// end
	;

	// assign class to global namespace
	THREEAPP('Scene', Scene);

})();
;
/*
	Add license text here
	Copyright 2016 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create new virtual class (inherit THREE.Object3D)
	var LOD = THREEAPP.Class.virtual(THREEAPP.Object3D, ['Events'])

	// constructor
	.ctor(function(app, options) {
		this.lod = [];
	})

	.ready(function (app) {

		app.lods.push(this);

		this.trigger('lod');
		
	})

	// invoked by global watcher
	.listen('lod', function() {
		var self = this;
		// is there anything to do?
		if (this.current != this.level) {
			if (this.level == -1) {
			}
			// create levels on demand
			// show level when loaded
			else {
				// instance not yet created?
				if (!this.lod[this.level]) {
					// get lod options for wanted level
					var opts = this.options.lod[this.level];
					var resources = {}; // fill from template
					for (var key in this.options.resources) {
						var r = this.options.resources[key];
						resources[key] = [r[0], THREEAPP.tmpl(r[1], opts)];
					}
					// mix options for current level of detail
					opts = THREEAPP.extend({}, this.options, opts, {
						resources: resources, container: this,
						// listeners: { ready: [function () { self.trigger('lod'); }] }
					});

					// invoke constructor for actual object
					this.lod[this.level] = new this.options.ctor(this.app, opts);

	//				debugger;
				}
					// check if instance is ready yet
				if (this.lod[this.level].isReady) {
					// check if previous object exists
					if (this.lod[this.current]) {
						// debugger;
						// remove previousely added object
						this.remove(this.lod[this.current]);
					}
					// add ready object for lod
					this.add(this.lod[this.level]);
					/*
					this.lod[this.level].position.x = 0;
					this.lod[this.level].position.y = 0;
					this.lod[this.level].position.z = 0;
					*/
					// update current state
					this.current = this.level;
				}
			}
		}
		// debugger;
	});
	
	// end
	;


	// assign class to global namespace
	THREEAPP('LOD', LOD);

})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Clock = THREEAPP.Class.create('Clock', null, ['Plugin'])

	.proto('provides', 'time')
	.proto('provides', 'clock')

	.ctor(function (app)
	{

		// time in ticks
		app.time = 0;

		// create a new clock instance
		app.clock = new THREE.Clock(false);
		// clock speed (external)
		app.clock.speed = 1 / 3600;

		// event handlers for clock start/stop
		app.listen('clock.pause', function () {
			app.clock.stop();
			app.clock.paused = true;
			app.trigger('clock.adjusted');
		})
		app.listen('clock.resume', function () {
			app.clock.start();
			app.clock.paused = false;
			app.trigger('clock.adjusted');
		})

		// event handlers for clock speed
		app.listen('clock.faster', function () {
			app.clock.speed *= 2;
			app.trigger('clock.adjusted');
		});
		app.listen('clock.slower', function () {
			app.clock.speed /= 2;
			app.trigger('clock.adjusted');
		});

		// reverse gear for time
		app.listen('clock.reverse', function () {
			app.clock.speed *= -1;
			app.trigger('clock.adjusted');
		});

		// reset to run sync with real time
		app.listen('clock.reset', function () {
			app.clock.speed = 1 / 3600;
			app.trigger('clock.adjusted');
		})

		app.listen('preframe', function () {
			var dtime = app.clock.getDelta();
			app.time += dtime * app.clock.speed;
		})

		app.clock.setSpeed = function (speed) {
			app.clock.speed = speed;
			app.trigger('clock.adjusted');
		};

	})

	.ready(function (app)
	{
		// start once ready?
		app.clock.start();
		app.clock.paused = false;
		// trigger once on startup
		app.trigger('clock.adjusted');
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Clock', Clock);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Scene = THREEAPP.Class.create('Scene', null, ['Plugin'])

	.proto('provides', 'scene')

	.ctor(function (app)
	{
		// initialize main scene
		app.scene = app.options.scene ?
		            new app.options.scene(app)
		            : new THREE.Scene(app);
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Scene', Scene);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	function resize(app)
	{
		app.resize(
			window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,
			window.window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight
		);
	}

	var AutoSize = THREEAPP.Class.create('AutoSize', null, ['Plugin'])

	.ctor(function (app)
	{
		var resizer = function() { resize(app); };
		addEventListener('resize', resizer, true);
		resize(app); // initial call
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.AutoSize', AutoSize);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var WebGLRenderer = THREEAPP.Class.create('WebGLRenderer', null, ['Plugin'])

	.proto('provides', 'renderer')

	.ctor(function (app)
	{

		// http://threejs.org/docs/#Reference/Renderers/WebGLRenderer
		app.renderer = new THREE.WebGLRenderer({
			sortObjects: true,
			antialias: true, // def: false
			precision: 'highp', // def: highp
			alpha: true, // def: false
			depth: true, // def: true
			stencil: true, // def: true
			premultipliedAlpha: true,
			preserveDrawingBuffer: true,
			logarithmicDepthBuffer: true, // def: false
			// make background transparent
			// clearAlpha: 0, clearColor: 0x000000,
		});
		// cannot set as an option!?
		app.renderer.autoClear = false;

		// hook into resized event
		app.listen('resized', function () {
			// set renderer size from app dimensions
			app.renderer.setSize(app.width, app.height);
		})
		// set initial size from app dimensions
		app.renderer.setSize(app.width, app.height);

		// attach the dom element
		app.viewport.appendChild(
			app.renderer.domElement
		);

		// listen to pre-render events
		app.listen('preframe', function () {
			app.renderer.clear();
		});

		// listen to main render events
		app.listen('render', function () {
			app.invoke('render-scene'); // synchronous
			app.renderer.render( app.scene, app.camera );
		})

	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.WebGLRenderer', WebGLRenderer);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var PerspectiveCamera = THREEAPP.Class.create('PerspectiveCamera', null, ['Plugin'])

	.proto('provides', 'camera')

	.ctor(function (app)
	{

		// http://threejs.org/docs/#Reference/Cameras/PerspectiveCamera
		app.camera = new THREE.PerspectiveCamera(
			this.options.fov || 65,
			( app.width / app.height ),
			this.options.near || 1e-6,
			this.options.far || 1e20
		);

		// add delta offset to avoid some bugs
		app.camera.position.x = 0.00000000001;

		// update whenever app is resized
		app.listen('resized', function () {
			// update camera aspect ratio and projection
			app.camera.aspect = app.width / app.height;
			app.camera.updateProjectionMatrix();
		});

	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.PerspectiveCamera', PerspectiveCamera);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var TrackballControls = THREEAPP.Class.create('TrackballControls', null, ['Plugin'])

	.proto('requires', 'camera')
	.proto('requires', 'renderer')

	.ctor(function (app)
	{
		// initialize the (custom) trackball controls (connect camera and renderer)
		app.controls = new THREE.TrackballControls(app.camera, app.renderer.domElement);
		// call control update before rendering a frame
		app.listen('preframe', function () { app.controls.update(); });
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.TrackballControls', TrackballControls);

// EO private scope
})(THREE, THREEAPP);



;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// implement as void function
	function loaded ( resource, data )
	{
		var L = resource.cbs.length;
		// store result on resources
		for (var i = 0; i < L; i++) {
			// store received data on asset
			resource.cbs[i].assets[2] = resource;
			// resolve optional promise
			if (resource.cbs[i].resolve)
			{ resource.cbs[i].resolve(); }
			// mark resource as complete
			resource.complete = true;
			// attach the result
			resource.data = data;
		}
	}

	function loadError()
	{
		this.invoke(
			'fetch.error', {}
		);
	}

	function loadStart()
	{
		var loader = this.loader;
		// only init once
		if (++ loader.completed == 1) {
			// trigger an event on the viewport
			this.trigger('prefetch.complete', this.loader);
			this.trigger('fetch.complete', this.loader);
		}
		else {
			// trigger an event on the viewport
			this.trigger('fetch.complete', this.loader);
		}
	}

	function loadStep(args) {
		var loader = this.loader;
		loader.filesTotal = args[2];
		loader.filesLoaded = args[1];
		this.trigger(
			'fetch.progress', {
				filesTotal: loader.filesTotal,
				filesLoaded: loader.filesLoaded,
				bytesTotal: loader.bytesTotal,
				bytesLoaded: loader.bytesLoaded
			}
		);
	}

	// progress updates asset info
	function progress (obj, asset, evt)
	{
		var loader = this.loader;
		// add total file size once
		if (asset.total == 0) {
			asset.total = evt.total;
			loader.bytesTotal += evt.total;
			loader.filesTotal += 1;
		}
		// increment loaded stats by delta of asset
		loader.bytesLoaded += evt.loaded - asset.loaded;

		// update singleton values
		asset.loaded = evt.loaded;

		// trigger the download progress
		// ToDo: throttle for better fps?
		this.trigger(
			'fetch.progress', {
				filesTotal: loader.filesTotal,
				filesLoaded: loader.filesLoaded,
				bytesTotal: loader.bytesTotal,
				bytesLoaded: loader.bytesLoaded
			}
		);

	}

	var Loader = THREEAPP.Class.create('Loader', null, ['Plugin'])

	.proto('provides', 'loader')

	.ctor(function (app) {
		// scope for closures
		var loader = this;
		app.loader = loader;
		// ready status
		loader.completed = 0;
		// init statistics
		loader.filesTotal = 0;
		loader.filesLoaded = 0;
		loader.bytesTotal = 0;
		loader.bytesLoaded = 0;
		// register event handlers
		app.listen('loader.step', loadStep);
		app.listen('loader.start', loadStart);
		app.listen('loader.error', loadError);
		app.listen('loader.complete', loaded);
		app.listen('loader.progress', progress);
	})

	.init(function (app) {
		// create shared loading manager instance
		app.manager = new THREE.LoadingManager(
			function () { app.invoke('loader.start', arguments); },
			function () { app.invoke('loader.step', arguments); },
			function () { app.invoke('loader.error', arguments); }
		);
		// create back reference
		app.manager.app = app;
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Loader', Loader);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (jQuery, THREE, THREEAPP)
{
	"use strict";

	var Progress = THREEAPP.Class.create('Progress', null, ['Plugin'])

	.ctor(function (app) {

		// create the main container
		this.el = jQuery('<div id="progressbar"/>');
		this.wrapper = jQuery('<div class="indicator"/>').appendTo(this.el);
		this.indicator = jQuery('<div class="bg"/>').appendTo(this.wrapper);
		this.text = jQuery('<div class="text"/>').appendTo(this.el);

		// append it to the viewport
		this.el.appendTo(app.viewport);

		// threshold for new loads
		this.thresholdFiles = 0;
		this.thresholdBytes = 0;

		// initialize stopped
		this.stopped = true;
		// hide main element
		this.el.hide();

		// just a sample how it's done
		this.indicator.css('width', 0 + '%');

		var _this = this;
		app.listen('fetch.progress', function (stats) {
			if (_this.stopped) {
				if (_this.stopped !== true) {
					clearTimeout(_this.stopped);
				}
				_this.el.fadeIn(200);
				_this.stopped = false;
			}
			var txt = sprintf("%d/%d (%S/%S)",
				stats.filesLoaded, stats.filesTotal,
				stats.bytesLoaded - _this.thresholdBytes,
				stats.bytesTotal - _this.thresholdBytes
			);
			var p = (stats.bytesLoaded - _this.thresholdBytes) /
				(stats.bytesTotal - _this.thresholdBytes);
			_this.indicator.css('width', (p * 100) + '%');
			_this.text.html(txt);
		})

		app.listen('fetch.complete', function (stats) {
			_this.thresholdBytes = stats.bytesLoaded;
			_this.thresholdFiles = stats.filesLoaded;
			// schedule the timeout for the closer
			_this.stopped = setTimeout(function () {
				_this.el.fadeOut(600, function () {
					_this.stopped = true;
				});
			}, 1000);
		})

	})

	.init(function () {
	})

	.ready(function () {
	})


	;

	// assign class to global namespace
	THREEAPP('Plugin.Progress', Progress);

// EO private scope
})(jQuery, THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// helper function to get a shared uniform
	// the uniform will be created on demand!
	function uniform(name, type, def)
	{
		// default type is float
		if (!type) type = 'f';
		// create uniform on demand
		if (!this.uniforms[name]) {
			this.uniforms[name] = {
				type: type,
				value: def || 0
			}
		}
		// return the shared uniform
		return this.uniforms[name];
	}

	var Uniforms = THREEAPP.Class.create('Uniforms', null, ['Plugin'])

	.ctor(function (app)
	{
		// store uniforms
		app.uniforms = [];
		// add uniform method
		app.uniform = uniform;
	})

	.ready(function (app)
	{
		if (app.hasOwnProperty("time")) {
			app.listen('preframe', function () {
				// update the shared time uniform
				app.uniform('time').value = app.time;
			}, 999999) // run very very early
		}
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Uniforms', Uniforms);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Background = THREEAPP.Class.create('Background', null, ['Plugin'])

	.proto('requires', 'renderer')
	.proto('provides', 'background')

	.ctor(function (app)
	{
		// init background scene
		app.bg = app.options.bg ?
		         new app.options.bg(app)
		         : new THREE.Scene(app);

		// listen to render events
		app.listen('render', function bg() {
			app.invoke('render-background');
			app.renderer.render( app.bg, app.camera );
		}, + 99) // run early (before scene)

	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Background', Background);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var LOD = THREEAPP.Class.create('LOD', THREEAPP.Object3D, ['Plugin'])

	.proto('provides', 'lod')
	.proto('requires', 'camera')
	.proto('requires', 'ui')

	.ctor(function (app)
	{
		// create array
		app.lods = [];
	})

	.ready(function (app) {

		// render ui is invoked debounced
		// no need to do this every frame!
		app.listen('update-ui', function () {

			var inv_mat = new THREE.Matrix4();
			inv_mat.multiplyMatrices(
				app.camera.projectionMatrix,
				app.camera.matrixWorldInverse
			);
			var frustum = new THREE.Frustum();
			frustum.setFromMatrix(inv_mat);
			var cam_pos = app.camera.getWorldPosition();

			var html = "", info = document.getElementById("lodInfo");
			for (var i = 0, L = app.lods.length; i < L; i++) {
				var pos = app.lods[i].getWorldPosition();
				var dist = cam_pos.distanceToSquared(pos);
				app.lods[i].inFrustum = frustum.intersectsSphere({
					center: pos, radius: app.lods[i].radius || 100
				});
				html += sprintf("%02d) %.5f", i, dist);
				if (!app.lods[i].inFrustum) {
					html += " - hidden<br>";
					continue;
				}
				// adjust dist by fov
				dist *= Math.pow(app.camera.fov, 2);
				var opts = app.lods[i].options.lod
				var lvl = 0, lvls = opts.length;
				// main loop to look for the correct break point
				if (lvl < lvls && !opts[lvl]) debugger;
				while (lvl < lvls && dist < opts[lvl].min) ++ lvl;
				if (lvl == lvls) lvl = -1;
				if (app.lods[i].level != lvl) {
					app.lods[i].level = lvl;
					app.lods[i].trigger('lod');
				}
				html += " - lvl " + lvl + "<br>";
			}
			if (info) info.innerHTML = html;
		})
	})

	// end of class
	;

	// assign class to global namespace
	THREEAPP('Plugin.LOD', LOD);

// EO private scope
})(THREE, THREEAPP);;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var UI = THREEAPP.Class.create('UI', null, ['Plugin'])

	.proto('provides', 'ui')

	.ctor(function (app)
	{
		var ui = this;
		// triggers on first check
		ui.frames = 9999;
		// render to interface on post-event
		app.listen('postframe', function () {
			// increment frame count
			if (++ ui.frames > 6) {
				// reset counter
				ui.frames = 0;
				// trigger deferred
				app.trigger('update-ui');
			}
		})
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.UI', UI);

// EO private scope
})(THREE, THREEAPP);
;
/**
 * @author mrdoob / http://mrdoob.com/
 */

var StatsGPU = function () {

	var now = ( self.performance && self.performance.now ) ? self.performance.now.bind( performance ) : Date.now;

	var startTime = now(), prevTime = startTime;
	var frames = 0, mode = 0;

	function createElement( tag, id, css ) {

		var element = document.createElement( tag );
		element.id = id;
		element.style.cssText = css;
		return element;

	}

	function createPanel( id, fg, bg ) {

		var div = createElement( 'div', id, 'padding:0 0 3px 3px;text-align:left;background:' + bg );

		var text = createElement( 'div', id + 'Text', 'font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px;color:' + fg );
		text.innerHTML = id.toUpperCase();
		div.appendChild( text );

		var graph = createElement( 'div', id + 'Graph', 'width:94px;height:30px;background:' + fg );
		div.appendChild( graph );

		for ( var i = 0; i < 94; i ++ ) {

			graph.appendChild( createElement( 'span', '', 'width:1px;height:30px;float:left;opacity:0.9;background:' + bg ) );

		}

		return div;

	}

	function setMode( value ) {

		var children = container.children;

		for ( var i = 0; i < children.length; i ++ ) {

			children[ i ].style.display = i === value ? 'block' : 'none';

		}

		mode = value;

	}

	function updateGraph( dom, value ) {

		var child = dom.appendChild( dom.firstChild );
		child.style.height = Math.min( 30, 30 - value * 30 ) + 'px';

	}

	//

	var container = createElement( 'div', 'statsGPU', 'width:100px;opacity:0.9;cursor:pointer' );
	container.addEventListener( 'mousedown', function ( event ) {

		event.preventDefault();
		setMode( ++ mode % container.children.length );

	}, false );

	// FPS

	var fps = 0, fpsMin = Infinity, fpsMax = 0;

	var fpsDiv = createPanel( 'fps', '#0ff', '#002' );
	var fpsText = fpsDiv.children[ 0 ];
	var fpsGraph = fpsDiv.children[ 1 ];

	container.appendChild( fpsDiv );

	// MS

	var ms = 0, msMin = Infinity, msMax = 0;

	var msDiv = createPanel( 'ms', '#0f0', '#020' );
	var msText = msDiv.children[ 0 ];
	var msGraph = msDiv.children[ 1 ];

	container.appendChild( msDiv );

	// MEM

	if ( self.performance && self.performance.memory ) {

		var mem = 0, memMin = Infinity, memMax = 0;

		var memDiv = createPanel( 'mb', '#f08', '#201' );
		var memText = memDiv.children[ 0 ];
		var memGraph = memDiv.children[ 1 ];

		container.appendChild( memDiv );

	}

	//

	setMode( mode );

	return {

		REVISION: 14,

		domElement: container,

		setMode: setMode,

		begin: function () {

			startTime = now();

		},

		end: function () {

			var time = now();

			ms = time - startTime;
			msMin = Math.min( msMin, ms );
			msMax = Math.max( msMax, ms );

			msText.textContent = ( ms | 0 ) + ' MS (' + ( msMin | 0 ) + '-' + ( msMax | 0 ) + ')';
			updateGraph( msGraph, ms / 200 );

			frames ++;

			if ( time > prevTime + 1000 ) {

				fps = Math.round( ( frames * 1000 ) / ( time - prevTime ) );
				fpsMin = Math.min( fpsMin, fps );
				fpsMax = Math.max( fpsMax, fps );

				fpsText.textContent = fps + ' FPS (' + fpsMin + '-' + fpsMax + ')';
				updateGraph( fpsGraph, fps / 100 );

				prevTime = time;
				frames = 0;

				if ( mem !== undefined ) {

					var heapSize = performance.memory.usedJSHeapSize;
					var heapSizeLimit = performance.memory.jsHeapSizeLimit;

					mem = Math.round( heapSize * 0.000000954 );
					memMin = Math.min( memMin, mem );
					memMax = Math.max( memMax, mem );

					memText.textContent = mem + ' MB (' + memMin + '-' + memMax + ')';
					updateGraph( memGraph, heapSize / heapSizeLimit );

				}

			}

			return time;

		},

		update: function () {

			startTime = this.end();

		}

	};

};

if ( typeof module === 'object' ) {

	module.exports = StatsGPU;

}
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) class
	var MonitorGPU = THREEAPP.Class.create('MonitorGPU', null, ['Plugin'])

	.ready(function (app) {

		// optional GPU monitor
		var monitor = new StatsGPU();
		app.viewport.appendChild(monitor.domElement);
		app.listen('preframe', function () { monitor.begin(); });
		app.listen('postframe', function () { monitor.end(); });

	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.MonitorGPU', MonitorGPU);

// EO private scope
})(THREE, THREEAPP);
;
/**
https://github.com/alexei/sprintf.js

Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
    * Neither the name of sprintf() for JavaScript nor the
      names of its contributors may be used to endorse or promote products
      derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL Alexandru Marasteanu BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

**/

(function(window) {
    var re = {
        not_string: /[^s]/,
        not_bool: /[^t]/,
        not_type: /[^T]/,
        not_primitive: /[^v]/,
        number: /[diefg]/,
        numeric_arg: /bcdiefguxXS/,
        json: /[j]/,
        not_json: /[^j]/,
        text: /^[^\x25]+/,
        modulo: /^\x25{2}/,
        placeholder: /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxXSDR])/,
        key: /^([a-z_][a-z_\d]*)/i,
        key_access: /^\.([a-z_][a-z_\d]*)/i,
        index_access: /^\[(\d+)\]/,
        sign: /^[\+\-]/
    }

    function readableSize(bytes, si) {
      var thresh = si ? 1000 : 1024;
      if(Math.abs(bytes) < thresh) {
        return bytes + ' B';
      }
      var units = si
        ? ['kB','MB','GB','TB','PB','EB','ZB','YB']
        : ['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];
      var u = -1;
      do {
        bytes /= thresh;
        ++u;
      } while(Math.abs(bytes) >= thresh && u < units.length - 1);
      return bytes.toFixed(1) + units[u];
    }

    function sprintf() {
        var key = arguments[0], cache = sprintf.cache
        if (!(cache[key] && cache.hasOwnProperty(key))) {
            cache[key] = sprintf.parse(key)
        }
        return sprintf.format.call(null, cache[key], arguments)
    }

    sprintf.format = function(parse_tree, argv) {
        var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length, is_positive = true, sign = ''
        for (i = 0; i < tree_length; i++) {
            node_type = get_type(parse_tree[i])
            if (node_type === 'string') {
                output[output.length] = parse_tree[i]
            }
            else if (node_type === 'array') {
                match = parse_tree[i] // convenience purposes only
                if (match[2]) { // keyword argument
                    arg = argv[cursor]
                    for (k = 0; k < match[2].length; k++) {
                        if (!arg.hasOwnProperty(match[2][k])) {
                            throw new Error(sprintf('[sprintf] property "%s" does not exist', match[2][k]))
                        }
                        arg = arg[match[2][k]]
                    }
                }
                else if (match[1]) { // positional argument (explicit)
                    arg = argv[match[1]]
                }
                else { // positional argument (implicit)
                    arg = argv[cursor++]
                }

                if (re.not_type.test(match[8]) && re.not_primitive.test(match[8]) && get_type(arg) == 'function') {
                    arg = arg()
                }

                if (re.numeric_arg.test(match[8]) && (get_type(arg) != 'number' && isNaN(arg))) {
                    throw new TypeError(sprintf("[sprintf] expecting number but found %s", get_type(arg)))
                }

                if (re.number.test(match[8])) {
                    is_positive = arg >= 0
                }

                switch (match[8]) {
                    case 'b':
                        arg = parseInt(arg, 10).toString(2)
                    break
                    case 'c':
                        arg = String.fromCharCode(parseInt(arg, 10))
                    break
                    case 'd':
                    case 'i':
                        arg = parseInt(arg, 10)
                    break
                    case 'j':
                        arg = JSON.stringify(arg, null, match[6] ? parseInt(match[6]) : 0)
                    break
                    case 'e':
                        arg = match[7] ? parseFloat(arg).toExponential(match[7]) : parseFloat(arg).toExponential()
                    break
                    case 'f':
                        arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg)
                    break
                    case 'g':
                        arg = match[7] ? parseFloat(arg).toPrecision(match[7]) : parseFloat(arg)
                    break
                    case 'o':
                        arg = arg.toString(8)
                    break
                    case 's':
                        arg = String(arg)
                        arg = (match[7] ? arg.substring(0, match[7]) : arg)
                    break
                    case 't':
                        arg = String(!!arg)
                        arg = (match[7] ? arg.substring(0, match[7]) : arg)
                    break
                    case 'S':
                        arg = readableSize(arg)
                    break
                    case 'R':
                        var degs = arg / Math.PI * 180;
                        var mins = (degs % 1) * 60;
                        var secs = (mins % 1) * 60;
                        arg = sprintf("%02d° %02d' %0.2f\"", degs, mins, secs);
                    break;
                    case 'D':
                        arg += Math.PI;
                        var hours = arg / Math.PI * 12;
                        var mins = (hours % 1) * 60;
                        var secs = (mins % 1) * 60;
                        arg = sprintf("%02dh %02dm %0.2fs", hours, mins, secs);
                    break;
                    case 'T':
                        arg = get_type(arg)
                        arg = (match[7] ? arg.substring(0, match[7]) : arg)
                    break
                    case 'u':
                        arg = parseInt(arg, 10) >>> 0
                    break
                    case 'v':
                        arg = arg.valueOf()
                        arg = (match[7] ? arg.substring(0, match[7]) : arg)
                    break
                    case 'x':
                        arg = parseInt(arg, 10).toString(16)
                    break
                    case 'X':
                        arg = parseInt(arg, 10).toString(16).toUpperCase()
                    break
                }
                if (re.json.test(match[8])) {
                    output[output.length] = arg
                }
                else {
                    if (re.number.test(match[8]) && (!is_positive || match[3])) {
                        sign = is_positive ? '+' : '-'
                        arg = arg.toString().replace(re.sign, '')
                    }
                    else {
                        sign = ''
                    }
                    pad_character = match[4] ? match[4] === '0' ? '0' : match[4].charAt(1) : ' '
                    pad_length = match[6] - (sign + arg).length
                    pad = match[6] ? (pad_length > 0 ? str_repeat(pad_character, pad_length) : '') : ''
                    output[output.length] = match[5] ? sign + arg + pad : (pad_character === '0' ? sign + pad + arg : pad + sign + arg)
                }
            }
        }
        return output.join('')
    }

    sprintf.cache = {}

    sprintf.parse = function(fmt) {
        var _fmt = fmt, match = [], parse_tree = [], arg_names = 0
        while (_fmt) {
            if ((match = re.text.exec(_fmt)) !== null) {
                parse_tree[parse_tree.length] = match[0]
            }
            else if ((match = re.modulo.exec(_fmt)) !== null) {
                parse_tree[parse_tree.length] = '%'
            }
            else if ((match = re.placeholder.exec(_fmt)) !== null) {
                if (match[2]) {
                    arg_names |= 1
                    var field_list = [], replacement_field = match[2], field_match = []
                    if ((field_match = re.key.exec(replacement_field)) !== null) {
                        field_list[field_list.length] = field_match[1]
                        while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {
                            if ((field_match = re.key_access.exec(replacement_field)) !== null) {
                                field_list[field_list.length] = field_match[1]
                            }
                            else if ((field_match = re.index_access.exec(replacement_field)) !== null) {
                                field_list[field_list.length] = field_match[1]
                            }
                            else {
                                throw new SyntaxError("[sprintf] failed to parse named argument key")
                            }
                        }
                    }
                    else {
                        throw new SyntaxError("[sprintf] failed to parse named argument key")
                    }
                    match[2] = field_list
                }
                else {
                    arg_names |= 2
                }
                if (arg_names === 3) {
                    throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")
                }
                parse_tree[parse_tree.length] = match
            }
            else {
                throw new SyntaxError("[sprintf] unexpected placeholder")
            }
            _fmt = _fmt.substring(match[0].length)
        }
        return parse_tree
    }

    var vsprintf = function(fmt, argv, _argv) {
        _argv = (argv || []).slice(0)
        _argv.splice(0, 0, fmt)
        return sprintf.apply(null, _argv)
    }

    /**
     * helpers
     */
    function get_type(variable) {
        if (typeof variable === 'number') {
            return 'number'
        }
        else if (typeof variable === 'string') {
            return 'string'
        }
        else {
            return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase()
        }
    }

    var preformattedPadding = {
        '0': ['', '0', '00', '000', '0000', '00000', '000000', '0000000'],
        ' ': ['', ' ', '  ', '   ', '    ', '     ', '      ', '       '],
        '_': ['', '_', '__', '___', '____', '_____', '______', '_______'],
    }
    function str_repeat(input, multiplier) {
        if (multiplier >= 0 && multiplier <= 7 && preformattedPadding[input]) {
            return preformattedPadding[input][multiplier]
        }
        return Array(multiplier + 1).join(input)
    }

    /**
     * export to either browser or node.js
     */
    if (typeof exports !== 'undefined') {
        exports.sprintf = sprintf
        exports.vsprintf = vsprintf
    }
    else {
        window.sprintf = sprintf
        window.vsprintf = vsprintf

        if (typeof define === 'function' && define.amd) {
            define(function() {
                return {
                    sprintf: sprintf,
                    vsprintf: vsprintf
                }
            })
        }
    }
})(typeof window === 'undefined' ? this : window);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (module, THREE, THREEAPP)
{
	"use strict";

	// ToDo: implement fallback?
	var defer = requestAnimationFrame;

	// uncomment if you want to test max framerate
	// defer = function () { setTimeout(arguments[0], 0); }

	var ThreeApp = THREEAPP.Class.create('ThreeApp', null, ['Events', 'Options'])

	.defaults({
		root: '.'
	})

	.ctor(function ctor(vp, options) {

		// scope for closures
		var app = this;
		// count frames
		app.frames = 9999;
		// application viewport
		app.viewport = vp;
		// split relative root path
		var root = this.options.root;
		this.root = root.split(/\/+/);
		// extend instance options
		THREEAPP.extend(this.options, options);
		// query extended options
		options = this.options;

	})

	.init(function init(app, options) {

		// scope for closures
		var app = this;
		// query extended options
		var options = this.options;
		// instantiate all 3rd party plugins
		// create plan to resolve all plugins
		var plugins = this.options.plugins || [];
		var unsatisfied = [].concat(plugins); // clone array
		// loop until finished or failing
		var stop = false; var n = 0;
		while (n < unsatisfied.length) {
			// skip the ones that are not satisfied yet
			var required = unsatisfied[n].prototype.required;
			if (required && required.length) { ++ n; continue; }
			// this plugin has been satisfied
			var plugin = unsatisfied.splice(n, 1)[0];
			// check if it provides any services
			if (plugin.prototype.provided) {
				var provided = plugin.prototype.provided;
				for (var i = 0; i < unsatisfied.length; i++) {
					for (var service in provided) {
						var requires = unsatisfied[i].prototype.required;
						var idx = (requires || []).indexOf(service);
						if (idx == -1) continue;
						requires.splice(idx, 1);
					}
				}
				// restart lookup
				n = 0;
			}
			// get the plugin name
			var name = plugin.name;
			// call plugin constructor
			var opts = options[name];
			plugins[i] = new plugin(this, opts);
			// ToDo: check why wait is gone?
			// still seems to work correctly
			if (!app.wait) continue;
			// wait for plugin
			app.wait(plugins[i]);
		}

		// this should be empty now
		if (unsatisfied.length) {
			// list all unsatisfied plugins
			for (var i = 0; i < unsatisfied.length; i++) {
				var name = unsatisfied[i].name;
				var requires = unsatisfied[i].prototype.required;
				console.warn(name, "is missing", requires);
			}
			// error out hard (should never happen in prod)
			throw Error("Missing or circular dependencies");
		}

		// store on main object
		app.plugins = plugins;

	})

	.ready(function ready()
	{
		// scope for closures
		var app = this;
		// start app right away?
		if (this.options.start) {
			// use a timeout just in case
			window.setTimeout(function () {
				app.start(); // start app
			}, 0)
		}
	})

	// start the rendering loop
	.method('start', function start()
	{
		// scope for closures
		var app = this;
		// check if already runing
		if (app.started) return;
		// return if paused?
		if (app.paused) return;
		// start rendering
		defer( function () {
			app.render.call(app);
		});
		// set started flag
		app.started = true;
	})
	// EO method start

	// resize the app dimensions
	.method('resize', function resize(width, height) {
		// local var access
		var app = this;
		// set app dimensions
		app.width = width;
		app.height = height;
		// invoke resized event
		app.invoke('resized');
	})
	// EO method resize

	// implement some logger methods
	// pass through sprintf to console
	.method('log', function log() {
		console.log(sprintf.apply(this, arguments));
	})
	.method('warn', function warn() {
		console.warn(sprintf.apply(this, arguments));
	})
	.method('info', function info() {
		console.info(sprintf.apply(this, arguments));
	})

	// resolve to correct relative path
	.method('path', function path(path) {
		var parts = path.split(/\/+/);
		return this.root.concat(parts).join('/');
	})

	.method('render', function render() {
		// local var access
		var app = this;
		// invoke pre-render event
		app.invoke('preframe');
		// invoke render event
		app.invoke('render');
		// invoke post-render event
		app.invoke('postframe');
		// enqueue next frame
		if (app.started) {
			defer( function defered() {
				app.render.call(app);
			});
		}
		// count frames
		++ app.frames;
	})

	;

	// assign class to global namespace
	THREEAPP('App', ThreeApp);

// EO private scope
})(self, THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
	https://github.com/mgreter/js-lzma
	https://github.com/jcmellado/js-lzma
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var LZMA = THREEAPP.Class.create('LZMA', null, ['Plugin'])

	.proto('provides', 'lzma')

	.ctor(function (app) {
		// simply create one manager
		// hardcoded to three workers ATM
		app.wlzma = new WLZMA.Manager(3);
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.LZMA', LZMA);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Tween = THREEAPP.Class.create('Tween', null, ['Plugin'])

	.proto('provides', 'tween')

	.ready(function (app)
	{
		app.listen('preframe', function ()
		{
			TWEEN.update();
		})
	})

	// assign class to global namespace
	THREEAPP('Plugin.Tween', Tween);

// EO private scope
})(THREE, THREEAPP);

;
(function(THREE, THREEAPP) {

	function CPUs(path, cb)
	{

		// static vars
		var record = 0;
		var records = 0;

		// ensure ending slash
		path = path.replace(/[/]*$/, '/');
		// create load path for the worker
		var workersrc = path + "Worker.js";

		// called to check how much work a
		// specific nr of workers can complete
		function test (cpus, cb)
		{
			var workers = [];
			var complete = 0;
			var result = 0;
			// keep the main thread busy too
			var iv = setInterval(function()
			{
				// measure a mix of math functions
				for (var i = 0; i < 100; i++) {
					var x = Math.cos(Math.exp(Math.PI)) / Math.atan2(Math.PI, 0);
					var y = Math.sqrt(Math.pow(x, Math.exp(Math.abs(x)))) / Math.PI;
					var z = Math.sin(y * x % Math.PI) + Math.tan(x / y % Math.PI);
				}
				// result ++;
			}, 0);
			// fork given amount of workers
			for (var i = 0; i < cpus; i ++)
			{
				// load and create a new webworker
				workers[i] = new Worker(workersrc);
				// listen for the final work count
				workers[i].onmessage = function(e)
				{
					result += e.data;
					if (++ complete == cpus) {
						if (iv) clearInterval(iv);
						cb.call(this, result);
					}
				}
			}
			// start them all at once
			for (var i = 0; i < cpus; i ++)
			{
				workers[i].postMessage("start");
			}
		}

		// incrementally check more cpus
		// keep track of the best options
		function check (cpus, cb)
		{
			// test the given config
			test(cpus, function (count) {
				// last config was better?
				if (records > count) {
					return cb.call(this, record);
				};
				// do not test further?
				if (cpus > 12) {
		console.info('CPUs', cpus)
					return cb.call(this, cpus);
				}
				// remember config
				record = cpus;
				records = count;
				// check next config
				check(cpus * 2, cb);
			});
		}

		// start with one worker
		check(1, cb);

	};

	THREEAPP('CPUs', CPUs);

})(THREE, THREEAPP);
;
// expects only one msg!
onmessage = function(e)
{
	var count = 0;
	var run = true;
	// start cpu assesement
	// if (e.data == "start");
	var start = Date.now();
	while (start + 80 > Date.now()) {
		for (var i = 0; i < 200; i++) {
			var x = Math.cos(Math.exp(Math.PI)) / Math.atan2(Math.PI, 0);
			var y = Math.sqrt(Math.pow(x, Math.exp(Math.abs(x)))) / Math.PI;
			var z = Math.sin(y * x % Math.PI) + Math.tan(x / y % Math.PI);
		}
		count ++; // increment counter to measure relative cpu speed
	}
	// report back
	postMessage(count);
	// exit worker
	close();
};
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) mixin
	var Group = THREEAPP.Class.mixin(['Events', 'Options'])

	// constructor
	.ctor(function(app, options) {
		// start empty
		this.items = [];
		this.length = 0;
	})

	// default settings
	.defaults({
		softLimit: 8,
		hardLimit: 2000,
		increment: 2,
	})

	.method('belowSoftLimit', function (obj) {
		return this.items.length < this.options.softLimit;
	})
	.method('belowHardLimit', function (obj) {
		return this.items.length < this.options.hardLimit;
	})

	// you may want to overload this
	// ToDo: maybe add hooks instead
	.method('delete', function (obj) {
		// convert object to index
		if (isNaN(obj)) { obj = this.items.indexOf(obj); }
		if (obj < 0 || obj > this.items.length) {
			throw "cannot remove unknown group item"
		}
		// keep reference for now
		var item = this.items[obj];
		// splice the item away
		this.items.splice(obj, 1);
		// decrease size
		this.length -= 1;
		// trigger deferred
		this.trigger('decrease');
		// trigger single event
		this.invoke('deleted', item);
		// trigger generic hock
		this.trigger('resized');
	})

	// you may want to overload this
	// ToDo: maybe add hooks instead
	.method('insert', function (obj) {

		// maybe space is available
		if (this.belowSoftLimit()) {
			// add object to items
			this.items.push(obj);
			// increment size
			this.length += 1;
			// trigger deferred
			this.trigger('increase');
		}
		else if (this.belowHardLimit()) {
			// add object to items
			this.items.push(obj);
			// adjust the softlimit by increasing until hard limit
			this.options.softLimit *= this.options.increment || 2;
			if (this.options.softLimit > this.options.hardLimit) {
				this.options.softLimit = this.options.hardLimit;
			}
			// increment size
			this.length += 1;
			// call synchronous
			// mark buffer stale
			this.invoke('resize');
		}
		// or we reached a hard limit
		else {
			// check hard limit before calling add ...
			throw Error("group reached hard limit");
		}
		// trigger single event
		this.invoke('inserted', obj);
		// trigger generic hock
		this.trigger('resized');
	})

	// end
	;

	// assign global namespace
	THREEAPP('Group', Group)

})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) mixin
	var Grouped = THREEAPP.Class.create('Grouped', null, ['Events', 'Options'])

	// constructor
	.ctor(function(app, options) {
		// start empty
		this.length = 0;
		this.groups = [];
		this.current = null;
		this.compacting = false;
	})

	// default settings
	.defaults({
		softLimit: 3,
		hardLimit: 2000,
		increment: 8,
		compact: 0.75
	})

	// add object to a free group
	.method('add', function (obj) {
		var self = this;
		// increase count
		self.length += 1;
		// check active group
		if (self.current) {
			// append to active group until full
			if (self.current.belowHardLimit()) {
				self.current.insert(obj);
				return self;
			}
			// check if any other group has space now
			for (var i = 0; i < self.groups.length; i++) {
				if (self.groups[i].belowHardLimit()) {
					self.current = self.groups[i];
					self.current.insert(obj);
					return self;
				}
			}
		}
		// or create a new group instance
		self.current = new self.options.ctor(
			self.app, self.options // re-use opts
		);
		// store new group on ourself
		self.groups.push(self.current);
		// add object to the group
		self.current.insert(obj);
		// Decouple tasker from group
		self.current.trigger('enable');
		// chainable
		return self;
	})

	// you may want to overload this
	// ToDo: maybe add hooks instead
	.method('delete', function (obj) {
		// search in groups
		// index is fastest
		var n = 0, idx = -1;
		if (isNaN(obj)) {
			// find group containing given object
			for (var n = 0; n < this.groups.length; n ++) {
				if ((idx = this.groups[n].indexOf(obj)) > -1) break;
			}
			// use index
			obj = idx;
		}
		// resolve index
		else {
			// print warning on console
			if (obj < 0 || obj >= this.length) {
				console.warn('access out of bound');
			}
			// find group and local offset
			while (n < this.groups.length) {
				if (obj < this.groups[n].length) break;
				obj -= this.groups[n].length; n += 1;
			}
		}
		// do nothing if index is out of bound
		if (n == this.groups.length) return
		// delegate to group
		this.groups[n].delete(obj);
		// check if group is empty now
		if (this.groups[n].length == 0) {
			// mark the group as been removed
			this.groups[n].removed = true;
			// Decouple tasker from group
			this.groups[n].trigger('disable');
			// remove group completely
			this.groups.splice(n, 1);
		}
		// decrease counter
		this.length -= 1;

		// abort if already running
		if (this.compacting) return;
		// auto compact multiple groups if not yet started
		if (this.options.compact && this.groups.length > 2) {
			// calculate ratio of average items per groups
			var ratio = this.length / this.options.hardLimit;
			var minima = this.groups.length * this.options.compact;
			// start compact if average is below a certain ratio
			if (ratio < minima) this.compact(75);
		}
	})

	// merge groups to reduce needed groups
	.method('compact', function (speed, n) {
		// timeout closure
		var self = this;
		// offset is optional
		if (isNaN(n)) n = 0;
		// flag to run only once
		this.compacting = true;
		// process all groups
		while (n < this.groups.length) {
			// look for a group to fill up
			if (this.groups[n].belowHardLimit()) {
				// move items until group is full
				while (this.groups[n].belowHardLimit()) {
					var L = this.groups.length - 1;
					var idx = this.groups[L].length - 1;
					var item = this.groups[L].items[idx];
					if (idx == -1 || L == n) break;
					// swap object group
					this.groups[L].delete(idx);
					this.groups[n].insert(item);
					// check if old group now empty
					if (this.groups[L].length == 0) {
						// mark the group as been removed
						this.groups[L].removed = true;
						// Decouple tasker from group
						this.groups[L].trigger('disable');
						// remove group completely
						this.groups.splice(L, 1);
					}
				}
				// schedule next group
				if (!isNaN(speed)) {
					setTimeout(function () {
						self.compact(speed, n);
					}, speed);
				}
				// abort for now
				break;
			}
			// skip full group
			n += 1;
		}
		// we are done for now
		this.compacting = false;
	})

	// end
	;

	// assign global namespace
	THREEAPP('Grouped', Grouped)

})(THREE, THREEAPP);
;
	/*
	Add license text here
	Copyright 2016 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Tasker = THREEAPP.Class.create('Tasker', null, ['Plugin'])

	.proto('provides', 'tasker')

	// object constructor
	.ctor(function (app, options) {

		// just create and attach tasker instance
		app.tasker = new THREEAPP.Tasker(app, options);

	})
	// EO ctor

	.init(function (app) {
		this.wait(app.tasker);
	})

	// EO Class
	;

	// assign class to global namespace
	THREEAPP('Plugin.Tasker', Tasker);

// EO private scope
})(THREE, THREEAPP);
;
	/*
	Add license text here
	Copyright 2016 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Scheduler = THREEAPP.Class.create('Scheduler', null, ['Plugin'])

	.proto('provides', 'scheduler')
	
	// object constructor
	.ctor(function ctor(app) {

		// just create and attach tasker instance
		app.scheduler = new THREEAPP.Scheduler(app);

	})
	// EO ctor

	// attach listeners
	.init(function init(app) {
		// create handler function
		function postframe() {
			app.scheduler.frame();
		}
		// re-schedule completed bands
		app.listen('postframe', postframe)
	})
	// EO init

	// EO Class
	;

	// assign class to global namespace
	THREEAPP('Plugin.Scheduler', Scheduler);

// EO private scope
})(THREE, THREEAPP);
;
// https://github.com/jakesgordon/bin-packing/blob/master/js/packer.growing.js
/******************************************************************************

This is a binary tree based bin packing algorithm that is more complex than
the simple Packer (packer.js). Instead of starting off with a fixed width and
height, it starts with the width and height of the first block passed and then
grows as necessary to accomodate each subsequent block. As it grows it attempts
to maintain a roughly square ratio by making 'smart' choices about whether to
grow right or down.

When growing, the algorithm can only grow to the right OR down. Therefore, if
the new block is BOTH wider and taller than the current target then it will be
rejected. This makes it very important to initialize with a sensible starting
width and height. If you are providing sorted input (largest first) then this
will not be an issue.

A potential way to solve this limitation would be to allow growth in BOTH
directions at once, but this requires maintaining a more complex tree
with 3 children (down, right and center) and that complexity can be avoided
by simply chosing a sensible starting block.

Best results occur when the input blocks are sorted by height, or even better
when sorted by max(width,height).

Inputs:
------

  blocks: array of any objects that have .w and .h attributes

Outputs:
-------

  marks each block that fits with a .fit attribute pointing to a
  node with .x and .y coordinates

Example:
-------

  var blocks = [
    { w: 100, h: 100 },
    { w: 100, h: 100 },
    { w:  80, h:  80 },
    { w:  80, h:  80 },
    etc
    etc
  ];

  var packer = new GrowingPacker();
  packer.fit(blocks);

  for(var n = 0 ; n < blocks.length ; n++) {
    var block = blocks[n];
    if (block.fit) {
      Draw(block.fit.x, block.fit.y, block.w, block.h);
    }
  }


******************************************************************************/

GrowingPacker = function() { };

GrowingPacker.prototype = {

  fit: function(blocks) {
    var n, node, block, len = blocks.length;
    var w = len > 0 ? blocks[0].w : 0;
    var h = len > 0 ? blocks[0].h : 0;
    this.root = { x: 0, y: 0, w: w, h: h };
    for (n = 0; n < len ; n++) {
      block = blocks[n];
      if (node = this.findNode(this.root, block.w, block.h))
        block.fit = this.splitNode(node, block.w, block.h);
      else
        block.fit = this.growNode(block.w, block.h);
    }
  },

  findNode: function(root, w, h) {
    if (root.used)
      return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);
    else if ((w <= root.w) && (h <= root.h))
      return root;
    else
      return null;
  },

  splitNode: function(node, w, h) {
    node.used = true;
    node.down  = { x: node.x,     y: node.y + h, w: node.w,     h: node.h - h };
    node.right = { x: node.x + w, y: node.y,     w: node.w - w, h: h          };
    return node;
  },

  growNode: function(w, h) {
    var canGrowDown  = (w <= this.root.w);
    var canGrowRight = (h <= this.root.h);

    var shouldGrowRight = canGrowRight && (this.root.h >= (this.root.w + w)); // attempt to keep square-ish by growing right when height is much greater than width
    var shouldGrowDown  = canGrowDown  && (this.root.w >= (this.root.h + h)); // attempt to keep square-ish by growing down  when width  is much greater than height

    if (shouldGrowRight)
      return this.growRight(w, h);
    else if (shouldGrowDown)
      return this.growDown(w, h);
    else if (canGrowRight)
     return this.growRight(w, h);
    else if (canGrowDown)
      return this.growDown(w, h);
    else
      return null; // need to ensure sensible root starting size to avoid this happening
  },

  growRight: function(w, h) {
    this.root = {
      used: true,
      x: 0,
      y: 0,
      w: this.root.w + w,
      h: this.root.h,
      down: this.root,
      right: { x: this.root.w, y: 0, w: w, h: this.root.h }
    };
    if (node = this.findNode(this.root, w, h))
      return this.splitNode(node, w, h);
    else
      return null;
  },

  growDown: function(w, h) {
    this.root = {
      used: true,
      x: 0,
      y: 0,
      w: this.root.w,
      h: this.root.h + h,
      down:  { x: 0, y: this.root.h, w: this.root.w, h: h },
      right: this.root
    };
    if (node = this.findNode(this.root, w, h))
      return this.splitNode(node, w, h);
    else
      return null;
  }

}


;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var margin = 2;

	var packer = new GrowingPacker();

	function setupDraw(label)
	{
		var ctx = this.context;
		var opt = this.options;
		ctx.font = opt.fontSize + "px "
			+ opt.fontFamily;
		ctx.fillStyle = label.color || opt.fillStyle;
		ctx.strokeStyle = label.stroke || opt.strokeStyle;
		ctx.lineWidth = label.lineWidth || opt.lineWidth;
	}

	function drawBg(label)
	{
		var fit = label.fit;
		var x = fit.x + margin;
		var y = fit.y + label.h;
		y = y - margin - 1;
		var ctx = this.context;
		if (label.background) {
			ctx.fillStyle = label.background;
			ctx.fillRect(fit.x, fit.y, label.w, label.h);
		}
		if (label.border) {
			ctx.strokeStyle = label.border;
			ctx.rect(fit.x, fit.y, label.w, label.h);
			ctx.stroke();
		}
	}

	function drawText(label)
	{
		var fit = label.fit;
		var x = fit.x + margin;
		var y = fit.y + label.h;
		y = y - margin - 2
		var ctx = this.context;
		var opt = this.options;
		if (label.stroke || opt.strokeStyle) {
			ctx.strokeText(label.txt, x, y);
		}
		if (label.color || opt.fillStyle) {
			ctx.fillText(label.txt, x, y);
		}
	}

	// return power of 2
	function pow2(v)
	{
		v--;
		v |= v >> 1;
		v |= v >> 2;
		v |= v >> 4;
		v |= v >> 8;
		v |= v >> 16;
		v++;
		return v;
	}

	// create a new (augmented) class
	var Labels = THREEAPP.Class.create('Labels', null, ['Group'])

	.defaults({
		hardLimit: 8192,
		fontSize: 10, // only px
		fontFamily: 'Tahoma, sans',
		// fillStyle: '#F0F0F0',
		strokeStyle: '#0F0F0F',
		lineWidth: 1.0
	})

	// constructor
	.ctor(function ctor(app)
	{
		this.canvas = document.createElement('canvas');
		this.context = this.canvas.getContext("2d");
		app.viewport.appendChild(this.canvas);
		this.canvas.style.position = "absolute";
		this.canvas.style.display = "none";
		this.canvas.style.left = "0px";
		this.canvas.style.top = "0px";
	})

	.listen('resized', function resized() {
		// sort items by their size
		this.items.sort(function (a, b) {
			return Math.max(b.w, b.h) - Math.max(a.w, a.h);
		});
		// remove previous fitting information
		for (var i = 0; i < this.length; i += 1) {
			delete this.items[i].fit;
		};
		// distribute in 2d texture
		packer.fit(this.items);
		var root = packer.root;
		var canvas = this.canvas;
		var context = this.context;
		var width = canvas.width = pow2(root.w);
		var height = canvas.height = pow2(root.h);
		// re-draw the texture immediately
		// maybe we need to resize it too
		context.clearRect(0, 0, canvas.width, canvas.height);

		// call the drawer for each item
		for (var i = 0; i < this.length; i += 1) {
			drawBg.call(this, this.items[i]);
			setupDraw.call(this, this.items[i]);
			drawText.call(this, this.items[i]);
		}
	})

	.listen('inserted', function inserted(obj) {
		var ctx = this.context, options = this.options;
		setupDraw.call(this, obj); // for measure text!
		obj.h = margin + options.fontSize + margin;
		var size = ctx.measureText(obj.txt);
		obj.w = margin + size.width + margin;
	})
	
	;

	// assign class to global namespace
	THREEAPP('Labels', Labels);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var Labels = THREEAPP.Class.create('Labels', null, ['Plugin'])

	.proto('provides', 'labels')

	.ctor(function (app) {
		// simply create one manager
		app.labels = new THREEAPP.Labels(app);
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.Labels', Labels);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var margin = 2;

	var Labels = THREEAPP.Class.create('Labels', THREE.Points, ['Resources', 'Labels'])

	// default options
	.defaults({
		color: 0xFF0000,
	})

	// called on object construction
	.ctor(function (app) {
		this.prefetch({
			'glsl_vert': ['S', app.path('shaders/labels.vert')],
			'glsl_frag': ['S', app.path('shaders/labels.frag')]
		})
	})

	// called when texture is loaded
	.ready(function () {

		var labels = this;
		var canvas = labels.canvas;
		var options = labels.options;
		// allocate enough to hold all
		var alloc = options.hardLimit;

		// create an instanced buffer geometry with one vertice
		// this is actually the point to be rendered and shaded
		// we don't seem to be able to use offsets directly!?
		var geometry = new THREE.InstancedBufferGeometry();

		// create position offsets for instances
		var offsets = new Float32Array(3*alloc);
		// special uvs array to map labels
		var uvs = new Float32Array(4*alloc);

		// setup main position (shared for instances) and the offsets (custom for instances)
		geometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array(3), 3 ) );
		geometry.addAttribute( 'offset', new THREE.InstancedBufferAttribute( offsets, 3, 1 ) );
		geometry.addAttribute( 'uvs', new THREE.InstancedBufferAttribute( uvs, 4, 1 ) );

		labels.texture = new THREE.Texture( labels.canvas );

		// create custom minimal raw shader material
		var material = new THREE.RawShaderMaterial({
			uniforms: {
				map: { type: 't', value: labels.texture },
				appWidth: { type: 'f', value: app.width },
				appHeight: { type: 'f', value: app.height },
				texWidth: { type: 'f', value: canvas.width },
				texHeight: { type: 'f', value: canvas.height }
			},
			blending: THREE.AdditiveBlending,
			vertexShader: labels.asset('glsl_vert'),
			fragmentShader: labels.asset('glsl_frag'),
			transparent: true,
			depthTest: false
		});

		// call three.js base constructor function
		THREE.Points.call(labels, geometry, material);

		// add ourself to parent if given by options
		if (options.parent) options.parent.add(labels);

		// reset draw count (set on resize)
		geometry.maxInstancedCount = labels.items.length;

		// needed to show texture initially?
		labels.texture.needsUpdate = true;

		// update label positions before rendering
		labels.app.listen('preframe', function() {
			geometry.attributes.offset.needsUpdate = true;
			for (var i = 0; i < labels.items.length; i++) {
				var label = labels.items[i];
				if (!label.position) continue;
				offsets[i*3+0] = label.position.x;
				offsets[i*3+1] = label.position.y;
				offsets[i*3+2] = label.position.z;
			}
		})

		// update label positions before rendering
		labels.app.listen('resized', function() {
			labels.material.uniforms.appWidth.value = labels.app.width;
			labels.material.uniforms.appHeight.value = labels.app.height;
		});

	})

	.listen('resized', function ()
	{
		if (this.geometry && this.items) {
			var texWidth = this.canvas.width;
			var texHeight = this.canvas.height;
			var offsets = this.geometry.attributes.offset.array;
			var uvs = this.geometry.attributes.uvs.array;
			for (var i = 0; i < this.items.length; i++) {
				var item = this.items[i];
				uvs[i*4+0] = item.fit.x + margin;
				uvs[i*4+1] = item.fit.y + margin;
				uvs[i*4+2] = item.w - margin * 1;
				uvs[i*4+3] = item.h - margin * 1;
			}
			if (this.texture) this.texture.needsUpdate = true;
			this.geometry.attributes.offset.needsUpdate = true;
			this.geometry.attributes.uvs.needsUpdate = true;
			this.material.uniforms.texWidth.value = texWidth;
			this.material.uniforms.texHeight.value = texHeight;
			this.geometry.maxInstancedCount = this.items.length;
		}
	})

	;

	// assign class to global namespace
	THREEAPP('Objects.Labels', Labels);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// since we have to work with very raw data here
// the tasker is very sensitive to invalid data
// not sure how to harden this without giving up
// too much performance. Works for me for now ...

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// seen base classes
	var classid = 0;

	// Execute a task on a worker
	function work (worker, task)
	{
		var tasker = this;
		// fetch fresh buffers
		var buffers = task.buffers();
		if (buffers.size == 0) return;
		// attach task to worker
		worker.task = task;
		// attach worker to task
		task.worker = worker;
		// increase work load
		tasker.load += 1;
		// create work package
		var vars = [], pass = [];
		vars.push(buffers.size);
		vars.push(buffers.cmds || 0);
		vars.push(buffers.args);
		task.invoke('updateUniforms');
		vars.push(buffers.uniforms);
		
		// append result buffers
		var input = buffers.input,
		    shareds = buffers.shareds,
			iL = input ? input.length: 0,
		    sL = shareds.length;
		// switch the buffers
		vars.push(iL + sL);
		for (var i = 0; i < iL; i++) {
			vars.push(input[i]);
		}
		for (var i = 0; i < sL; i++) {
			vars.push(shareds[i]);
		}

		var results = buffers.backups,
		    uniforms = buffers.uniforms,
		    rL = results.length;
		// switch the buffers
		for (var i = 0; i < rL; i++) {
			vars.push(results[i]);
		}
		// pass everything that is a buffer
		for (var i = 0; i < vars.length; i++) {
			if (vars[i] && vars[i].buffer) {
				pass.push(vars[i].buffer);
			}
		}
		for (var i = 0; i < uniforms.length; i++) {
			if (uniforms[i] && uniforms[i].buffer) {
				pass.push(uniforms[i].buffer);
			}
		}
		// time marker for worker
		worker.t_start = Date.now();
		// inform detached state
		task.invoke('calculate', worker);
		tasker.invoke('calculate', task, worker);
		// pass everything to worker
		worker.postMessage(vars, pass);
		// mark worker as busy
		worker.idle = false;
	}
	// EO execute

	// handler for results
	function onResult (e)
	{
		// closure variables
		var worker = this,
		    task = worker.task,
		    tasker = worker.parent;
		// get passed data
		var size = e.data[0],
		    cmds = e.data[1],
		    args = e.data[2],
		    uniforms = e.data[3],
		    inputs = e.data[4] || 0,
		    delta = inputs + 5;

		// buffer object on our side
		// if (!task) debugger;
		var buffers = task.tbuffers;
		// fetch optional cmds array
		if (cmds && !isNaN(cmds.length)) {
			buffers.cmds = cmds;
		}
		// attach back to task
		buffers.args = args;
		buffers.uniforms = uniforms;
		var input = buffers.input;
		var results = buffers.backups;
		var shareds = buffers.shareds;
		// switch buffer slots
		buffers.backups = buffers.results;
		buffers.results = results;
		// append result buffers
		var iL = input ? input.length: 0,
		    sL = shareds.length;
		// switch the buffers
		for (var i = 0; i < iL; i++) {
			buffers.input[i] = e.data[5+i];
		}
		for (var i = 0; i < sL; i++) {
			buffers.shareds[i] = e.data[5+iL+i];
		}
		var eL = e.data.length - 5 - iL - sL;
		for (var i = 0; i < eL; i++) {
			buffers.results[i] = e.data[5+iL+sL+i];
		}

		// decrease load
		tasker.load -= 1;
		// Runtime statistics
		tasker.tasks += size;
		tasker.batches += 1;
		task.worker = null;
		worker.task = null;
		worker.idle = true;
		// time marker for worker
		worker.t_result = Date.now();
		worker.t_busy += worker.t_result
		               - worker.t_start;
		// check if more work is pending
		if (tasker.queue.length > 0) {
			// take some work from the queue
			var batch = tasker.queue.shift();
			// batch was dequeued
			batch.queued = false;
			// dispatch queued task to worker
			work.call(tasker, worker, batch);
		}
		// invoke done callbacks synchronous
		// only time you have access to some buffers
		// afterwards they might be sent off to work
		tasker.invoke('calculated', task, worker);
		task.invoke('calculated', worker);
		// check if tasker is fully done
		if (tasker.load !== 0) return;

	}
	// EO onResult

	// handler for init phase
	function onInit (e)
	{
		// switch message handler for run mode
		if (e.data.run) { this.onmessage = onResult; }
		else { throw new Error("unexpected message"); }
	}
	// EO onInit

	// create a new (augmented) class
	var Tasker = THREEAPP.Class.create('Tasker', null, ['Events', 'Options'])

	// constructor
	.ctor(function ctor()
	{
		var tasker = this;
		// registered plugins
		tasker.PLUGINS = {};
		tasker.plugins = [];
		// allocated workers
		tasker.workers = [];
		// queued tasks
		tasker.queue = [];
		// busy worker count
		tasker.load = 0;
		// runtime stats
		tasker.tasks = 0;
		tasker.batches = 0;
	})

	// options
	.defaults({
		// auto-detect
		threads: 0,
		// max-queue size
		maxqueue: 4096*8,
		// main worker url
		taskerUrl: 'Worker.js',
		// workers root
		root: '../src'
	})

	// auto-detect CPUs
	.init(function init()
	{
		// closure variables
		var tasker = this, options = tasker.options;
		// start auto-detection or use preset thread count
		this.wait(new Promise(function (resolve) {
			// check if auto-detect is enabled
			if (options.threads == 0) {
				// do auto detection for best thread count
				THREEAPP.CPUs(tasker.path('CPUs'), function (threads)
				{
					// set instance variable to best detected thread count
					tasker.threads = parseInt(Math.min(threads / 1.3, 6));
					// resolve promise
					resolve();
				});
			}
			else {
				// copy option to instance variable
				tasker.threads = options.threads;
				// resolve promise
				resolve();
			}
		}));
	})

	// threads are detected
	.ready(function ready()
	{
		var tasker = this,
		    workers = tasker.workers;
		// get the url for tasker workers
		var tskurl = this.options.taskerUrl;
		// only start tasker once
		if (tasker.started) return;
		// create and init given number of workers
		for (var i = 0; i < tasker.threads; i += 1) {
			// create one worker instance for each thread
			workers[i] = new Worker(tasker.path(tskurl));
			// wait for run confirmation
			workers[i].onmessage = onInit;
			// for access in handlers
			workers[i].parent = tasker;
			// mark worker as idle
			workers[i].idle = true;
			// set worker index
			workers[i].id = i;
			// runtime statistics
			workers[i].t_busy = 0;
			// pass plugins to worker
			workers[i].postMessage({
				plugins: tasker.plugins
			});
		}
		// add start timestamp
		tasker.t_start = Date.now();
		// check if more work is pending
		if (tasker.queue.length > 0) {
			// get tasker and workers from objects
			var tasker = this, workers = tasker.workers;
			// check if we have an idle worker
			if (/* tasker.isReady && */ tasker.isIdle()) {
				// first locate idle worker in array
				for (var i = 0; i < workers.length; ++i) {
					// check if worker is idle
					if (workers[i].idle) {
						// dequeue the next item from queue
						var task = tasker.queue.shift();
						// dispatch task to worker via execute
						work.call(tasker, workers[i], task);
						// no longer queued
						task.queued = false;
						// we are done here
						return;
					}
				}
			}
		}
	})

	// get path from relative root
	.method('path', function path(url)
	{
		var root = this.options.root;
		return root.replace(/\/+$/, '')
			+ '/' + url.replace(/^\/+/, '');
	})

	// register plugin for tasker
	.method('register', function register(plugin)
	{
		var tasker = this, plugins = tasker.plugins;
		// assert that we are not called at an invalid program state
		// you can only register plugins before the runners are started
		if (tasker.started) { throw new Error('Cannot register after start'); }
		if (!plugin.api) { throw new Error('Plugin must have a task API class'); }
		// get next static plugin id
		plugin.id = plugins.length;
		// base class constrains how the
		// inputs and outputs are mapped
		var base = plugin.api;
		// check for unique class id
		if (isNaN(base.classid)) {
			base.classid = classid ++;
		}
		// inherit from base
		plugin.args = base.args;
		plugin.classid = base.classid;
		plugin.results = base.results;
		plugin.uniforms = base.uniforms;
		// base may force single cmds for all
		if (base.cmds) plugin.name = base.cmds;
		// remove base reference
		// can't be passed to worker
		delete plugin.base;
		plugins.push(plugin);
		// check if we are trying to overwrite existing plugin
		if (this.PLUGINS[plugin.name]) { throw new Error('Plugin already exists'); }
		// also keep a hash dictionary
		this.PLUGINS[plugin.name] = plugin
	})

	// add more work for tasker
	.method('push', function push(task)
	{
		// check if task is already busy
		if (task.queued || task.worker) {
			throw "task already busy" + task.queued;
		}
		// get tasker and workers from objects
		var tasker = task.tasker = this,
		    workers = tasker.workers;
		// check if we have an idle worker
		if (tasker.isReady && tasker.isIdle()) {
			// first locate idle worker in array
			for (var i = 0; i < workers.length; ++i) {
				// check if worker is idle
				if (workers[i].idle) {
					// dispatch task to worker via execute
					work.call(tasker, workers[i], task);
					// we are done here
					return;
				}
			}
		}
		// check if we have reached the queue limit
		if (tasker.queue.length >= tasker.options.maxqueue) {
			throw Error("Tasker queue limit exhausted");
		}
		// all workers seem to be busy atm
		// so add the task to the queue
		tasker.queue.push(task);
		// mark as already pending
		task.queued = true;
	})

	// Get plugin struct by name
	.method('isIdle', function isIdle()
	{
		if (!this.ready) return false;
		// check if load is not at max
		return this.load < this.threads;
	})

	// end of class
	;

	// assign class to global namespace
	THREEAPP('Tasker', Tasker);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// configure the work distribution
	var distribution = [0, 0, 1, 0, 0, 1, 2];

	// create a new (augmented) class
	var Scheduler = THREEAPP.Class.create('Scheduler')

	// constructor
	.ctor(function ctor(app) {
		// get variables
		this.app = app;
		var scheduler = this;
		app.scheduler = scheduler;
		scheduler.tasker = app.tasker;
		// number of batches
		scheduler.batches = 0;
		// plannet batches per frame
		scheduler.plan = [[], [], []];
		for (var i = 0; i < 3; i++) {
			// plan iterator values
			scheduler.plan[i].it = 0;
			scheduler.plan[i].done = 0;
			// information status flags
			scheduler.plan[i].onTime = 0;
			scheduler.plan[i].delayed = 0;
			scheduler.plan[i].completed = 0;
		}
		// class iterator
		scheduler.it = 0;
		scheduler.ticks = 0;
	})

	// options
	.defaults({
	})

	// attach listeners
	.init(function init(app) {
		// called before task is passed to worker (not used yet)
		// this.tasker.listen('calculate', function (task, worker) {});
		// called after task comes back from worker
		this.tasker.listen('calculated', function (task, worker) {
			app.scheduler.plan[task.prio].done ++;
			app.scheduler.tick();
		});
	})

	// scheduler is ready
	.ready(function () {
	})

	// called from threeapp plugin
	.method('frame', function frame() {
		// restart frame
		this.done = 0;
		this.it = 0;
		// reset all plans that have been completed
		// set on time status for all other to false
		for (var i = 0; i < 3; i++) {
			// check if plan is done
			var L = this.plan[i].length;
			if (this.plan[i].done >= L) {
				this.plan[i].done = 0;
				this.plan[i].it = 0;
				this.plan[i].completed ++;
				if (!this.plan[i].late) {
					this.plan[i].onTime ++;
				}
				this.plan[i].late = false;
			} else {
				// mark as running late
				this.plan[i].late = true;
				this.plan[i].delayed ++;
			}
			// restart this class
			this.plan[i].last = false;
		}
		// call tick
		this.tick();
	})

	// only called by ourself
	.method('tick', function tick() {
		// try to saturate tasker (until all done)
		while (this.tasker.isIdle() && this.done < 3) {
			// fetch the plan group
			var plan = this.plan[this.it];
			// if (plan.last) continue;
			// check if plan reached end
			if (plan.it >= plan.length) {
				if (!plan.last) {
					// only count once
					plan.last = true;
					// plan is done
					this.done += 1;
				}
			}
			// plan has work
			else {
				// calculate next task
				var task = plan[plan.it];
				task.prio = this.it;
				// debugger;
				this.tasker.push(task);
				plan.it ++;
			}
			// increment or reset ticks counters
			this.ticks = this.ticks == 6 ? 0 : this.ticks + 1;
			// get class from work distribution
			this.it = distribution[this.ticks];
		}
		// mark frame done
		// this.done = true;
	})

	// add a new planned batch
	.method('push', function push(obj, prio) {
		this.plan[prio].push(obj);
		this.batches += 1;
		this.tick();
	})

	// remove a planned batch
	.method('remove', function remove(obj, prio) {
		var plan = this.plan[prio];
		var idx = isNaN(obj) ? plan.indexOf(obj) : obj;
		if (idx < 0) return; // not found
		plan.splice(idx, 1);
		this.batches -= 1;
	})

	// end of class
	;

	// assign class to global namespace
	THREEAPP('Scheduler', Scheduler);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Add license text here
	Copyright 2016 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// called when we actually want to allocate
	// new buffers (limits probably changed).
	function allocate()
	{
		// get options from objects
		var L = this.items.length,
		    aL = this.tbuffers.allocated,
		    HL = this.options.hardLimit,
		    INC = this.options.increment,
		    cmds = this.api.cmds;
		// check if we got items
		if (L == 0) return;
		// increase aL until we have enough room
		while (L > aL) aL = Math.min(HL, Math.max(10, aL) * INC);
		// create result buffers (array of buffer arrays)
		var results = [], backups = [], shareds = [],
			rsizes = this.api.results || [],
			shsizes = this.api.shared || [];
		for (var i = 0; i < rsizes.length; i ++) {
			var size = isNaN(rsizes[i]) ? rsizes[i].length : rsizes[i];
			var alloc = size < 0 ? - size : size * aL;
			results[i] = new Float32Array(alloc);
			backups[i] = new Float32Array(alloc);
		}
		for (var i = 0; i < shsizes.length; i ++) {
			var size = isNaN(shsizes[i]) ? shsizes[i].length : shsizes[i];
			var alloc = size < 0 ? - size : size;
			shareds[i] = new Float32Array(alloc);
		}
		// lookup command if it's a string
		if (typeof cmds == "string") {
			var tasker = this.tasker;
			cmds = tasker.PLUGINS[cmds].id;
		}
		// re-allocate buffers
		this.tbuffers = {
			size: L,
			busy: false,
			stale: false,
			allocated: aL,
			results: results,
			backups: backups,
			shareds: shareds,
			uniforms: new Float32Array(this.api.uniforms),
			args: new Float32Array(this.api.args * aL),
			cmds: isNaN(cmds) ? new Float32Array(aL) : cmds
		}
	}

	// create a new (augmented) mixin (inherit group)
	var Batch = THREEAPP.Class.virtual(THREEAPP.Group)

	// constructor
	.ctor(function ctor() {

		// parent worker
		this.worker = null;
		// pending in tasker
		this.queued = false;
		// start empty
		this.tbuffers = {
			size: 0,
			busy: false,
			stale: true,
			allocated: 0,
			results: [],
			backups: [],
			shareds: [],
			uniforms: [],
			args: [],
		};
	})

	// return a fresh buffer object
	.method('buffers', function buffers(obj) {
		// refresh if it's stale
		if (this.tbuffers.stale) {
			// if (this.worker) debugger;
			allocate.call(this);
			// do not re-allocate
			this.tbuffers.stale = false;
			// update values in buffer
			this.invoke('syncArguments');
			// store number of synced items
			this.tbuffers.size = this.items.length;
		}
		// return fresh buffers
		return this.tbuffers;
	})

	// called from tasker when done
	// sync results to items/objects
	.listen('calculated', function calculated(worker) {
		var buffers = this.tbuffers,
		    results = buffers.results;
		if (!buffers.stale) this.invoke('syncResults');
		buffers.tstamp = Date.now() - this.tasker.t_start;
	})

	.listen('resized', function () {
		// mark buffers for refresh
		this.tbuffers.stale = true;
	})

	// end
	;

	// assign class to global namespace
	THREEAPP('Batch', Batch);

})(THREE, THREEAPP);
;
/**
 * @author mrdoob / http://mrdoob.com/
 * @author mgreter / http://github.com/mgreter
 */

var StatsCPU = function (tasker) {

	var now = ( self.performance && self.performance.now ) ? self.performance.now.bind( performance ) : Date.now;

	var startTime = now(), prevTime = startTime;
	var frames = 0, mode = 0;

	function createElement( tag, id, css ) {

		var element = document.createElement( tag );
		element.id = id;
		element.style.cssText = css;
		return element;

	}

	function createPanel( id, fg, bg, slices ) {

		var div = createElement( 'div', id, 'padding:0 0 3px 3px;text-align:left;background:' + bg );

		var text = createElement( 'div', id + 'Text', 'font-family:Tahoma,Helvetica,Arial,sans-serif;font-size:8px;font-weight:bold;line-height:15px;color:' + fg );
		text.innerHTML = id.toUpperCase();
		div.appendChild( text );

		var w = 94 / slices, wd = 94;
		var graph = createElement( 'div', id + 'Graph', 'width:94px;height:30px;background:' + fg );
		div.appendChild( graph );

		for ( var i = 0; i < slices; i ++ ) {
			var wx = parseInt(w) == w ? w + 'px' : (100 / slices) + '%';
			graph.appendChild( createElement( 'span', '', 'width:'+wx+';height:30px;float:left;opacity:0.9;background:' + bg ) );
		}

		return div;

	}

	function setMode( value ) {

		var children = container.children;

		for ( var i = 0; i < children.length; i ++ ) {

			children[ i ].style.display = i === value ? 'block' : 'none';

		}

		mode = value;

	}

	var fitness = 0, fitoff = 0;

	setInterval(function () {
		fitness ++;
	}, 20);

	setInterval(function () {
		fitoff = Math.abs(50 - fitness);
		fitness = 0;
	}, 1000);

	var cpuload = [];
	function updateLoads ( dom, values ) {
		var now = Date.now();
		if (!dom.firstChild) return;
		idlesDiv.style.background = 'rgba(' + fitoff*7 + ', 64, 0, 1)';
		for (var i = 0; i < dom.children.length; i ++) {
			var worker = tasker.workers[i];
			var load = cpuload[i] || 0;
			if (!worker.idle) load = 1;
			dom.children[i].style.height = Math.max(Math.min( 30, 30 - load * 30 ), 0.25) + 'px';
		}
	}

	function updateGraph( dom, value ) {

		var child = dom.appendChild( dom.firstChild );
		child.style.height = Math.max(Math.min( 30, 30 - value * 30 ), 0.25) + 'px';

	}

	//

	var container = createElement( 'div', 'statsCPU', 'width:100px;opacity:0.9;cursor:pointer' );
	container.addEventListener( 'mousedown', function ( event ) {

		event.preventDefault();
		setMode( ++ mode % container.children.length );

	}, false );

	// TASKS

	var tasks = 0, tasksMin = Infinity, tasksMax = 0;

	var tasksDiv = createPanel( 'tasks', '#306', '#ccc', 94 );
	var tasksText = tasksDiv.children[ 0 ];
	var tasksGraph = tasksDiv.children[ 1 ];

	container.appendChild( tasksDiv );

	// BATCHES

	var batches = 0, batchesMin = Infinity, batchesMax = 0;

	var batchesDiv = createPanel( 'batches', '#09f', '#ccc', 94 );
	var batchesText = batchesDiv.children[ 0 ];
	var batchesGraph = batchesDiv.children[ 1 ];

	container.appendChild( batchesDiv );

	// BATCHES

	var queues = 0, queuesMin = Infinity, queuesMax = 0;

	var queuesDiv = createPanel( 'queues', '#99f', '#339', 94 );
	var queuesText = queuesDiv.children[ 0 ];
	var queuesGraph = queuesDiv.children[ 1 ];

	container.appendChild( queuesDiv );

	// LOAD

	var idles = 0, idlesMin = Infinity, idlesMax = 0;
	var idlesDiv, idlesText, idlesGraph;

	var history = [],
	    busy = [],
	    old = 0;

	function resetStats() {
		var now = Date.now();
		var dtime = now - old;
		for (var i = 0; i < app.tasker.workers.length; i++) {
			if (!busy[i]) {
				busy[i] = app.tasker.workers[i].t_busy;
			}
			else {
				var tbusy = app.tasker.workers[i].t_busy - busy[i];
				cpuload[i] = tbusy / dtime;
				busy[i] = app.tasker.workers[i].t_busy;
			}
		}
		old = now;
	}

	function onReady() {
		idlesDiv = createPanel( 'workers', '#0f0', '#020', tasker.threads );
		idlesText = idlesDiv.children[ 0 ];
		idlesGraph = idlesDiv.children[ 1 ];
		container.appendChild( idlesDiv );
		setMode(3); // show of cpu use
		for (var i = 0; i < tasker.threads; i += 1) {
			tasker.workers[i].busy = 0;
			tasker.workers[i].idling = 0;
		}

		setInterval(resetStats, 1000);

	};

	// tasker.onReady(
	tasker.listen('ready', onReady);

	//

	setMode( mode );

	function KMG (nr) {
		var u = '';
		if (nr >= 1e10) {
			nr = nr / 1e9;
			u = "G";
		}
		else if (nr >= 1e7) {
			nr = nr / 1e6;
			u = "M";
		}
		else if (nr >= 1e4) {
			nr = nr / 1e3;
			u = "K"
		}
		nr = parseInt(nr);
		return nr + u;
	}

	return {

		REVISION: 14,

		domElement: container,

		setMode: setMode,

		begin: function () {

			startTime = now();

		},

		end: function () {

			var time = now();

			frames += 1;

			if ( time > prevTime + 250 ) {

				tasks = Math.round( ( tasker.tasks * 1000 ) / ( time - prevTime ) );
				tasksMin = Math.min( tasksMin, tasks );
				tasksMax = Math.max( tasksMax, tasks );

				tasksText.textContent = KMG(tasks) + ' TSK (' /* + KMG(tasksMin) + '-' */ + KMG(tasksMax) + ')';
				updateGraph( tasksGraph, tasks / tasksMax );

				batches = Math.round( ( tasker.batches * 1000 ) / ( time - prevTime ) );
				batchesMin = Math.min( batchesMin, batches );
				batchesMax = Math.max( batchesMax, batches );

				batchesText.textContent = KMG(batches) + ' BAT (' /* + KMG(batchesMin) + '-' */ + KMG(batchesMax) + ')';
				updateGraph( batchesGraph, batches / batchesMax );

				queues = Math.round( ( tasker.queue.length * 1000 ) / ( time - prevTime ) );
				queuesMin = Math.min( queuesMin, queues );
				queuesMax = Math.max( queuesMax, queues );

				queuesText.textContent = KMG(queues) + ' QUE (' /* + (queuesMin) + '-' */ + KMG(queuesMax) + ')';
				updateGraph( queuesGraph, queues / queuesMax );

				if (idlesGraph) {
					updateLoads( idlesGraph );
					var status = tasker.isIdle() ? "" : "BSY";
					idlesText.textContent = 'CPUS '+ status + ' (' + tasker.threads + ')';
					for (var i = 0; i < tasker.workers.length; i += 1) {
						tasker.workers[i].busy = 0;
						tasker.workers[i].idling = 0;
					}
				}

				frames = 0;
				prevTime = time;
				tasker.tasks = 0;
				tasker.batches = 0;

			}

			return time;

		},

		update: function () {

			startTime = this.end();
			updateLoads( idlesGraph );

		}

	};

};

if ( typeof module === 'object' ) {

	module.exports = StatsCPU;

};
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	var DATUI = THREEAPP.Class.create('DATUI', null, ['Plugin'])

	.proto('provides', 'datui')

	.ctor(function (app) {
		app.datui = new dat.GUI();
	})

	.init(function (app) {
		app.datui.close();
	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.DATUI', DATUI);

// EO private scope
})(THREE, THREEAPP);
;
/*
	Copyright 2017 Marcel Greter
	https://www.github.com/mgreter
*/

// private scope
(function (THREE, THREEAPP)
{
	"use strict";

	// create a new (augmented) class
	var MonitorCPU = THREEAPP.Class.create('MonitorCPU', null, ['Plugin'])

	.proto('requires', 'tasker')

	.ready(function (app) {

		// optional CPU monitor
		var monitor = new StatsCPU(app.tasker);
		app.viewport.appendChild(monitor.domElement);
		app.listen('preframe', function () { monitor.begin(); }, -99999);
		app.listen('postframe', function () { monitor.end(); }, +99999);

	})

	;

	// assign class to global namespace
	THREEAPP('Plugin.MonitorCPU', MonitorCPU);

// EO private scope
})(THREE, THREEAPP);
;
/*
JavaScript LZMA Decompressor (https://github.com/jcmellado/js-lzma)
- Copyright (c) 2017 Juan Mellado (https://github.com/jcmellado)
- Copyright (c) 2017 Marcel Greter (http://github.com/mgreter)
*/;
var LZMA=LZMA||{};
(function(d){d.iStream=function(b){this.array=new Uint8Array(b);this.size=b.byteLength;this.offset=0};d.iStream.prototype.readByte=function(){return this.array[this.offset++]};d.oStream=function(b){this.size=0;this.buffers=[];b=b||[];for(var c=0,h=b.length;c<h;c++)if(b[c]instanceof d.oStream)for(var f=b[c].buffers,e=0;e<f.length;e++)this.buffers.push(b[c].buffers[e]),this.size+=b[c].buffers[e].length;else this.buffers.push(b[c]),this.size+=b[c].length};d.oStream.prototype.writeBytes=function(b,c){if(c<=
b.byteLength)this.buffers.push(b.slice(0,c));else throw Error("Buffer too small?");this.size+=c};d.oStream.prototype.toUint8Array=function(){var b=this.size,c=this.buffers;if(1==c.length)return c[0];try{for(var d=new Uint8Array(b),f=0,e=0;f<c.length;f++)d.set(c[f],e),e+=c[f].length;c[0]=d;c.length=1;return d}catch(g){console.error("Error allocating Uint8Array of size: ",b),console.error("Message given was: ",g.toString())}return null};d.oStream.prototype.forEach=function(b){for(var c=0;c<this.buffers.length;c++)b.call(this,
this.buffers[c])};d.oStream.prototype.toCodePoints=function(){d.UTF8||this.toUint8Array();return d.UTF8.decode(this.toUint8Array())};d.oStream.prototype.toString=function(){var b=this.buffers,c="";d.UTF8&&(b=[this.toCodePoints()]);for(var h=0,f=b.length;h<f;h++)for(var e=0,g=b[h].length;e<g;e++)c+=String.fromCharCode(b[h][e]);return c}})(LZMA);var UTF8=UTF8||{};
(function(d){function b(a){for(var c=0,b=a.length;b--;)128!=(a[b]&192)&&++c;return c}function c(){if(g>=e)throw Error("Invalid byte index");var a=f[g++]&255;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function h(){var a,b,d,k;if((g|0)>(e|0))throw Error("Invalid byte index");a=f[g]&255;g=g+1|0;if(0==(a&128))return a;if(192==(a&224)){b=c();a=(a&31)<<6|b;if(128<=a)return a;throw Error("Invalid continuation byte");}if(224==(a&240)){b=c();d=c();a=(a&15)<<12|b<<6|d;if(2048<=a){if(55296<=
a&&57343>=a)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return a}throw Error("Invalid continuation byte");}if(240==(a&248)&&(b=c(),d=c(),k=c(),a=(a&7)<<18|b<<12|d<<6|k,65536<=a&&1114111>=a))return a;throw Error("Invalid UTF-8 detected");}var f,e,g;d.count=b;d.decode=function(a){var c=0,d=b(a),d=new Uint16Array(d);g=0;f=a;e=a.length;for(2<(e|0)&239==(f[0]|0)&187==(f[1]|0)&191==(f[2]|0)&&(g=3);(g|0)<(e|0);)a=h()|0,d[c++]=a;return d};"undefined"!=typeof LZMA&&
(LZMA.UTF8=d)})(UTF8);var LZMA=LZMA||{},WLZMA=WLZMA||{};
(function(d,b){function c(a){var b=a.data[0],c=a.data[1];a=a.data[2];var f=this.manager;this.idle=!0;f.idle++;if(-1==f.next||f.next>b)f.next=b;a?this.reject(a):c?this.resolve(new d.oStream(c)):this.reject(null);this.reject=this.resolve=null;e.call(f)}function h(){for(var a=this.listeners;a.length;)a.shift().call(this);this.isReady=!0}function f(a){var b=this.manager;if("ready"===a.data)this.onmessage=c,this.isReady=!0,b.started++,b.started==b.workers.length&&h.call(b);else throw Error("Worker did not startup!?");
}function e(){for(;this.queue.length&&this.idle;){var a=this.next,b=this.queue.shift();"function"==typeof b[0]&&(b[0]=b[0].call(this));var c=this.workers[a];if(!c)debugger;c.postMessage([a,b[0]],[b[0]]);c.resolve=b[1];c.reject=b[2];c.idle=!1;for(--this.idle;a<this.workers.length;a++)if(this.workers[a].idle){this.next=a;return}this.next=-1}}function g(a){"object"==typeof a&&(a instanceof d.iStream&&(a=a.array),a instanceof Uint8Array&&(a=a.buffer));return a}b.wrkurl=b.wrkurl||"wlzma.wrk.js";b.Manager=
function(a,c){a=a||6;this.queue=[];this.workers=[];c=c||b.wrkurl;this.listeners=[];this.isReady=!1;for(var d=this.started=0;d<a;d++){var e=new Worker(c);e.onmessage=f;this.workers.push(e);e.manager=this;e.idle=!0}this.idle=a;this.next=0};b.Manager.prototype.ready=function(a){this.isReady?a.call(this):this.listeners.push(a)};b.Manager.prototype.decode=function(a){var b=this;a=g(a);return new Promise(function(c,d){b.queue.push([a,c,d]);e.call(b)})}})(LZMA,WLZMA);
;
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["dat"] = factory();
	else
		root["dat"] = factory();
})(this, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	var _index = __webpack_require__(1);

	var _index2 = _interopRequireDefault(_index);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	module.exports = _index2.default; /**
	                                   * dat-gui JavaScript Controller Library
	                                   * http://code.google.com/p/dat-gui
	                                   *
	                                   * Copyright 2011 Data Arts Team, Google Creative Lab
	                                   *
	                                   * Licensed under the Apache License, Version 2.0 (the "License");
	                                   * you may not use this file except in compliance with the License.
	                                   * You may obtain a copy of the License at
	                                   *
	                                   * http://www.apache.org/licenses/LICENSE-2.0
	                                   */

/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Color = __webpack_require__(2);

	var _Color2 = _interopRequireDefault(_Color);

	var _math = __webpack_require__(6);

	var _math2 = _interopRequireDefault(_math);

	var _interpret = __webpack_require__(3);

	var _interpret2 = _interopRequireDefault(_interpret);

	var _Controller = __webpack_require__(7);

	var _Controller2 = _interopRequireDefault(_Controller);

	var _BooleanController = __webpack_require__(8);

	var _BooleanController2 = _interopRequireDefault(_BooleanController);

	var _OptionController = __webpack_require__(10);

	var _OptionController2 = _interopRequireDefault(_OptionController);

	var _StringController = __webpack_require__(11);

	var _StringController2 = _interopRequireDefault(_StringController);

	var _NumberController = __webpack_require__(12);

	var _NumberController2 = _interopRequireDefault(_NumberController);

	var _NumberControllerBox = __webpack_require__(13);

	var _NumberControllerBox2 = _interopRequireDefault(_NumberControllerBox);

	var _NumberControllerSlider = __webpack_require__(14);

	var _NumberControllerSlider2 = _interopRequireDefault(_NumberControllerSlider);

	var _FunctionController = __webpack_require__(15);

	var _FunctionController2 = _interopRequireDefault(_FunctionController);

	var _ColorController = __webpack_require__(16);

	var _ColorController2 = _interopRequireDefault(_ColorController);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _GUI = __webpack_require__(17);

	var _GUI2 = _interopRequireDefault(_GUI);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	exports.default = {
	  color: {
	    Color: _Color2.default,
	    math: _math2.default,
	    interpret: _interpret2.default
	  },

	  controllers: {
	    Controller: _Controller2.default,
	    BooleanController: _BooleanController2.default,
	    OptionController: _OptionController2.default,
	    StringController: _StringController2.default,
	    NumberController: _NumberController2.default,
	    NumberControllerBox: _NumberControllerBox2.default,
	    NumberControllerSlider: _NumberControllerSlider2.default,
	    FunctionController: _FunctionController2.default,
	    ColorController: _ColorController2.default
	  },

	  dom: {
	    dom: _dom2.default
	  },

	  gui: {
	    GUI: _GUI2.default
	  },

	  GUI: _GUI2.default
	};

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _interpret = __webpack_require__(3);

	var _interpret2 = _interopRequireDefault(_interpret);

	var _math = __webpack_require__(6);

	var _math2 = _interopRequireDefault(_math);

	var _toString = __webpack_require__(4);

	var _toString2 = _interopRequireDefault(_toString);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } } /**
	                                                                                                                                                           * dat-gui JavaScript Controller Library
	                                                                                                                                                           * http://code.google.com/p/dat-gui
	                                                                                                                                                           *
	                                                                                                                                                           * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                           *
	                                                                                                                                                           * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                           * you may not use this file except in compliance with the License.
	                                                                                                                                                           * You may obtain a copy of the License at
	                                                                                                                                                           *
	                                                                                                                                                           * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                           */

	var Color = function () {
	  function Color() {
	    _classCallCheck(this, Color);

	    this.__state = _interpret2.default.apply(this, arguments);

	    if (this.__state === false) {
	      throw new Error('Failed to interpret color arguments');
	    }

	    this.__state.a = this.__state.a || 1;
	  }

	  Color.prototype.toString = function toString() {
	    return (0, _toString2.default)(this);
	  };

	  Color.prototype.toHexString = function toHexString() {
	    return (0, _toString2.default)(this, true);
	  };

	  Color.prototype.toOriginal = function toOriginal() {
	    return this.__state.conversion.write(this);
	  };

	  return Color;
	}();

	function defineRGBComponent(target, component, componentHexIndex) {
	  Object.defineProperty(target, component, {
	    get: function get() {
	      if (this.__state.space === 'RGB') {
	        return this.__state[component];
	      }

	      Color.recalculateRGB(this, component, componentHexIndex);

	      return this.__state[component];
	    },

	    set: function set(v) {
	      if (this.__state.space !== 'RGB') {
	        Color.recalculateRGB(this, component, componentHexIndex);
	        this.__state.space = 'RGB';
	      }

	      this.__state[component] = v;
	    }
	  });
	}

	function defineHSVComponent(target, component) {
	  Object.defineProperty(target, component, {
	    get: function get() {
	      if (this.__state.space === 'HSV') {
	        return this.__state[component];
	      }

	      Color.recalculateHSV(this);

	      return this.__state[component];
	    },

	    set: function set(v) {
	      if (this.__state.space !== 'HSV') {
	        Color.recalculateHSV(this);
	        this.__state.space = 'HSV';
	      }

	      this.__state[component] = v;
	    }
	  });
	}

	Color.recalculateRGB = function (color, component, componentHexIndex) {
	  if (color.__state.space === 'HEX') {
	    color.__state[component] = _math2.default.component_from_hex(color.__state.hex, componentHexIndex);
	  } else if (color.__state.space === 'HSV') {
	    _common2.default.extend(color.__state, _math2.default.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));
	  } else {
	    throw new Error('Corrupted color state');
	  }
	};

	Color.recalculateHSV = function (color) {
	  var result = _math2.default.rgb_to_hsv(color.r, color.g, color.b);

	  _common2.default.extend(color.__state, {
	    s: result.s,
	    v: result.v
	  });

	  if (!_common2.default.isNaN(result.h)) {
	    color.__state.h = result.h;
	  } else if (_common2.default.isUndefined(color.__state.h)) {
	    color.__state.h = 0;
	  }
	};

	Color.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];

	defineRGBComponent(Color.prototype, 'r', 2);
	defineRGBComponent(Color.prototype, 'g', 1);
	defineRGBComponent(Color.prototype, 'b', 0);

	defineHSVComponent(Color.prototype, 'h');
	defineHSVComponent(Color.prototype, 's');
	defineHSVComponent(Color.prototype, 'v');

	Object.defineProperty(Color.prototype, 'a', {
	  get: function get() {
	    return this.__state.a;
	  },

	  set: function set(v) {
	    this.__state.a = v;
	  }
	});

	Object.defineProperty(Color.prototype, 'hex', {
	  get: function get() {
	    if (!this.__state.space !== 'HEX') {
	      this.__state.hex = _math2.default.rgb_to_hex(this.r, this.g, this.b);
	    }

	    return this.__state.hex;
	  },

	  set: function set(v) {
	    this.__state.space = 'HEX';
	    this.__state.hex = v;
	  }
	});

	exports.default = Color;

/***/ },
/* 3 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _toString = __webpack_require__(4);

	var _toString2 = _interopRequireDefault(_toString);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	var INTERPRETATIONS = [
	// Strings
	{
	  litmus: _common2.default.isString,
	  conversions: {
	    THREE_CHAR_HEX: {
	      read: function read(original) {
	        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);
	        if (test === null) {
	          return false;
	        }

	        return {
	          space: 'HEX',
	          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)
	        };
	      },

	      write: _toString2.default
	    },

	    SIX_CHAR_HEX: {
	      read: function read(original) {
	        var test = original.match(/^#([A-F0-9]{6})$/i);
	        if (test === null) {
	          return false;
	        }

	        return {
	          space: 'HEX',
	          hex: parseInt('0x' + test[1].toString(), 0)
	        };
	      },

	      write: _toString2.default
	    },

	    CSS_RGB: {
	      read: function read(original) {
	        var test = original.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
	        if (test === null) {
	          return false;
	        }

	        return {
	          space: 'RGB',
	          r: parseFloat(test[1]),
	          g: parseFloat(test[2]),
	          b: parseFloat(test[3])
	        };
	      },

	      write: _toString2.default
	    },

	    CSS_RGBA: {
	      read: function read(original) {
	        var test = original.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
	        if (test === null) {
	          return false;
	        }

	        return {
	          space: 'RGB',
	          r: parseFloat(test[1]),
	          g: parseFloat(test[2]),
	          b: parseFloat(test[3]),
	          a: parseFloat(test[4])
	        };
	      },

	      write: _toString2.default
	    }
	  }
	},

	// Numbers
	{
	  litmus: _common2.default.isNumber,

	  conversions: {

	    HEX: {
	      read: function read(original) {
	        return {
	          space: 'HEX',
	          hex: original,
	          conversionName: 'HEX'
	        };
	      },

	      write: function write(color) {
	        return color.hex;
	      }
	    }

	  }

	},

	// Arrays
	{
	  litmus: _common2.default.isArray,
	  conversions: {
	    RGB_ARRAY: {
	      read: function read(original) {
	        if (original.length !== 3) {
	          return false;
	        }

	        return {
	          space: 'RGB',
	          r: original[0],
	          g: original[1],
	          b: original[2]
	        };
	      },

	      write: function write(color) {
	        return [color.r, color.g, color.b];
	      }
	    },

	    RGBA_ARRAY: {
	      read: function read(original) {
	        if (original.length !== 4) return false;
	        return {
	          space: 'RGB',
	          r: original[0],
	          g: original[1],
	          b: original[2],
	          a: original[3]
	        };
	      },

	      write: function write(color) {
	        return [color.r, color.g, color.b, color.a];
	      }
	    }
	  }
	},

	// Objects
	{
	  litmus: _common2.default.isObject,
	  conversions: {

	    RGBA_OBJ: {
	      read: function read(original) {
	        if (_common2.default.isNumber(original.r) && _common2.default.isNumber(original.g) && _common2.default.isNumber(original.b) && _common2.default.isNumber(original.a)) {
	          return {
	            space: 'RGB',
	            r: original.r,
	            g: original.g,
	            b: original.b,
	            a: original.a
	          };
	        }
	        return false;
	      },

	      write: function write(color) {
	        return {
	          r: color.r,
	          g: color.g,
	          b: color.b,
	          a: color.a
	        };
	      }
	    },

	    RGB_OBJ: {
	      read: function read(original) {
	        if (_common2.default.isNumber(original.r) && _common2.default.isNumber(original.g) && _common2.default.isNumber(original.b)) {
	          return {
	            space: 'RGB',
	            r: original.r,
	            g: original.g,
	            b: original.b
	          };
	        }
	        return false;
	      },

	      write: function write(color) {
	        return {
	          r: color.r,
	          g: color.g,
	          b: color.b
	        };
	      }
	    },

	    HSVA_OBJ: {
	      read: function read(original) {
	        if (_common2.default.isNumber(original.h) && _common2.default.isNumber(original.s) && _common2.default.isNumber(original.v) && _common2.default.isNumber(original.a)) {
	          return {
	            space: 'HSV',
	            h: original.h,
	            s: original.s,
	            v: original.v,
	            a: original.a
	          };
	        }
	        return false;
	      },

	      write: function write(color) {
	        return {
	          h: color.h,
	          s: color.s,
	          v: color.v,
	          a: color.a
	        };
	      }
	    },

	    HSV_OBJ: {
	      read: function read(original) {
	        if (_common2.default.isNumber(original.h) && _common2.default.isNumber(original.s) && _common2.default.isNumber(original.v)) {
	          return {
	            space: 'HSV',
	            h: original.h,
	            s: original.s,
	            v: original.v
	          };
	        }
	        return false;
	      },

	      write: function write(color) {
	        return {
	          h: color.h,
	          s: color.s,
	          v: color.v
	        };
	      }
	    }
	  }
	}];

	var result = void 0;
	var toReturn = void 0;

	var interpret = function interpret() {
	  toReturn = false;

	  var original = arguments.length > 1 ? _common2.default.toArray(arguments) : arguments[0];
	  _common2.default.each(INTERPRETATIONS, function (family) {
	    if (family.litmus(original)) {
	      _common2.default.each(family.conversions, function (conversion, conversionName) {
	        result = conversion.read(original);

	        if (toReturn === false && result !== false) {
	          toReturn = result;
	          result.conversionName = conversionName;
	          result.conversion = conversion;
	          return _common2.default.BREAK;
	        }
	      });

	      return _common2.default.BREAK;
	    }
	  });

	  return toReturn;
	};

	exports.default = interpret;

/***/ },
/* 4 */
/***/ function(module, exports) {

	'use strict';

	exports.__esModule = true;

	exports.default = function (color, forceCSSHex) {
	  var colorFormat = color.__state.conversionName.toString();

	  var r = Math.round(color.r);
	  var g = Math.round(color.g);
	  var b = Math.round(color.b);
	  var a = color.a;
	  var h = Math.round(color.h);
	  var s = color.s.toFixed(1);
	  var v = color.v.toFixed(1);

	  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {
	    var str = color.hex.toString(16);
	    while (str.length < 6) {
	      str = '0' + str;
	    }
	    return '#' + str;
	  } else if (colorFormat === 'CSS_RGB') {
	    return 'rgb(' + r + ',' + g + ',' + b + ')';
	  } else if (colorFormat === 'CSS_RGBA') {
	    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';
	  } else if (colorFormat === 'HEX') {
	    return '0x' + color.hex.toString(16);
	  } else if (colorFormat === 'RGB_ARRAY') {
	    return '[' + r + ',' + g + ',' + b + ']';
	  } else if (colorFormat === 'RGBA_ARRAY') {
	    return '[' + r + ',' + g + ',' + b + ',' + a + ']';
	  } else if (colorFormat === 'RGB_OBJ') {
	    return '{r:' + r + ',g:' + g + ',b:' + b + '}';
	  } else if (colorFormat === 'RGBA_OBJ') {
	    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';
	  } else if (colorFormat === 'HSV_OBJ') {
	    return '{h:' + h + ',s:' + s + ',v:' + v + '}';
	  } else if (colorFormat === 'HSVA_OBJ') {
	    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';
	  }

	  return 'unknown format';
	};

/***/ },
/* 5 */
/***/ function(module, exports) {

	'use strict';

	exports.__esModule = true;
	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	var ARR_EACH = Array.prototype.forEach;
	var ARR_SLICE = Array.prototype.slice;

	/**
	 * Band-aid methods for things that should be a lot easier in JavaScript.
	 * Implementation and structure inspired by underscore.js
	 * http://documentcloud.github.com/underscore/
	 */

	var Common = {
	  BREAK: {},

	  extend: function extend(target) {
	    this.each(ARR_SLICE.call(arguments, 1), function (obj) {
	      var keys = this.isObject(obj) ? Object.keys(obj) : [];
	      keys.forEach(function (key) {
	        if (!this.isUndefined(obj[key])) {
	          target[key] = obj[key];
	        }
	      }.bind(this));
	    }, this);

	    return target;
	  },

	  defaults: function defaults(target) {
	    this.each(ARR_SLICE.call(arguments, 1), function (obj) {
	      var keys = this.isObject(obj) ? Object.keys(obj) : [];
	      keys.forEach(function (key) {
	        if (this.isUndefined(target[key])) {
	          target[key] = obj[key];
	        }
	      }.bind(this));
	    }, this);

	    return target;
	  },

	  compose: function compose() {
	    var toCall = ARR_SLICE.call(arguments);
	    return function () {
	      var args = ARR_SLICE.call(arguments);
	      for (var i = toCall.length - 1; i >= 0; i--) {
	        args = [toCall[i].apply(this, args)];
	      }
	      return args[0];
	    };
	  },

	  each: function each(obj, itr, scope) {
	    if (!obj) {
	      return;
	    }

	    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {
	      obj.forEach(itr, scope);
	    } else if (obj.length === obj.length + 0) {
	      // Is number but not NaN
	      var key = void 0;
	      var l = void 0;
	      for (key = 0, l = obj.length; key < l; key++) {
	        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {
	          return;
	        }
	      }
	    } else {
	      for (var _key in obj) {
	        if (itr.call(scope, obj[_key], _key) === this.BREAK) {
	          return;
	        }
	      }
	    }
	  },

	  defer: function defer(fnc) {
	    setTimeout(fnc, 0);
	  },

	  // call the function immediately, but wait until threshold passes to allow it to be called again
	  debounce: function debounce(func, threshold) {
	    var timeout = void 0;

	    return function () {
	      var obj = this;
	      var args = arguments;
	      function delayed() {
	        timeout = null;
	      }

	      var allowCall = !timeout;

	      clearTimeout(timeout);
	      timeout = setTimeout(delayed, threshold);

	      if (allowCall) {
	        func.apply(obj, args);
	      }
	    };
	  },

	  toArray: function toArray(obj) {
	    if (obj.toArray) return obj.toArray();
	    return ARR_SLICE.call(obj);
	  },

	  isUndefined: function isUndefined(obj) {
	    return obj === undefined;
	  },

	  isNull: function isNull(obj) {
	    return obj === null;
	  },

	  isNaN: function (_isNaN) {
	    function isNaN(_x) {
	      return _isNaN.apply(this, arguments);
	    }

	    isNaN.toString = function () {
	      return _isNaN.toString();
	    };

	    return isNaN;
	  }(function (obj) {
	    return isNaN(obj);
	  }),

	  isArray: Array.isArray || function (obj) {
	    return obj.constructor === Array;
	  },

	  isObject: function isObject(obj) {
	    return obj === Object(obj);
	  },

	  isNumber: function isNumber(obj) {
	    return obj === obj + 0;
	  },

	  isString: function isString(obj) {
	    return obj === obj + '';
	  },

	  isBoolean: function isBoolean(obj) {
	    return obj === false || obj === true;
	  },

	  isFunction: function isFunction(obj) {
	    return Object.prototype.toString.call(obj) === '[object Function]';
	  }

	};

	exports.default = Common;

/***/ },
/* 6 */
/***/ function(module, exports) {

	"use strict";

	exports.__esModule = true;
	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	var tmpComponent = void 0;

	var ColorMath = {
	  hsv_to_rgb: function hsv_to_rgb(h, s, v) {
	    var hi = Math.floor(h / 60) % 6;

	    var f = h / 60 - Math.floor(h / 60);
	    var p = v * (1.0 - s);
	    var q = v * (1.0 - f * s);
	    var t = v * (1.0 - (1.0 - f) * s);

	    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];

	    return {
	      r: c[0] * 255,
	      g: c[1] * 255,
	      b: c[2] * 255
	    };
	  },

	  rgb_to_hsv: function rgb_to_hsv(r, g, b) {
	    var min = Math.min(r, g, b);
	    var max = Math.max(r, g, b);
	    var delta = max - min;
	    var h = void 0;
	    var s = void 0;

	    if (max !== 0) {
	      s = delta / max;
	    } else {
	      return {
	        h: NaN,
	        s: 0,
	        v: 0
	      };
	    }

	    if (r === max) {
	      h = (g - b) / delta;
	    } else if (g === max) {
	      h = 2 + (b - r) / delta;
	    } else {
	      h = 4 + (r - g) / delta;
	    }
	    h /= 6;
	    if (h < 0) {
	      h += 1;
	    }

	    return {
	      h: h * 360,
	      s: s,
	      v: max / 255
	    };
	  },

	  rgb_to_hex: function rgb_to_hex(r, g, b) {
	    var hex = this.hex_with_component(0, 2, r);
	    hex = this.hex_with_component(hex, 1, g);
	    hex = this.hex_with_component(hex, 0, b);
	    return hex;
	  },

	  component_from_hex: function component_from_hex(hex, componentIndex) {
	    return hex >> componentIndex * 8 & 0xFF;
	  },

	  hex_with_component: function hex_with_component(hex, componentIndex, value) {
	    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);
	  }
	};

	exports.default = ColorMath;

/***/ },
/* 7 */
/***/ function(module, exports) {

	'use strict';

	exports.__esModule = true;

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	/**
	 * @class An "abstract" class that represents a given property of an object.
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 *
	 * @member dat.controllers
	 */
	var Controller = function () {
	  function Controller(object, property) {
	    _classCallCheck(this, Controller);

	    this.initialValue = object[property];

	    /**
	     * Those who extend this class will put their DOM elements in here.
	     * @type {DOMElement}
	     */
	    this.domElement = document.createElement('div');

	    /**
	     * The object to manipulate
	     * @type {Object}
	     */
	    this.object = object;

	    /**
	     * The name of the property to manipulate
	     * @type {String}
	     */
	    this.property = property;

	    /**
	     * The function to be called on change.
	     * @type {Function}
	     * @ignore
	     */
	    this.__onChange = undefined;

	    /**
	     * The function to be called on finishing change.
	     * @type {Function}
	     * @ignore
	     */
	    this.__onFinishChange = undefined;
	  }

	  /**
	   * Specify that a function fire every time someone changes the value with
	   * this Controller.
	   *
	   * @param {Function} fnc This function will be called whenever the value
	   * is modified via this Controller.
	   * @returns {Controller} this
	   */


	  Controller.prototype.onChange = function onChange(fnc) {
	    this.__onChange = fnc;
	    return this;
	  };

	  /**
	   * Specify that a function fire every time someone "finishes" changing
	   * the value wih this Controller. Useful for values that change
	   * incrementally like numbers or strings.
	   *
	   * @param {Function} fnc This function will be called whenever
	   * someone "finishes" changing the value via this Controller.
	   * @returns {Controller} this
	   */


	  Controller.prototype.onFinishChange = function onFinishChange(fnc) {
	    this.__onFinishChange = fnc;
	    return this;
	  };

	  /**
	   * Change the value of <code>object[property]</code>
	   *
	   * @param {Object} newValue The new value of <code>object[property]</code>
	   */


	  Controller.prototype.setValue = function setValue(newValue) {
	    this.object[this.property] = newValue;
	    if (this.__onChange) {
	      this.__onChange.call(this, newValue);
	    }

	    this.updateDisplay();
	    return this;
	  };

	  /**
	   * Gets the value of <code>object[property]</code>
	   *
	   * @returns {Object} The current value of <code>object[property]</code>
	   */


	  Controller.prototype.getValue = function getValue() {
	    return this.object[this.property];
	  };

	  /**
	   * Refreshes the visual display of a Controller in order to keep sync
	   * with the object's current value.
	   * @returns {Controller} this
	   */


	  Controller.prototype.updateDisplay = function updateDisplay() {
	    return this;
	  };

	  /**
	   * @returns {Boolean} true if the value has deviated from initialValue
	   */


	  Controller.prototype.isModified = function isModified() {
	    return this.initialValue !== this.getValue();
	  };

	  return Controller;
	}();

	exports.default = Controller;

/***/ },
/* 8 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	/**
	 * @class Provides a checkbox input to alter the boolean property of an object.
	 * @extends dat.controllers.Controller
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 *
	 * @member dat.controllers
	 */
	var BooleanController = function (_Controller) {
	  _inherits(BooleanController, _Controller);

	  function BooleanController(object, property) {
	    _classCallCheck(this, BooleanController);

	    var _this2 = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    var _this = _this2;
	    _this2.__prev = _this2.getValue();

	    _this2.__checkbox = document.createElement('input');
	    _this2.__checkbox.setAttribute('type', 'checkbox');

	    function onChange() {
	      _this.setValue(!_this.__prev);
	    }

	    _dom2.default.bind(_this2.__checkbox, 'change', onChange, false);

	    _this2.domElement.appendChild(_this2.__checkbox);

	    // Match original value
	    _this2.updateDisplay();
	    return _this2;
	  }

	  BooleanController.prototype.setValue = function setValue(v) {
	    var toReturn = _Controller.prototype.setValue.call(this, v);
	    if (this.__onFinishChange) {
	      this.__onFinishChange.call(this, this.getValue());
	    }
	    this.__prev = this.getValue();
	    return toReturn;
	  };

	  BooleanController.prototype.updateDisplay = function updateDisplay() {
	    if (this.getValue() === true) {
	      this.__checkbox.setAttribute('checked', 'checked');
	      this.__checkbox.checked = true;
	    } else {
	      this.__checkbox.checked = false;
	    }

	    return _Controller.prototype.updateDisplay.call(this);
	  };

	  return BooleanController;
	}(_Controller3.default);

	exports.default = BooleanController;

/***/ },
/* 9 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	var EVENT_MAP = {
	  HTMLEvents: ['change'],
	  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],
	  KeyboardEvents: ['keydown']
	}; /**
	    * dat-gui JavaScript Controller Library
	    * http://code.google.com/p/dat-gui
	    *
	    * Copyright 2011 Data Arts Team, Google Creative Lab
	    *
	    * Licensed under the Apache License, Version 2.0 (the "License");
	    * you may not use this file except in compliance with the License.
	    * You may obtain a copy of the License at
	    *
	    * http://www.apache.org/licenses/LICENSE-2.0
	    */

	var EVENT_MAP_INV = {};
	_common2.default.each(EVENT_MAP, function (v, k) {
	  _common2.default.each(v, function (e) {
	    EVENT_MAP_INV[e] = k;
	  });
	});

	var CSS_VALUE_PIXELS = /(\d+(\.\d+)?)px/;

	function cssValueToPixels(val) {
	  if (val === '0' || _common2.default.isUndefined(val)) {
	    return 0;
	  }

	  var match = val.match(CSS_VALUE_PIXELS);

	  if (!_common2.default.isNull(match)) {
	    return parseFloat(match[1]);
	  }

	  // TODO ...ems? %?

	  return 0;
	}

	/**
	 * @namespace
	 * @member dat.dom
	 */
	var dom = {

	  /**
	   *
	   * @param elem
	   * @param selectable
	   */
	  makeSelectable: function makeSelectable(elem, selectable) {
	    if (elem === undefined || elem.style === undefined) return;

	    elem.onselectstart = selectable ? function () {
	      return false;
	    } : function () {};

	    elem.style.MozUserSelect = selectable ? 'auto' : 'none';
	    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';
	    elem.unselectable = selectable ? 'on' : 'off';
	  },

	  /**
	   *
	   * @param elem
	   * @param horizontal
	   * @param vert
	   */
	  makeFullscreen: function makeFullscreen(elem, hor, vert) {
	    var vertical = vert;
	    var horizontal = hor;

	    if (_common2.default.isUndefined(horizontal)) {
	      horizontal = true;
	    }

	    if (_common2.default.isUndefined(vertical)) {
	      vertical = true;
	    }

	    elem.style.position = 'absolute';

	    if (horizontal) {
	      elem.style.left = 0;
	      elem.style.right = 0;
	    }
	    if (vertical) {
	      elem.style.top = 0;
	      elem.style.bottom = 0;
	    }
	  },

	  /**
	   *
	   * @param elem
	   * @param eventType
	   * @param params
	   */
	  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {
	    var params = pars || {};
	    var className = EVENT_MAP_INV[eventType];
	    if (!className) {
	      throw new Error('Event type ' + eventType + ' not supported.');
	    }
	    var evt = document.createEvent(className);
	    switch (className) {
	      case 'MouseEvents':
	        {
	          var clientX = params.x || params.clientX || 0;
	          var clientY = params.y || params.clientY || 0;
	          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0, // screen X
	          0, // screen Y
	          clientX, // client X
	          clientY, // client Y
	          false, false, false, false, 0, null);
	          break;
	        }
	      case 'KeyboardEvents':
	        {
	          var init = evt.initKeyboardEvent || evt.initKeyEvent; // webkit || moz
	          _common2.default.defaults(params, {
	            cancelable: true,
	            ctrlKey: false,
	            altKey: false,
	            shiftKey: false,
	            metaKey: false,
	            keyCode: undefined,
	            charCode: undefined
	          });
	          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);
	          break;
	        }
	      default:
	        {
	          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);
	          break;
	        }
	    }
	    _common2.default.defaults(evt, aux);
	    elem.dispatchEvent(evt);
	  },

	  /**
	   *
	   * @param elem
	   * @param event
	   * @param func
	   * @param bool
	   */
	  bind: function bind(elem, event, func, newBool) {
	    var bool = newBool || false;
	    if (elem.addEventListener) {
	      elem.addEventListener(event, func, bool);
	    } else if (elem.attachEvent) {
	      elem.attachEvent('on' + event, func);
	    }
	    return dom;
	  },

	  /**
	   *
	   * @param elem
	   * @param event
	   * @param func
	   * @param bool
	   */
	  unbind: function unbind(elem, event, func, newBool) {
	    var bool = newBool || false;
	    if (elem.removeEventListener) {
	      elem.removeEventListener(event, func, bool);
	    } else if (elem.detachEvent) {
	      elem.detachEvent('on' + event, func);
	    }
	    return dom;
	  },

	  /**
	   *
	   * @param elem
	   * @param className
	   */
	  addClass: function addClass(elem, className) {
	    if (elem.className === undefined) {
	      elem.className = className;
	    } else if (elem.className !== className) {
	      var classes = elem.className.split(/ +/);
	      if (classes.indexOf(className) === -1) {
	        classes.push(className);
	        elem.className = classes.join(' ').replace(/^\s+/, '').replace(/\s+$/, '');
	      }
	    }
	    return dom;
	  },

	  /**
	   *
	   * @param elem
	   * @param className
	   */
	  removeClass: function removeClass(elem, className) {
	    if (className) {
	      if (elem.className === className) {
	        elem.removeAttribute('class');
	      } else {
	        var classes = elem.className.split(/ +/);
	        var index = classes.indexOf(className);
	        if (index !== -1) {
	          classes.splice(index, 1);
	          elem.className = classes.join(' ');
	        }
	      }
	    } else {
	      elem.className = undefined;
	    }
	    return dom;
	  },

	  hasClass: function hasClass(elem, className) {
	    return new RegExp('(?:^|\\s+)' + className + '(?:\\s+|$)').test(elem.className) || false;
	  },

	  /**
	   *
	   * @param elem
	   */
	  getWidth: function getWidth(elem) {
	    var style = getComputedStyle(elem);

	    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);
	  },

	  /**
	   *
	   * @param elem
	   */
	  getHeight: function getHeight(elem) {
	    var style = getComputedStyle(elem);

	    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);
	  },

	  /**
	   *
	   * @param el
	   */
	  getOffset: function getOffset(el) {
	    var elem = el;
	    var offset = { left: 0, top: 0 };
	    if (elem.offsetParent) {
	      do {
	        offset.left += elem.offsetLeft;
	        offset.top += elem.offsetTop;
	        elem = elem.offsetParent;
	      } while (elem);
	    }
	    return offset;
	  },

	  // http://stackoverflow.com/posts/2684561/revisions
	  /**
	   *
	   * @param elem
	   */
	  isActive: function isActive(elem) {
	    return elem === document.activeElement && (elem.type || elem.href);
	  }

	};

	exports.default = dom;

/***/ },
/* 10 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	/**
	 * @class Provides a select input to alter the property of an object, using a
	 * list of accepted values.
	 *
	 * @extends dat.controllers.Controller
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 * @param {Object|string[]} options A map of labels to acceptable values, or
	 * a list of acceptable string values.
	 *
	 * @member dat.controllers
	 */
	var OptionController = function (_Controller) {
	  _inherits(OptionController, _Controller);

	  function OptionController(object, property, opts) {
	    _classCallCheck(this, OptionController);

	    var _this2 = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    var options = opts;

	    var _this = _this2;

	    /**
	     * The drop down menu
	     * @ignore
	     */
	    _this2.__select = document.createElement('select');

	    if (_common2.default.isArray(options)) {
	      (function () {
	        var map = {};
	        _common2.default.each(options, function (element) {
	          map[element] = element;
	        });
	        options = map;
	      })();
	    }

	    _common2.default.each(options, function (value, key) {
	      var opt = document.createElement('option');
	      opt.innerHTML = key;
	      opt.setAttribute('value', value);
	      _this.__select.appendChild(opt);
	    });

	    // Acknowledge original value
	    _this2.updateDisplay();

	    _dom2.default.bind(_this2.__select, 'change', function () {
	      var desiredValue = this.options[this.selectedIndex].value;
	      _this.setValue(desiredValue);
	    });

	    _this2.domElement.appendChild(_this2.__select);
	    return _this2;
	  }

	  OptionController.prototype.setValue = function setValue(v) {
	    var toReturn = _Controller.prototype.setValue.call(this, v);

	    if (this.__onFinishChange) {
	      this.__onFinishChange.call(this, this.getValue());
	    }
	    return toReturn;
	  };

	  OptionController.prototype.updateDisplay = function updateDisplay() {
	    if (_dom2.default.isActive(this.__select)) return this; // prevent number from updating if user is trying to manually update
	    this.__select.value = this.getValue();
	    return _Controller.prototype.updateDisplay.call(this);
	  };

	  return OptionController;
	}(_Controller3.default);

	exports.default = OptionController;

/***/ },
/* 11 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	/**
	 * @class Provides a text input to alter the string property of an object.
	 *
	 * @extends dat.controllers.Controller
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 *
	 * @member dat.controllers
	 */
	var StringController = function (_Controller) {
	  _inherits(StringController, _Controller);

	  function StringController(object, property) {
	    _classCallCheck(this, StringController);

	    var _this2 = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    var _this = _this2;

	    function onChange() {
	      _this.setValue(_this.__input.value);
	    }

	    function onBlur() {
	      if (_this.__onFinishChange) {
	        _this.__onFinishChange.call(_this, _this.getValue());
	      }
	    }

	    _this2.__input = document.createElement('input');
	    _this2.__input.setAttribute('type', 'text');

	    _dom2.default.bind(_this2.__input, 'keyup', onChange);
	    _dom2.default.bind(_this2.__input, 'change', onChange);
	    _dom2.default.bind(_this2.__input, 'blur', onBlur);
	    _dom2.default.bind(_this2.__input, 'keydown', function (e) {
	      if (e.keyCode === 13) {
	        this.blur();
	      }
	    });

	    _this2.updateDisplay();

	    _this2.domElement.appendChild(_this2.__input);
	    return _this2;
	  }

	  StringController.prototype.updateDisplay = function updateDisplay() {
	    // Stops the caret from moving on account of:
	    // keyup -> setValue -> updateDisplay
	    if (!_dom2.default.isActive(this.__input)) {
	      this.__input.value = this.getValue();
	    }
	    return _Controller.prototype.updateDisplay.call(this);
	  };

	  return StringController;
	}(_Controller3.default);

	exports.default = StringController;

/***/ },
/* 12 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	function numDecimals(x) {
	  var _x = x.toString();
	  if (_x.indexOf('.') > -1) {
	    return _x.length - _x.indexOf('.') - 1;
	  }

	  return 0;
	}

	/**
	 * @class Represents a given property of an object that is a number.
	 *
	 * @extends dat.controllers.Controller
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 * @param {Object} [params] Optional parameters
	 * @param {Number} [params.min] Minimum allowed value
	 * @param {Number} [params.max] Maximum allowed value
	 * @param {Number} [params.step] Increment by which to change value
	 *
	 * @member dat.controllers
	 */

	var NumberController = function (_Controller) {
	  _inherits(NumberController, _Controller);

	  function NumberController(object, property, params) {
	    _classCallCheck(this, NumberController);

	    var _this = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    var _params = params || {};

	    _this.__min = _params.min;
	    _this.__max = _params.max;
	    _this.__step = _params.step;

	    if (_common2.default.isUndefined(_this.__step)) {
	      if (_this.initialValue === 0) {
	        _this.__impliedStep = 1; // What are we, psychics?
	      } else {
	        // Hey Doug, check this out.
	        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;
	      }
	    } else {
	      _this.__impliedStep = _this.__step;
	    }

	    _this.__precision = numDecimals(_this.__impliedStep);
	    return _this;
	  }

	  NumberController.prototype.setValue = function setValue(v) {
	    var _v = v;

	    if (this.__min !== undefined && _v < this.__min) {
	      _v = this.__min;
	    } else if (this.__max !== undefined && _v > this.__max) {
	      _v = this.__max;
	    }

	    if (this.__step !== undefined && _v % this.__step !== 0) {
	      _v = Math.round(_v / this.__step) * this.__step;
	    }

	    return _Controller.prototype.setValue.call(this, _v);
	  };

	  /**
	   * Specify a minimum value for <code>object[property]</code>.
	   *
	   * @param {Number} minValue The minimum value for
	   * <code>object[property]</code>
	   * @returns {dat.controllers.NumberController} this
	   */


	  NumberController.prototype.min = function min(v) {
	    this.__min = v;
	    return this;
	  };

	  /**
	   * Specify a maximum value for <code>object[property]</code>.
	   *
	   * @param {Number} maxValue The maximum value for
	   * <code>object[property]</code>
	   * @returns {dat.controllers.NumberController} this
	   */


	  NumberController.prototype.max = function max(v) {
	    this.__max = v;
	    return this;
	  };

	  /**
	   * Specify a step value that dat.controllers.NumberController
	   * increments by.
	   *
	   * @param {Number} stepValue The step value for
	   * dat.controllers.NumberController
	   * @default if minimum and maximum specified increment is 1% of the
	   * difference otherwise stepValue is 1
	   * @returns {dat.controllers.NumberController} this
	   */


	  NumberController.prototype.step = function step(v) {
	    this.__step = v;
	    this.__impliedStep = v;
	    this.__precision = numDecimals(v);
	    return this;
	  };

	  return NumberController;
	}(_Controller3.default);

	exports.default = NumberController;

/***/ },
/* 13 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _NumberController2 = __webpack_require__(12);

	var _NumberController3 = _interopRequireDefault(_NumberController2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	function roundToDecimal(value, decimals) {
	  var tenTo = Math.pow(10, decimals);
	  return Math.round(value * tenTo) / tenTo;
	}

	/**
	 * @class Represents a given property of an object that is a number and
	 * provides an input element with which to manipulate it.
	 *
	 * @extends dat.controllers.Controller
	 * @extends dat.controllers.NumberController
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 * @param {Object} [params] Optional parameters
	 * @param {Number} [params.min] Minimum allowed value
	 * @param {Number} [params.max] Maximum allowed value
	 * @param {Number} [params.step] Increment by which to change value
	 *
	 * @member dat.controllers
	 */

	var NumberControllerBox = function (_NumberController) {
	  _inherits(NumberControllerBox, _NumberController);

	  function NumberControllerBox(object, property, params) {
	    _classCallCheck(this, NumberControllerBox);

	    var _this2 = _possibleConstructorReturn(this, _NumberController.call(this, object, property, params));

	    _this2.__truncationSuspended = false;

	    var _this = _this2;

	    /**
	     * {Number} Previous mouse y position
	     * @ignore
	     */
	    var prevY = void 0;

	    function onChange() {
	      var attempted = parseFloat(_this.__input.value);
	      if (!_common2.default.isNaN(attempted)) {
	        _this.setValue(attempted);
	      }
	    }

	    function onFinish() {
	      if (_this.__onFinishChange) {
	        _this.__onFinishChange.call(_this, _this.getValue());
	      }
	    }

	    function onBlur() {
	      onFinish();
	    }

	    function onMouseDrag(e) {
	      var diff = prevY - e.clientY;
	      _this.setValue(_this.getValue() + diff * _this.__impliedStep);

	      prevY = e.clientY;
	    }

	    function onMouseUp() {
	      _dom2.default.unbind(document, 'mousemove', onMouseDrag);
	      _dom2.default.unbind(document, 'mouseup', onMouseUp);
	      onFinish();
	    }

	    function onMouseDown(e) {
	      _dom2.default.bind(document, 'mousemove', onMouseDrag);
	      _dom2.default.bind(document, 'mouseup', onMouseUp);
	      prevY = e.clientY;
	    }

	    _this2.__input = document.createElement('input');
	    _this2.__input.setAttribute('type', 'text');

	    // Makes it so manually specified values are not truncated.

	    _dom2.default.bind(_this2.__input, 'change', onChange);
	    _dom2.default.bind(_this2.__input, 'blur', onBlur);
	    _dom2.default.bind(_this2.__input, 'mousedown', onMouseDown);
	    _dom2.default.bind(_this2.__input, 'keydown', function (e) {
	      // When pressing enter, you can be as precise as you want.
	      if (e.keyCode === 13) {
	        _this.__truncationSuspended = true;
	        this.blur();
	        _this.__truncationSuspended = false;
	        onFinish();
	      }
	    });

	    _this2.updateDisplay();

	    _this2.domElement.appendChild(_this2.__input);
	    return _this2;
	  }

	  NumberControllerBox.prototype.updateDisplay = function updateDisplay() {
	    this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);
	    return _NumberController.prototype.updateDisplay.call(this);
	  };

	  return NumberControllerBox;
	}(_NumberController3.default);

	exports.default = NumberControllerBox;

/***/ },
/* 14 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _NumberController2 = __webpack_require__(12);

	var _NumberController3 = _interopRequireDefault(_NumberController2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	function map(v, i1, i2, o1, o2) {
	  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));
	}

	/**
	 * @class Represents a given property of an object that is a number, contains
	 * a minimum and maximum, and provides a slider element with which to
	 * manipulate it. It should be noted that the slider element is made up of
	 * <code>&lt;div&gt;</code> tags, <strong>not</strong> the html5
	 * <code>&lt;slider&gt;</code> element.
	 *
	 * @extends dat.controllers.Controller
	 * @extends dat.controllers.NumberController
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 * @param {Number} minValue Minimum allowed value
	 * @param {Number} maxValue Maximum allowed value
	 * @param {Number} stepValue Increment by which to change value
	 *
	 * @member dat.controllers
	 */

	var NumberControllerSlider = function (_NumberController) {
	  _inherits(NumberControllerSlider, _NumberController);

	  function NumberControllerSlider(object, property, min, max, step) {
	    _classCallCheck(this, NumberControllerSlider);

	    var _this2 = _possibleConstructorReturn(this, _NumberController.call(this, object, property, { min: min, max: max, step: step }));

	    var _this = _this2;

	    _this2.__background = document.createElement('div');
	    _this2.__foreground = document.createElement('div');

	    _dom2.default.bind(_this2.__background, 'mousedown', onMouseDown);

	    _dom2.default.addClass(_this2.__background, 'slider');
	    _dom2.default.addClass(_this2.__foreground, 'slider-fg');

	    function onMouseDown(e) {
	      document.activeElement.blur();

	      _dom2.default.bind(document, 'mousemove', onMouseDrag);
	      _dom2.default.bind(document, 'mouseup', onMouseUp);

	      onMouseDrag(e);
	    }

	    function onMouseDrag(e) {
	      e.preventDefault();

	      var bgRect = _this.__background.getBoundingClientRect();

	      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));

	      return false;
	    }

	    function onMouseUp() {
	      _dom2.default.unbind(document, 'mousemove', onMouseDrag);
	      _dom2.default.unbind(document, 'mouseup', onMouseUp);
	      if (_this.__onFinishChange) {
	        _this.__onFinishChange.call(_this, _this.getValue());
	      }
	    }

	    _this2.updateDisplay();

	    _this2.__background.appendChild(_this2.__foreground);
	    _this2.domElement.appendChild(_this2.__background);
	    return _this2;
	  }

	  NumberControllerSlider.prototype.updateDisplay = function updateDisplay() {
	    var pct = (this.getValue() - this.__min) / (this.__max - this.__min);
	    this.__foreground.style.width = pct * 100 + '%';
	    return _NumberController.prototype.updateDisplay.call(this);
	  };

	  return NumberControllerSlider;
	}(_NumberController3.default);

	exports.default = NumberControllerSlider;

/***/ },
/* 15 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	/**
	 * @class Provides a GUI interface to fire a specified method, a property of an object.
	 *
	 * @extends dat.controllers.Controller
	 *
	 * @param {Object} object The object to be manipulated
	 * @param {string} property The name of the property to be manipulated
	 *
	 * @member dat.controllers
	 */
	var FunctionController = function (_Controller) {
	  _inherits(FunctionController, _Controller);

	  function FunctionController(object, property, text) {
	    _classCallCheck(this, FunctionController);

	    var _this2 = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    var _this = _this2;

	    _this2.__button = document.createElement('div');
	    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;

	    _dom2.default.bind(_this2.__button, 'click', function (e) {
	      e.preventDefault();
	      _this.fire();
	      return false;
	    });

	    _dom2.default.addClass(_this2.__button, 'button');

	    _this2.domElement.appendChild(_this2.__button);
	    return _this2;
	  }

	  FunctionController.prototype.fire = function fire() {
	    if (this.__onChange) {
	      this.__onChange.call(this);
	    }
	    this.getValue().call(this.object);
	    if (this.__onFinishChange) {
	      this.__onFinishChange.call(this, this.getValue());
	    }
	  };

	  return FunctionController;
	}(_Controller3.default);

	exports.default = FunctionController;

/***/ },
/* 16 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _Controller2 = __webpack_require__(7);

	var _Controller3 = _interopRequireDefault(_Controller2);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _Color = __webpack_require__(2);

	var _Color2 = _interopRequireDefault(_Color);

	var _interpret = __webpack_require__(3);

	var _interpret2 = _interopRequireDefault(_interpret);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

	function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

	function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */

	var ColorController = function (_Controller) {
	  _inherits(ColorController, _Controller);

	  function ColorController(object, property) {
	    _classCallCheck(this, ColorController);

	    var _this2 = _possibleConstructorReturn(this, _Controller.call(this, object, property));

	    _this2.__color = new _Color2.default(_this2.getValue());
	    _this2.__temp = new _Color2.default(0);

	    var _this = _this2;

	    _this2.domElement = document.createElement('div');

	    _dom2.default.makeSelectable(_this2.domElement, false);

	    _this2.__selector = document.createElement('div');
	    _this2.__selector.className = 'selector';

	    _this2.__saturation_field = document.createElement('div');
	    _this2.__saturation_field.className = 'saturation-field';

	    _this2.__field_knob = document.createElement('div');
	    _this2.__field_knob.className = 'field-knob';
	    _this2.__field_knob_border = '2px solid ';

	    _this2.__hue_knob = document.createElement('div');
	    _this2.__hue_knob.className = 'hue-knob';

	    _this2.__hue_field = document.createElement('div');
	    _this2.__hue_field.className = 'hue-field';

	    _this2.__input = document.createElement('input');
	    _this2.__input.type = 'text';
	    _this2.__input_textShadow = '0 1px 1px ';

	    _dom2.default.bind(_this2.__input, 'keydown', function (e) {
	      if (e.keyCode === 13) {
	        // on enter
	        onBlur.call(this);
	      }
	    });

	    _dom2.default.bind(_this2.__input, 'blur', onBlur);

	    _dom2.default.bind(_this2.__selector, 'mousedown', function () /* e */{
	      _dom2.default.addClass(this, 'drag').bind(document, 'mouseup', function () /* e */{
	        _dom2.default.removeClass(_this.__selector, 'drag');
	      });
	    });

	    var valueField = document.createElement('div');

	    _common2.default.extend(_this2.__selector.style, {
	      width: '122px',
	      height: '102px',
	      padding: '3px',
	      backgroundColor: '#222',
	      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'
	    });

	    _common2.default.extend(_this2.__field_knob.style, {
	      position: 'absolute',
	      width: '12px',
	      height: '12px',
	      border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),
	      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',
	      borderRadius: '12px',
	      zIndex: 1
	    });

	    _common2.default.extend(_this2.__hue_knob.style, {
	      position: 'absolute',
	      width: '15px',
	      height: '2px',
	      borderRight: '4px solid #fff',
	      zIndex: 1
	    });

	    _common2.default.extend(_this2.__saturation_field.style, {
	      width: '100px',
	      height: '100px',
	      border: '1px solid #555',
	      marginRight: '3px',
	      display: 'inline-block',
	      cursor: 'pointer'
	    });

	    _common2.default.extend(valueField.style, {
	      width: '100%',
	      height: '100%',
	      background: 'none'
	    });

	    linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');

	    _common2.default.extend(_this2.__hue_field.style, {
	      width: '15px',
	      height: '100px',
	      border: '1px solid #555',
	      cursor: 'ns-resize',
	      position: 'absolute',
	      top: '3px',
	      right: '3px'
	    });

	    hueGradient(_this2.__hue_field);

	    _common2.default.extend(_this2.__input.style, {
	      outline: 'none',
	      //      width: '120px',
	      textAlign: 'center',
	      //      padding: '4px',
	      //      marginBottom: '6px',
	      color: '#fff',
	      border: 0,
	      fontWeight: 'bold',
	      textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'
	    });

	    _dom2.default.bind(_this2.__saturation_field, 'mousedown', fieldDown);
	    _dom2.default.bind(_this2.__field_knob, 'mousedown', fieldDown);

	    _dom2.default.bind(_this2.__hue_field, 'mousedown', function (e) {
	      setH(e);
	      _dom2.default.bind(document, 'mousemove', setH);
	      _dom2.default.bind(document, 'mouseup', fieldUpH);
	    });

	    function fieldDown(e) {
	      setSV(e);
	      // document.body.style.cursor = 'none';
	      _dom2.default.bind(document, 'mousemove', setSV);
	      _dom2.default.bind(document, 'mouseup', fieldUpSV);
	    }

	    function fieldUpSV() {
	      _dom2.default.unbind(document, 'mousemove', setSV);
	      _dom2.default.unbind(document, 'mouseup', fieldUpSV);
	      // document.body.style.cursor = 'default';
	      onFinish();
	    }

	    function onBlur() {
	      var i = (0, _interpret2.default)(this.value);
	      if (i !== false) {
	        _this.__color.__state = i;
	        _this.setValue(_this.__color.toOriginal());
	      } else {
	        this.value = _this.__color.toString();
	      }
	    }

	    function fieldUpH() {
	      _dom2.default.unbind(document, 'mousemove', setH);
	      _dom2.default.unbind(document, 'mouseup', fieldUpH);
	      onFinish();
	    }

	    function onFinish() {
	      if (_this.__onFinishChange) {
	        _this.__onFinishChange.call(_this, _this.__color.toOriginal());
	      }
	    }

	    _this2.__saturation_field.appendChild(valueField);
	    _this2.__selector.appendChild(_this2.__field_knob);
	    _this2.__selector.appendChild(_this2.__saturation_field);
	    _this2.__selector.appendChild(_this2.__hue_field);
	    _this2.__hue_field.appendChild(_this2.__hue_knob);

	    _this2.domElement.appendChild(_this2.__input);
	    _this2.domElement.appendChild(_this2.__selector);

	    _this2.updateDisplay();

	    function setSV(e) {
	      e.preventDefault();

	      var fieldRect = _this.__saturation_field.getBoundingClientRect();
	      var s = (e.clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);
	      var v = 1 - (e.clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);

	      if (v > 1) {
	        v = 1;
	      } else if (v < 0) {
	        v = 0;
	      }

	      if (s > 1) {
	        s = 1;
	      } else if (s < 0) {
	        s = 0;
	      }

	      _this.__color.v = v;
	      _this.__color.s = s;

	      _this.setValue(_this.__color.toOriginal());

	      return false;
	    }

	    function setH(e) {
	      e.preventDefault();

	      var fieldRect = _this.__hue_field.getBoundingClientRect();
	      var h = 1 - (e.clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);

	      if (h > 1) {
	        h = 1;
	      } else if (h < 0) {
	        h = 0;
	      }

	      _this.__color.h = h * 360;

	      _this.setValue(_this.__color.toOriginal());

	      return false;
	    }
	    return _this2;
	  }

	  ColorController.prototype.updateDisplay = function updateDisplay() {
	    var i = (0, _interpret2.default)(this.getValue());

	    if (i !== false) {
	      var mismatch = false;

	      // Check for mismatch on the interpreted value.

	      _common2.default.each(_Color2.default.COMPONENTS, function (component) {
	        if (!_common2.default.isUndefined(i[component]) && !_common2.default.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {
	          mismatch = true;
	          return {}; // break
	        }
	      }, this);

	      // If nothing diverges, we keep our previous values
	      // for statefulness, otherwise we recalculate fresh
	      if (mismatch) {
	        _common2.default.extend(this.__color.__state, i);
	      }
	    }

	    _common2.default.extend(this.__temp.__state, this.__color.__state);

	    this.__temp.a = 1;

	    var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;
	    var _flip = 255 - flip;

	    _common2.default.extend(this.__field_knob.style, {
	      marginLeft: 100 * this.__color.s - 7 + 'px',
	      marginTop: 100 * (1 - this.__color.v) - 7 + 'px',
	      backgroundColor: this.__temp.toHexString(),
	      border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'
	    });

	    this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';

	    this.__temp.s = 1;
	    this.__temp.v = 1;

	    linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());

	    this.__input.value = this.__color.toString();

	    _common2.default.extend(this.__input.style, {
	      backgroundColor: this.__color.toHexString(),
	      color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',
	      textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'
	    });
	  };

	  return ColorController;
	}(_Controller3.default);

	var vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];

	function linearGradient(elem, x, a, b) {
	  elem.style.background = '';
	  _common2.default.each(vendors, function (vendor) {
	    elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';
	  });
	}

	function hueGradient(elem) {
	  elem.style.background = '';
	  elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';
	  elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';
	  elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';
	  elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';
	  elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';
	}

	exports.default = ColorController;

/***/ },
/* 17 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; }; /**
	                                                                                                                                                                                                                                                   * dat-gui JavaScript Controller Library
	                                                                                                                                                                                                                                                   * http://code.google.com/p/dat-gui
	                                                                                                                                                                                                                                                   *
	                                                                                                                                                                                                                                                   * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                                                                                                                   *
	                                                                                                                                                                                                                                                   * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                                                                                                                   * you may not use this file except in compliance with the License.
	                                                                                                                                                                                                                                                   * You may obtain a copy of the License at
	                                                                                                                                                                                                                                                   *
	                                                                                                                                                                                                                                                   * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                                                                                                                   */

	var _css = __webpack_require__(18);

	var _css2 = _interopRequireDefault(_css);

	var _saveDialogue = __webpack_require__(19);

	var _saveDialogue2 = _interopRequireDefault(_saveDialogue);

	var _ControllerFactory = __webpack_require__(20);

	var _ControllerFactory2 = _interopRequireDefault(_ControllerFactory);

	var _Controller = __webpack_require__(7);

	var _Controller2 = _interopRequireDefault(_Controller);

	var _BooleanController = __webpack_require__(8);

	var _BooleanController2 = _interopRequireDefault(_BooleanController);

	var _FunctionController = __webpack_require__(15);

	var _FunctionController2 = _interopRequireDefault(_FunctionController);

	var _NumberControllerBox = __webpack_require__(13);

	var _NumberControllerBox2 = _interopRequireDefault(_NumberControllerBox);

	var _NumberControllerSlider = __webpack_require__(14);

	var _NumberControllerSlider2 = _interopRequireDefault(_NumberControllerSlider);

	var _ColorController = __webpack_require__(16);

	var _ColorController2 = _interopRequireDefault(_ColorController);

	var _requestAnimationFrame = __webpack_require__(21);

	var _requestAnimationFrame2 = _interopRequireDefault(_requestAnimationFrame);

	var _CenteredDiv = __webpack_require__(22);

	var _CenteredDiv2 = _interopRequireDefault(_CenteredDiv);

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	var _style = __webpack_require__(23);

	var _style2 = _interopRequireDefault(_style);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	// CSS to embed in build

	_css2.default.inject(_style2.default);

	/** Outer-most className for GUI's */
	var CSS_NAMESPACE = 'dg';

	var HIDE_KEY_CODE = 72;

	/** The only value shared between the JS and SCSS. Use caution. */
	var CLOSE_BUTTON_HEIGHT = 20;

	var DEFAULT_DEFAULT_PRESET_NAME = 'Default';

	var SUPPORTS_LOCAL_STORAGE = function () {
	  try {
	    return 'localStorage' in window && window.localStorage !== null;
	  } catch (e) {
	    return false;
	  }
	}();

	var SAVE_DIALOGUE = void 0;

	/** Have we yet to create an autoPlace GUI? */
	var autoPlaceVirgin = true;

	/** Fixed position div that auto place GUI's go inside */
	var autoPlaceContainer = void 0;

	/** Are we hiding the GUI's ? */
	var hide = false;

	/** GUI's which should be hidden */
	var hideableGuis = [];

	/**
	 * A lightweight controller library for JavaScript. It allows you to easily
	 * manipulate variables and fire functions on the fly.
	 * @class
	 *
	 * @member dat.gui
	 *
	 * @param {Object} [params]
	 * @param {String} [params.name] The name of this GUI.
	 * @param {Object} [params.load] JSON object representing the saved state of
	 * this GUI.
	 * @param {Boolean} [params.auto=true]
	 * @param {dat.gui.GUI} [params.parent] The GUI I'm nested in.
	 * @param {Boolean} [params.closed] If true, starts closed
	 */
	var GUI = function GUI(pars) {
	  var _this = this;

	  var params = pars || {};

	  /**
	   * Outermost DOM Element
	   * @type DOMElement
	   */
	  this.domElement = document.createElement('div');
	  this.__ul = document.createElement('ul');
	  this.domElement.appendChild(this.__ul);

	  _dom2.default.addClass(this.domElement, CSS_NAMESPACE);

	  /**
	   * Nested GUI's by name
	   * @ignore
	   */
	  this.__folders = {};

	  this.__controllers = [];

	  /**
	   * List of objects I'm remembering for save, only used in top level GUI
	   * @ignore
	   */
	  this.__rememberedObjects = [];

	  /**
	   * Maps the index of remembered objects to a map of controllers, only used
	   * in top level GUI.
	   *
	   * @private
	   * @ignore
	   *
	   * @example
	   * [
	   *  {
	     *    propertyName: Controller,
	     *    anotherPropertyName: Controller
	     *  },
	   *  {
	     *    propertyName: Controller
	     *  }
	   * ]
	   */
	  this.__rememberedObjectIndecesToControllers = [];

	  this.__listening = [];

	  // Default parameters
	  params = _common2.default.defaults(params, {
	    autoPlace: true,
	    width: GUI.DEFAULT_WIDTH
	  });

	  params = _common2.default.defaults(params, {
	    resizable: params.autoPlace,
	    hideable: params.autoPlace
	  });

	  if (!_common2.default.isUndefined(params.load)) {
	    // Explicit preset
	    if (params.preset) {
	      params.load.preset = params.preset;
	    }
	  } else {
	    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };
	  }

	  if (_common2.default.isUndefined(params.parent) && params.hideable) {
	    hideableGuis.push(this);
	  }

	  // Only root level GUI's are resizable.
	  params.resizable = _common2.default.isUndefined(params.parent) && params.resizable;

	  if (params.autoPlace && _common2.default.isUndefined(params.scrollable)) {
	    params.scrollable = true;
	  }
	  //    params.scrollable = common.isUndefined(params.parent) && params.scrollable === true;

	  // Not part of params because I don't want people passing this in via
	  // constructor. Should be a 'remembered' value.
	  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';

	  var saveToLocalStorage = void 0;

	  Object.defineProperties(this,
	  /** @lends dat.gui.GUI.prototype */
	  {
	    /**
	     * The parent <code>GUI</code>
	     * @type dat.gui.GUI
	     */
	    parent: {
	      get: function get() {
	        return params.parent;
	      }
	    },

	    scrollable: {
	      get: function get() {
	        return params.scrollable;
	      }
	    },

	    /**
	     * Handles <code>GUI</code>'s element placement for you
	     * @type Boolean
	     */
	    autoPlace: {
	      get: function get() {
	        return params.autoPlace;
	      }
	    },

	    /**
	     * The identifier for a set of saved values
	     * @type String
	     */
	    preset: {
	      get: function get() {
	        if (_this.parent) {
	          return _this.getRoot().preset;
	        }

	        return params.load.preset;
	      },

	      set: function set(v) {
	        if (_this.parent) {
	          _this.getRoot().preset = v;
	        } else {
	          params.load.preset = v;
	        }
	        setPresetSelectIndex(this);
	        _this.revert();
	      }
	    },

	    /**
	     * The width of <code>GUI</code> element
	     * @type Number
	     */
	    width: {
	      get: function get() {
	        return params.width;
	      },
	      set: function set(v) {
	        params.width = v;
	        setWidth(_this, v);
	      }
	    },

	    /**
	     * The name of <code>GUI</code>. Used for folders. i.e
	     * a folder's name
	     * @type String
	     */
	    name: {
	      get: function get() {
	        return params.name;
	      },
	      set: function set(v) {
	        // TODO Check for collisions among sibling folders
	        params.name = v;
	        if (titleRowName) {
	          titleRowName.innerHTML = params.name;
	        }
	      }
	    },

	    /**
	     * Whether the <code>GUI</code> is collapsed or not
	     * @type Boolean
	     */
	    closed: {
	      get: function get() {
	        return params.closed;
	      },
	      set: function set(v) {
	        params.closed = v;
	        if (params.closed) {
	          _dom2.default.addClass(_this.__ul, GUI.CLASS_CLOSED);
	        } else {
	          _dom2.default.removeClass(_this.__ul, GUI.CLASS_CLOSED);
	        }
	        // For browsers that aren't going to respect the CSS transition,
	        // Lets just check our height against the window height right off
	        // the bat.
	        this.onResize();

	        if (_this.__closeButton) {
	          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;
	        }
	      }
	    },

	    /**
	     * Contains all presets
	     * @type Object
	     */
	    load: {
	      get: function get() {
	        return params.load;
	      }
	    },

	    /**
	     * Determines whether or not to use <a href="https://developer.mozilla.org/en/DOM/Storage#localStorage">localStorage</a> as the means for
	     * <code>remember</code>ing
	     * @type Boolean
	     */
	    useLocalStorage: {

	      get: function get() {
	        return useLocalStorage;
	      },
	      set: function set(bool) {
	        if (SUPPORTS_LOCAL_STORAGE) {
	          useLocalStorage = bool;
	          if (bool) {
	            _dom2.default.bind(window, 'unload', saveToLocalStorage);
	          } else {
	            _dom2.default.unbind(window, 'unload', saveToLocalStorage);
	          }
	          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);
	        }
	      }
	    }
	  });

	  // Are we a root level GUI?
	  if (_common2.default.isUndefined(params.parent)) {
	    params.closed = false;

	    _dom2.default.addClass(this.domElement, GUI.CLASS_MAIN);
	    _dom2.default.makeSelectable(this.domElement, false);

	    // Are we supposed to be loading locally?
	    if (SUPPORTS_LOCAL_STORAGE) {
	      if (useLocalStorage) {
	        _this.useLocalStorage = true;

	        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));

	        if (savedGui) {
	          params.load = JSON.parse(savedGui);
	        }
	      }
	    }

	    this.__closeButton = document.createElement('div');
	    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;
	    _dom2.default.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);
	    this.domElement.appendChild(this.__closeButton);

	    _dom2.default.bind(this.__closeButton, 'click', function () {
	      _this.closed = !_this.closed;
	    });
	    // Oh, you're a nested GUI!
	  } else {
	    if (params.closed === undefined) {
	      params.closed = true;
	    }

	    var _titleRowName = document.createTextNode(params.name);
	    _dom2.default.addClass(_titleRowName, 'controller-name');

	    var titleRow = addRow(_this, _titleRowName);

	    var onClickTitle = function onClickTitle(e) {
	      e.preventDefault();
	      _this.closed = !_this.closed;
	      return false;
	    };

	    _dom2.default.addClass(this.__ul, GUI.CLASS_CLOSED);

	    _dom2.default.addClass(titleRow, 'title');
	    _dom2.default.bind(titleRow, 'click', onClickTitle);

	    if (!params.closed) {
	      this.closed = false;
	    }
	  }

	  if (params.autoPlace) {
	    if (_common2.default.isUndefined(params.parent)) {
	      if (autoPlaceVirgin) {
	        autoPlaceContainer = document.createElement('div');
	        _dom2.default.addClass(autoPlaceContainer, CSS_NAMESPACE);
	        _dom2.default.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);
	        document.body.appendChild(autoPlaceContainer);
	        autoPlaceVirgin = false;
	      }

	      // Put it in the dom for you.
	      autoPlaceContainer.appendChild(this.domElement);

	      // Apply the auto styles
	      _dom2.default.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);
	    }

	    // Make it not elastic.
	    if (!this.parent) {
	      setWidth(_this, params.width);
	    }
	  }

	  this.__resizeHandler = function () {
	    _this.onResizeDebounced();
	  };

	  _dom2.default.bind(window, 'resize', this.__resizeHandler);
	  _dom2.default.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);
	  _dom2.default.bind(this.__ul, 'transitionend', this.__resizeHandler);
	  _dom2.default.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);
	  this.onResize();

	  if (params.resizable) {
	    addResizeHandle(this);
	  }

	  saveToLocalStorage = function saveToLocalStorage() {
	    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {
	      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));
	    }
	  };

	  // expose this method publicly
	  this.saveToLocalStorageIfPossible = saveToLocalStorage;

	  function resetWidth() {
	    var root = _this.getRoot();
	    root.width += 1;
	    _common2.default.defer(function () {
	      root.width -= 1;
	    });
	  }

	  if (!params.parent) {
	    resetWidth();
	  }
	};

	GUI.toggleHide = function () {
	  hide = !hide;
	  _common2.default.each(hideableGuis, function (gui) {
	    gui.domElement.style.display = hide ? 'none' : '';
	  });
	};

	GUI.CLASS_AUTO_PLACE = 'a';
	GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';
	GUI.CLASS_MAIN = 'main';
	GUI.CLASS_CONTROLLER_ROW = 'cr';
	GUI.CLASS_TOO_TALL = 'taller-than-window';
	GUI.CLASS_CLOSED = 'closed';
	GUI.CLASS_CLOSE_BUTTON = 'close-button';
	GUI.CLASS_DRAG = 'drag';

	GUI.DEFAULT_WIDTH = 245;
	GUI.TEXT_CLOSED = 'Close Controls';
	GUI.TEXT_OPEN = 'Open Controls';

	GUI._keydownHandler = function (e) {
	  if (document.activeElement && document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {
	    GUI.toggleHide();
	  }
	};
	_dom2.default.bind(window, 'keydown', GUI._keydownHandler, false);

	_common2.default.extend(GUI.prototype,

	/** @lends dat.gui.GUI */
	{

	  /**
	   * @param object
	   * @param property
	   * @returns {dat.controllers.Controller} The new controller that was added.
	   * @instance
	   */
	  add: function add(object, property) {
	    return _add(this, object, property, {
	      factoryArgs: Array.prototype.slice.call(arguments, 2)
	    });
	  },

	  /**
	   * @param object
	   * @param property
	   * @returns {dat.controllers.ColorController} The new controller that was added.
	   * @instance
	   */
	  addColor: function addColor(object, property) {
	    return _add(this, object, property, {
	      color: true
	    });
	  },

	  /**
	   * @param controller
	   * @instance
	   */
	  remove: function remove(controller) {
	    // TODO listening?
	    this.__ul.removeChild(controller.__li);
	    this.__controllers.splice(this.__controllers.indexOf(controller), 1);
	    var _this = this;
	    _common2.default.defer(function () {
	      _this.onResize();
	    });
	  },

	  destroy: function destroy() {
	    if (this.autoPlace) {
	      autoPlaceContainer.removeChild(this.domElement);
	    }

	    _dom2.default.unbind(window, 'keydown', GUI._keydownHandler, false);
	    _dom2.default.unbind(window, 'resize', this.__resizeHandler);

	    if (this.saveToLocalStorageIfPossible) {
	      _dom2.default.unbind(window, 'unload', this.saveToLocalStorageIfPossible);
	    }
	  },

	  /**
	   * @param name
	   * @returns {dat.gui.GUI} The new folder.
	   * @throws {Error} if this GUI already has a folder by the specified
	   * name
	   * @instance
	   */
	  addFolder: function addFolder(name) {
	    // We have to prevent collisions on names in order to have a key
	    // by which to remember saved values
	    if (this.__folders[name] !== undefined) {
	      throw new Error('You already have a folder in this GUI by the' + ' name "' + name + '"');
	    }

	    var newGuiParams = { name: name, parent: this };

	    // We need to pass down the autoPlace trait so that we can
	    // attach event listeners to open/close folder actions to
	    // ensure that a scrollbar appears if the window is too short.
	    newGuiParams.autoPlace = this.autoPlace;

	    // Do we have saved appearance data for this folder?
	    if (this.load && // Anything loaded?
	    this.load.folders && // Was my parent a dead-end?
	    this.load.folders[name]) {
	      // Did daddy remember me?
	      // Start me closed if I was closed
	      newGuiParams.closed = this.load.folders[name].closed;

	      // Pass down the loaded data
	      newGuiParams.load = this.load.folders[name];
	    }

	    var gui = new GUI(newGuiParams);
	    this.__folders[name] = gui;

	    var li = addRow(this, gui.domElement);
	    _dom2.default.addClass(li, 'folder');
	    return gui;
	  },

	  open: function open() {
	    this.closed = false;
	  },

	  close: function close() {
	    this.closed = true;
	  },

	  onResize: function onResize() {
	    // we debounce this function to prevent performance issues when rotating on tablet/mobile
	    var root = this.getRoot();
	    if (root.scrollable) {
	      var top = _dom2.default.getOffset(root.__ul).top;
	      var h = 0;

	      _common2.default.each(root.__ul.childNodes, function (node) {
	        if (!(root.autoPlace && node === root.__save_row)) {
	          h += _dom2.default.getHeight(node);
	        }
	      });

	      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {
	        _dom2.default.addClass(root.domElement, GUI.CLASS_TOO_TALL);
	        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';
	      } else {
	        _dom2.default.removeClass(root.domElement, GUI.CLASS_TOO_TALL);
	        root.__ul.style.height = 'auto';
	      }
	    }

	    if (root.__resize_handle) {
	      _common2.default.defer(function () {
	        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';
	      });
	    }

	    if (root.__closeButton) {
	      root.__closeButton.style.width = root.width + 'px';
	    }
	  },

	  onResizeDebounced: _common2.default.debounce(function () {
	    this.onResize();
	  }, 200),

	  /**
	   * Mark objects for saving. The order of these objects cannot change as
	   * the GUI grows. When remembering new objects, append them to the end
	   * of the list.
	   *
	   * @param {Object...} objects
	   * @throws {Error} if not called on a top level GUI.
	   * @instance
	   */
	  remember: function remember() {
	    if (_common2.default.isUndefined(SAVE_DIALOGUE)) {
	      SAVE_DIALOGUE = new _CenteredDiv2.default();
	      SAVE_DIALOGUE.domElement.innerHTML = _saveDialogue2.default;
	    }

	    if (this.parent) {
	      throw new Error('You can only call remember on a top level GUI.');
	    }

	    var _this = this;

	    _common2.default.each(Array.prototype.slice.call(arguments), function (object) {
	      if (_this.__rememberedObjects.length === 0) {
	        addSaveMenu(_this);
	      }
	      if (_this.__rememberedObjects.indexOf(object) === -1) {
	        _this.__rememberedObjects.push(object);
	      }
	    });

	    if (this.autoPlace) {
	      // Set save row width
	      setWidth(this, this.width);
	    }
	  },

	  /**
	   * @returns {dat.gui.GUI} the topmost parent GUI of a nested GUI.
	   * @instance
	   */
	  getRoot: function getRoot() {
	    var gui = this;
	    while (gui.parent) {
	      gui = gui.parent;
	    }
	    return gui;
	  },

	  /**
	   * @returns {Object} a JSON object representing the current state of
	   * this GUI as well as its remembered properties.
	   * @instance
	   */
	  getSaveObject: function getSaveObject() {
	    var toReturn = this.load;
	    toReturn.closed = this.closed;

	    // Am I remembering any values?
	    if (this.__rememberedObjects.length > 0) {
	      toReturn.preset = this.preset;

	      if (!toReturn.remembered) {
	        toReturn.remembered = {};
	      }

	      toReturn.remembered[this.preset] = getCurrentPreset(this);
	    }

	    toReturn.folders = {};
	    _common2.default.each(this.__folders, function (element, key) {
	      toReturn.folders[key] = element.getSaveObject();
	    });

	    return toReturn;
	  },

	  save: function save() {
	    if (!this.load.remembered) {
	      this.load.remembered = {};
	    }

	    this.load.remembered[this.preset] = getCurrentPreset(this);
	    markPresetModified(this, false);
	    this.saveToLocalStorageIfPossible();
	  },

	  saveAs: function saveAs(presetName) {
	    if (!this.load.remembered) {
	      // Retain default values upon first save
	      this.load.remembered = {};
	      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);
	    }

	    this.load.remembered[presetName] = getCurrentPreset(this);
	    this.preset = presetName;
	    addPresetOption(this, presetName, true);
	    this.saveToLocalStorageIfPossible();
	  },

	  revert: function revert(gui) {
	    _common2.default.each(this.__controllers, function (controller) {
	      // Make revert work on Default.
	      if (!this.getRoot().load.remembered) {
	        controller.setValue(controller.initialValue);
	      } else {
	        recallSavedValue(gui || this.getRoot(), controller);
	      }

	      // fire onFinishChange callback
	      if (controller.__onFinishChange) {
	        controller.__onFinishChange.call(controller, controller.getValue());
	      }
	    }, this);

	    _common2.default.each(this.__folders, function (folder) {
	      folder.revert(folder);
	    });

	    if (!gui) {
	      markPresetModified(this.getRoot(), false);
	    }
	  },

	  listen: function listen(controller) {
	    var init = this.__listening.length === 0;
	    this.__listening.push(controller);
	    if (init) {
	      updateDisplays(this.__listening);
	    }
	  },

	  updateDisplay: function updateDisplay() {
	    _common2.default.each(this.__controllers, function (controller) {
	      controller.updateDisplay();
	    });
	    _common2.default.each(this.__folders, function (folder) {
	      folder.updateDisplay();
	    });
	  }
	});

	/**
	 * Add a row to the end of the GUI or before another row.
	 *
	 * @param gui
	 * @param [newDom] If specified, inserts the dom content in the new row
	 * @param [liBefore] If specified, places the new row before another row
	 */
	function addRow(gui, newDom, liBefore) {
	  var li = document.createElement('li');
	  if (newDom) {
	    li.appendChild(newDom);
	  }

	  if (liBefore) {
	    gui.__ul.insertBefore(li, liBefore);
	  } else {
	    gui.__ul.appendChild(li);
	  }
	  gui.onResize();
	  return li;
	}

	function markPresetModified(gui, modified) {
	  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];

	  // console.log('mark', modified, opt);
	  if (modified) {
	    opt.innerHTML = opt.value + '*';
	  } else {
	    opt.innerHTML = opt.value;
	  }
	}

	function augmentController(gui, li, controller) {
	  controller.__li = li;
	  controller.__gui = gui;

	  _common2.default.extend(controller, {
	    options: function options(_options) {
	      if (arguments.length > 1) {
	        var nextSibling = controller.__li.nextElementSibling;
	        controller.remove();

	        return _add(gui, controller.object, controller.property, {
	          before: nextSibling,
	          factoryArgs: [_common2.default.toArray(arguments)]
	        });
	      }

	      if (_common2.default.isArray(_options) || _common2.default.isObject(_options)) {
	        var _nextSibling = controller.__li.nextElementSibling;
	        controller.remove();

	        return _add(gui, controller.object, controller.property, {
	          before: _nextSibling,
	          factoryArgs: [_options]
	        });
	      }
	    },

	    name: function name(v) {
	      controller.__li.firstElementChild.firstElementChild.innerHTML = v;
	      return controller;
	    },

	    listen: function listen() {
	      controller.__gui.listen(controller);
	      return controller;
	    },

	    remove: function remove() {
	      controller.__gui.remove(controller);
	      return controller;
	    }
	  });

	  // All sliders should be accompanied by a box.
	  if (controller instanceof _NumberControllerSlider2.default) {
	    (function () {
	      var box = new _NumberControllerBox2.default(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });

	      _common2.default.each(['updateDisplay', 'onChange', 'onFinishChange', 'step'], function (method) {
	        var pc = controller[method];
	        var pb = box[method];
	        controller[method] = box[method] = function () {
	          var args = Array.prototype.slice.call(arguments);
	          pb.apply(box, args);
	          return pc.apply(controller, args);
	        };
	      });

	      _dom2.default.addClass(li, 'has-slider');
	      controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);
	    })();
	  } else if (controller instanceof _NumberControllerBox2.default) {
	    var r = function r(returned) {
	      // Have we defined both boundaries?
	      if (_common2.default.isNumber(controller.__min) && _common2.default.isNumber(controller.__max)) {
	        // Well, then lets just replace this with a slider.

	        // lets remember if the old controller had a specific name or was listening
	        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;
	        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;

	        controller.remove();
	        var newController = _add(gui, controller.object, controller.property, {
	          before: controller.__li.nextElementSibling,
	          factoryArgs: [controller.__min, controller.__max, controller.__step]
	        });

	        newController.name(oldName);
	        if (wasListening) newController.listen();

	        return newController;
	      }

	      return returned;
	    };

	    controller.min = _common2.default.compose(r, controller.min);
	    controller.max = _common2.default.compose(r, controller.max);
	  } else if (controller instanceof _BooleanController2.default) {
	    _dom2.default.bind(li, 'click', function () {
	      _dom2.default.fakeEvent(controller.__checkbox, 'click');
	    });

	    _dom2.default.bind(controller.__checkbox, 'click', function (e) {
	      e.stopPropagation(); // Prevents double-toggle
	    });
	  } else if (controller instanceof _FunctionController2.default) {
	    _dom2.default.bind(li, 'click', function () {
	      _dom2.default.fakeEvent(controller.__button, 'click');
	    });

	    _dom2.default.bind(li, 'mouseover', function () {
	      _dom2.default.addClass(controller.__button, 'hover');
	    });

	    _dom2.default.bind(li, 'mouseout', function () {
	      _dom2.default.removeClass(controller.__button, 'hover');
	    });
	  } else if (controller instanceof _ColorController2.default) {
	    _dom2.default.addClass(li, 'color');
	    controller.updateDisplay = _common2.default.compose(function (val) {
	      li.style.borderLeftColor = controller.__color.toString();
	      return val;
	    }, controller.updateDisplay);

	    controller.updateDisplay();
	  }

	  controller.setValue = _common2.default.compose(function (val) {
	    if (gui.getRoot().__preset_select && controller.isModified()) {
	      markPresetModified(gui.getRoot(), true);
	    }

	    return val;
	  }, controller.setValue);
	}

	function recallSavedValue(gui, controller) {
	  // Find the topmost GUI, that's where remembered objects live.
	  var root = gui.getRoot();

	  // Does the object we're controlling match anything we've been told to
	  // remember?
	  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);

	  // Why yes, it does!
	  if (matchedIndex !== -1) {
	    // Let me fetch a map of controllers for thcommon.isObject.
	    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];

	    // Ohp, I believe this is the first controller we've created for this
	    // object. Lets make the map fresh.
	    if (controllerMap === undefined) {
	      controllerMap = {};
	      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;
	    }

	    // Keep track of this controller
	    controllerMap[controller.property] = controller;

	    // Okay, now have we saved any values for this controller?
	    if (root.load && root.load.remembered) {
	      var presetMap = root.load.remembered;

	      // Which preset are we trying to load?
	      var preset = void 0;

	      if (presetMap[gui.preset]) {
	        preset = presetMap[gui.preset];
	      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {
	        // Uhh, you can have the default instead?
	        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];
	      } else {
	        // Nada.
	        return;
	      }

	      // Did the loaded object remember thcommon.isObject? &&  Did we remember this particular property?
	      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {
	        // We did remember something for this guy ...
	        var value = preset[matchedIndex][controller.property];

	        // And that's what it is.
	        controller.initialValue = value;
	        controller.setValue(value);
	      }
	    }
	  }
	}

	function _add(gui, object, property, params) {
	  if (object[property] === undefined) {
	    throw new Error('Object "' + object + '" has no property "' + property + '"');
	  }

	  var controller = void 0;

	  if (params.color) {
	    controller = new _ColorController2.default(object, property);
	  } else {
	    var factoryArgs = [object, property].concat(params.factoryArgs);
	    controller = _ControllerFactory2.default.apply(gui, factoryArgs);
	  }

	  if (params.before instanceof _Controller2.default) {
	    params.before = params.before.__li;
	  }

	  recallSavedValue(gui, controller);

	  _dom2.default.addClass(controller.domElement, 'c');

	  var name = document.createElement('span');
	  _dom2.default.addClass(name, 'property-name');
	  name.innerHTML = controller.property;

	  var container = document.createElement('div');
	  container.appendChild(name);
	  container.appendChild(controller.domElement);

	  var li = addRow(gui, container, params.before);

	  _dom2.default.addClass(li, GUI.CLASS_CONTROLLER_ROW);
	  if (controller instanceof _ColorController2.default) {
	    _dom2.default.addClass(li, 'color');
	  } else {
	    _dom2.default.addClass(li, _typeof(controller.getValue()));
	  }

	  augmentController(gui, li, controller);

	  gui.__controllers.push(controller);

	  return controller;
	}

	function getLocalStorageHash(gui, key) {
	  // TODO how does this deal with multiple GUI's?
	  return document.location.href + '.' + key;
	}

	function addPresetOption(gui, name, setSelected) {
	  var opt = document.createElement('option');
	  opt.innerHTML = name;
	  opt.value = name;
	  gui.__preset_select.appendChild(opt);
	  if (setSelected) {
	    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;
	  }
	}

	function showHideExplain(gui, explain) {
	  explain.style.display = gui.useLocalStorage ? 'block' : 'none';
	}

	function addSaveMenu(gui) {
	  var div = gui.__save_row = document.createElement('li');

	  _dom2.default.addClass(gui.domElement, 'has-save');

	  gui.__ul.insertBefore(div, gui.__ul.firstChild);

	  _dom2.default.addClass(div, 'save-row');

	  var gears = document.createElement('span');
	  gears.innerHTML = '&nbsp;';
	  _dom2.default.addClass(gears, 'button gears');

	  // TODO replace with FunctionController
	  var button = document.createElement('span');
	  button.innerHTML = 'Save';
	  _dom2.default.addClass(button, 'button');
	  _dom2.default.addClass(button, 'save');

	  var button2 = document.createElement('span');
	  button2.innerHTML = 'New';
	  _dom2.default.addClass(button2, 'button');
	  _dom2.default.addClass(button2, 'save-as');

	  var button3 = document.createElement('span');
	  button3.innerHTML = 'Revert';
	  _dom2.default.addClass(button3, 'button');
	  _dom2.default.addClass(button3, 'revert');

	  var select = gui.__preset_select = document.createElement('select');

	  if (gui.load && gui.load.remembered) {
	    _common2.default.each(gui.load.remembered, function (value, key) {
	      addPresetOption(gui, key, key === gui.preset);
	    });
	  } else {
	    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);
	  }

	  _dom2.default.bind(select, 'change', function () {
	    for (var index = 0; index < gui.__preset_select.length; index++) {
	      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;
	    }

	    gui.preset = this.value;
	  });

	  div.appendChild(select);
	  div.appendChild(gears);
	  div.appendChild(button);
	  div.appendChild(button2);
	  div.appendChild(button3);

	  if (SUPPORTS_LOCAL_STORAGE) {
	    (function () {
	      var explain = document.getElementById('dg-local-explain');
	      var localStorageCheckBox = document.getElementById('dg-local-storage');
	      var saveLocally = document.getElementById('dg-save-locally');

	      saveLocally.style.display = 'block';

	      if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {
	        localStorageCheckBox.setAttribute('checked', 'checked');
	      }

	      showHideExplain(gui, explain);

	      // TODO: Use a boolean controller, fool!
	      _dom2.default.bind(localStorageCheckBox, 'change', function () {
	        gui.useLocalStorage = !gui.useLocalStorage;
	        showHideExplain(gui, explain);
	      });
	    })();
	  }

	  var newConstructorTextArea = document.getElementById('dg-new-constructor');

	  _dom2.default.bind(newConstructorTextArea, 'keydown', function (e) {
	    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {
	      SAVE_DIALOGUE.hide();
	    }
	  });

	  _dom2.default.bind(gears, 'click', function () {
	    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);
	    SAVE_DIALOGUE.show();
	    newConstructorTextArea.focus();
	    newConstructorTextArea.select();
	  });

	  _dom2.default.bind(button, 'click', function () {
	    gui.save();
	  });

	  _dom2.default.bind(button2, 'click', function () {
	    var presetName = prompt('Enter a new preset name.');
	    if (presetName) {
	      gui.saveAs(presetName);
	    }
	  });

	  _dom2.default.bind(button3, 'click', function () {
	    gui.revert();
	  });

	  // div.appendChild(button2);
	}

	function addResizeHandle(gui) {
	  var pmouseX = void 0;

	  gui.__resize_handle = document.createElement('div');

	  _common2.default.extend(gui.__resize_handle.style, {

	    width: '6px',
	    marginLeft: '-3px',
	    height: '200px',
	    cursor: 'ew-resize',
	    position: 'absolute'
	    // border: '1px solid blue'

	  });

	  function drag(e) {
	    e.preventDefault();

	    gui.width += pmouseX - e.clientX;
	    gui.onResize();
	    pmouseX = e.clientX;

	    return false;
	  }

	  function dragStop() {
	    _dom2.default.removeClass(gui.__closeButton, GUI.CLASS_DRAG);
	    _dom2.default.unbind(document, 'mousemove', drag);
	    _dom2.default.unbind(document, 'mouseup', dragStop);
	  }

	  function dragStart(e) {
	    e.preventDefault();

	    pmouseX = e.clientX;

	    _dom2.default.addClass(gui.__closeButton, GUI.CLASS_DRAG);
	    _dom2.default.bind(document, 'mousemove', drag);
	    _dom2.default.bind(document, 'mouseup', dragStop);

	    return false;
	  }

	  _dom2.default.bind(gui.__resize_handle, 'mousedown', dragStart);
	  _dom2.default.bind(gui.__closeButton, 'mousedown', dragStart);

	  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);
	}

	function setWidth(gui, w) {
	  gui.domElement.style.width = w + 'px';
	  // Auto placed save-rows are position fixed, so we have to
	  // set the width manually if we want it to bleed to the edge
	  if (gui.__save_row && gui.autoPlace) {
	    gui.__save_row.style.width = w + 'px';
	  }
	  if (gui.__closeButton) {
	    gui.__closeButton.style.width = w + 'px';
	  }
	}

	function getCurrentPreset(gui, useInitialValues) {
	  var toReturn = {};

	  // For each object I'm remembering
	  _common2.default.each(gui.__rememberedObjects, function (val, index) {
	    var savedValues = {};

	    // The controllers I've made for thcommon.isObject by property
	    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];

	    // Remember each value for each property
	    _common2.default.each(controllerMap, function (controller, property) {
	      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();
	    });

	    // Save the values for thcommon.isObject
	    toReturn[index] = savedValues;
	  });

	  return toReturn;
	}

	function setPresetSelectIndex(gui) {
	  for (var index = 0; index < gui.__preset_select.length; index++) {
	    if (gui.__preset_select[index].value === gui.preset) {
	      gui.__preset_select.selectedIndex = index;
	    }
	  }
	}

	function updateDisplays(controllerArray) {
	  if (controllerArray.length !== 0) {
	    _requestAnimationFrame2.default.call(window, function () {
	      updateDisplays(controllerArray);
	    });
	  }

	  _common2.default.each(controllerArray, function (c) {
	    c.updateDisplay();
	  });
	}

	module.exports = GUI;

/***/ },
/* 18 */
/***/ function(module, exports) {

	'use strict';

	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	module.exports = {
	  load: function load(url, indoc) {
	    var doc = indoc || document;
	    var link = doc.createElement('link');
	    link.type = 'text/css';
	    link.rel = 'stylesheet';
	    link.href = url;
	    doc.getElementsByTagName('head')[0].appendChild(link);
	  },

	  inject: function inject(css, indoc) {
	    var doc = indoc || document;
	    var injected = document.createElement('style');
	    injected.type = 'text/css';
	    injected.innerHTML = css;
	    var head = doc.getElementsByTagName('head')[0];
	    try {
	      head.appendChild(injected);
	    } catch (e) {// Unable to inject CSS, probably because of a Content Security Policy
	    }
	  }
	};

/***/ },
/* 19 */
/***/ function(module, exports) {

	module.exports = "<div id=\"dg-save\" class=\"dg dialogue\">\n\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\n\n  <textarea id=\"dg-new-constructor\"></textarea>\n\n  <div id=\"dg-save-locally\">\n\n    <input id=\"dg-local-storage\" type=\"checkbox\"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id=\"dg-local-explain\">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>";

/***/ },
/* 20 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _OptionController = __webpack_require__(10);

	var _OptionController2 = _interopRequireDefault(_OptionController);

	var _NumberControllerBox = __webpack_require__(13);

	var _NumberControllerBox2 = _interopRequireDefault(_NumberControllerBox);

	var _NumberControllerSlider = __webpack_require__(14);

	var _NumberControllerSlider2 = _interopRequireDefault(_NumberControllerSlider);

	var _StringController = __webpack_require__(11);

	var _StringController2 = _interopRequireDefault(_StringController);

	var _FunctionController = __webpack_require__(15);

	var _FunctionController2 = _interopRequireDefault(_FunctionController);

	var _BooleanController = __webpack_require__(8);

	var _BooleanController2 = _interopRequireDefault(_BooleanController);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	var ControllerFactory = function ControllerFactory(object, property) {
	  var initialValue = object[property];

	  // Providing options?
	  if (_common2.default.isArray(arguments[2]) || _common2.default.isObject(arguments[2])) {
	    return new _OptionController2.default(object, property, arguments[2]);
	  }

	  // Providing a map?
	  if (_common2.default.isNumber(initialValue)) {
	    // Has min and max? (slider)
	    if (_common2.default.isNumber(arguments[2]) && _common2.default.isNumber(arguments[3])) {
	      // has step?
	      if (_common2.default.isNumber(arguments[4])) {
	        return new _NumberControllerSlider2.default(object, property, arguments[2], arguments[3], arguments[4]);
	      }

	      return new _NumberControllerSlider2.default(object, property, arguments[2], arguments[3]);
	    }

	    // number box
	    if (_common2.default.isNumber(arguments[4])) {
	      // has step
	      return new _NumberControllerBox2.default(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });
	    }
	    return new _NumberControllerBox2.default(object, property, { min: arguments[2], max: arguments[3] });
	  }

	  if (_common2.default.isString(initialValue)) {
	    return new _StringController2.default(object, property);
	  }

	  if (_common2.default.isFunction(initialValue)) {
	    return new _FunctionController2.default(object, property, '');
	  }

	  if (_common2.default.isBoolean(initialValue)) {
	    return new _BooleanController2.default(object, property);
	  }

	  return null;
	}; /**
	    * dat-gui JavaScript Controller Library
	    * http://code.google.com/p/dat-gui
	    *
	    * Copyright 2011 Data Arts Team, Google Creative Lab
	    *
	    * Licensed under the Apache License, Version 2.0 (the "License");
	    * you may not use this file except in compliance with the License.
	    * You may obtain a copy of the License at
	    *
	    * http://www.apache.org/licenses/LICENSE-2.0
	    */

	exports.default = ControllerFactory;

/***/ },
/* 21 */
/***/ function(module, exports) {

	"use strict";

	exports.__esModule = true;
	/**
	 * dat-gui JavaScript Controller Library
	 * http://code.google.com/p/dat-gui
	 *
	 * Copyright 2011 Data Arts Team, Google Creative Lab
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * http://www.apache.org/licenses/LICENSE-2.0
	 */

	function requestAnimationFrame(callback) {
	  setTimeout(callback, 1000 / 60);
	}

	exports.default = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;

/***/ },
/* 22 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	exports.__esModule = true;

	var _dom = __webpack_require__(9);

	var _dom2 = _interopRequireDefault(_dom);

	var _common = __webpack_require__(5);

	var _common2 = _interopRequireDefault(_common);

	function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } } /**
	                                                                                                                                                           * dat-gui JavaScript Controller Library
	                                                                                                                                                           * http://code.google.com/p/dat-gui
	                                                                                                                                                           *
	                                                                                                                                                           * Copyright 2011 Data Arts Team, Google Creative Lab
	                                                                                                                                                           *
	                                                                                                                                                           * Licensed under the Apache License, Version 2.0 (the "License");
	                                                                                                                                                           * you may not use this file except in compliance with the License.
	                                                                                                                                                           * You may obtain a copy of the License at
	                                                                                                                                                           *
	                                                                                                                                                           * http://www.apache.org/licenses/LICENSE-2.0
	                                                                                                                                                           */

	var CenteredDiv = function () {
	  function CenteredDiv() {
	    _classCallCheck(this, CenteredDiv);

	    this.backgroundElement = document.createElement('div');
	    _common2.default.extend(this.backgroundElement.style, {
	      backgroundColor: 'rgba(0,0,0,0.8)',
	      top: 0,
	      left: 0,
	      display: 'none',
	      zIndex: '1000',
	      opacity: 0,
	      WebkitTransition: 'opacity 0.2s linear',
	      transition: 'opacity 0.2s linear'
	    });

	    _dom2.default.makeFullscreen(this.backgroundElement);
	    this.backgroundElement.style.position = 'fixed';

	    this.domElement = document.createElement('div');
	    _common2.default.extend(this.domElement.style, {
	      position: 'fixed',
	      display: 'none',
	      zIndex: '1001',
	      opacity: 0,
	      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',
	      transition: 'transform 0.2s ease-out, opacity 0.2s linear'
	    });

	    document.body.appendChild(this.backgroundElement);
	    document.body.appendChild(this.domElement);

	    var _this = this;
	    _dom2.default.bind(this.backgroundElement, 'click', function () {
	      _this.hide();
	    });
	  }

	  CenteredDiv.prototype.show = function show() {
	    var _this = this;

	    this.backgroundElement.style.display = 'block';

	    this.domElement.style.display = 'block';
	    this.domElement.style.opacity = 0;
	    //    this.domElement.style.top = '52%';
	    this.domElement.style.webkitTransform = 'scale(1.1)';

	    this.layout();

	    _common2.default.defer(function () {
	      _this.backgroundElement.style.opacity = 1;
	      _this.domElement.style.opacity = 1;
	      _this.domElement.style.webkitTransform = 'scale(1)';
	    });
	  };

	  /**
	   * Hide centered div
	   */


	  CenteredDiv.prototype.hide = function hide() {
	    var _this = this;

	    var hide = function hide() {
	      _this.domElement.style.display = 'none';
	      _this.backgroundElement.style.display = 'none';

	      _dom2.default.unbind(_this.domElement, 'webkitTransitionEnd', hide);
	      _dom2.default.unbind(_this.domElement, 'transitionend', hide);
	      _dom2.default.unbind(_this.domElement, 'oTransitionEnd', hide);
	    };

	    _dom2.default.bind(this.domElement, 'webkitTransitionEnd', hide);
	    _dom2.default.bind(this.domElement, 'transitionend', hide);
	    _dom2.default.bind(this.domElement, 'oTransitionEnd', hide);

	    this.backgroundElement.style.opacity = 0;
	    //    this.domElement.style.top = '48%';
	    this.domElement.style.opacity = 0;
	    this.domElement.style.webkitTransform = 'scale(1.1)';
	  };

	  CenteredDiv.prototype.layout = function layout() {
	    this.domElement.style.left = window.innerWidth / 2 - _dom2.default.getWidth(this.domElement) / 2 + 'px';
	    this.domElement.style.top = window.innerHeight / 2 - _dom2.default.getHeight(this.domElement) / 2 + 'px';
	  };

	  return CenteredDiv;
	}();

	exports.default = CenteredDiv;

/***/ },
/* 23 */
/***/ function(module, exports, __webpack_require__) {

	exports = module.exports = __webpack_require__(24)();
	// imports


	// module
	exports.push([module.id, ".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid transparent; }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.color {\n    border-left: 3px solid; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2FA1D6; }\n    .dg .cr.number input[type=text] {\n      color: #2FA1D6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2FA1D6;\n    max-width: 100%; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n", ""]);

	// exports


/***/ },
/* 24 */
/***/ function(module, exports) {

	/*
		MIT License http://www.opensource.org/licenses/mit-license.php
		Author Tobias Koppers @sokra
	*/
	// css base code, injected by the css-loader
	module.exports = function() {
		var list = [];

		// return the list of modules as css string
		list.toString = function toString() {
			var result = [];
			for(var i = 0; i < this.length; i++) {
				var item = this[i];
				if(item[2]) {
					result.push("@media " + item[2] + "{" + item[1] + "}");
				} else {
					result.push(item[1]);
				}
			}
			return result.join("");
		};

		// import a list of modules into the list
		list.i = function(modules, mediaQuery) {
			if(typeof modules === "string")
				modules = [[null, modules, ""]];
			var alreadyImportedModules = {};
			for(var i = 0; i < this.length; i++) {
				var id = this[i][0];
				if(typeof id === "number")
					alreadyImportedModules[id] = true;
			}
			for(i = 0; i < modules.length; i++) {
				var item = modules[i];
				// skip already imported module
				// this implementation is not 100% perfect for weird media query combinations
				//  when a module is imported multiple times with different media queries.
				//  I hope this will never occur (Hey this way we have smaller bundles)
				if(typeof item[0] !== "number" || !alreadyImportedModules[item[0]]) {
					if(mediaQuery && !item[2]) {
						item[2] = mediaQuery;
					} else if(mediaQuery) {
						item[2] = "(" + item[2] + ") and (" + mediaQuery + ")";
					}
					list.push(item);
				}
			}
		};
		return list;
	};


/***/ }
/******/ ])
});
;
//# sourceMappingURL=dat.gui.js.map;
/**
 * Tween.js - Licensed under the MIT license
 * https://github.com/tweenjs/tween.js
 * ----------------------------------------------
 *
 * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.
 * Thank you all, you're awesome!
 */

var TWEEN = TWEEN || (function () {

	var _tweens = [];

	return {

		getAll: function () {

			return _tweens;

		},

		removeAll: function () {

			_tweens = [];

		},

		add: function (tween) {

			_tweens.push(tween);

		},

		remove: function (tween) {

			var i = _tweens.indexOf(tween);

			if (i !== -1) {
				_tweens.splice(i, 1);
			}

		},

		update: function (time, preserve) {

			if (_tweens.length === 0) {
				return false;
			}

			var i = 0;

			time = time !== undefined ? time : TWEEN.now();

			while (i < _tweens.length) {

				if (_tweens[i].update(time) || preserve) {
					i++;
				} else {
					_tweens.splice(i, 1);
				}

			}

			return true;

		}
	};

})();


// Include a performance.now polyfill.
// In node.js, use process.hrtime.
if (typeof (window) === 'undefined' && typeof (process) !== 'undefined') {
	TWEEN.now = function () {
		var time = process.hrtime();

		// Convert [seconds, nanoseconds] to milliseconds.
		return time[0] * 1000 + time[1] / 1000000;
	};
}
// In a browser, use window.performance.now if it is available.
else if (typeof (window) !== 'undefined' &&
         window.performance !== undefined &&
		 window.performance.now !== undefined) {
	// This must be bound, because directly assigning this function
	// leads to an invocation exception in Chrome.
	TWEEN.now = window.performance.now.bind(window.performance);
}
// Use Date.now if it is available.
else if (Date.now !== undefined) {
	TWEEN.now = Date.now;
}
// Otherwise, use 'new Date().getTime()'.
else {
	TWEEN.now = function () {
		return new Date().getTime();
	};
}


TWEEN.Tween = function (object) {

	var _object = object;
	var _valuesStart = {};
	var _valuesEnd = {};
	var _valuesStartRepeat = {};
	var _duration = 1000;
	var _repeat = 0;
	var _repeatDelayTime;
	var _yoyo = false;
	var _isPlaying = false;
	var _reversed = false;
	var _delayTime = 0;
	var _startTime = null;
	var _easingFunction = TWEEN.Easing.Linear.None;
	var _interpolationFunction = TWEEN.Interpolation.Linear;
	var _chainedTweens = [];
	var _onStartCallback = null;
	var _onStartCallbackFired = false;
	var _onUpdateCallback = null;
	var _onCompleteCallback = null;
	var _onStopCallback = null;

	this.to = function (properties, duration) {

		_valuesEnd = properties;

		if (duration !== undefined) {
			_duration = duration;
		}

		return this;

	};

	this.start = function (time) {

		TWEEN.add(this);

		_isPlaying = true;

		_onStartCallbackFired = false;

		_startTime = time !== undefined ? time : TWEEN.now();
		_startTime += _delayTime;

		for (var property in _valuesEnd) {

			// Check if an Array was provided as property value
			if (_valuesEnd[property] instanceof Array) {

				if (_valuesEnd[property].length === 0) {
					continue;
				}

				// Create a local copy of the Array with the start value at the front
				_valuesEnd[property] = [_object[property]].concat(_valuesEnd[property]);

			}

			// If `to()` specifies a property that doesn't exist in the source object,
			// we should not set that property in the object
			if (_object[property] === undefined) {
				continue;
			}

			// Save the starting value.
			_valuesStart[property] = _object[property];

			if ((_valuesStart[property] instanceof Array) === false) {
				_valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings
			}

			_valuesStartRepeat[property] = _valuesStart[property] || 0;

		}

		return this;

	};

	this.stop = function () {

		if (!_isPlaying) {
			return this;
		}

		TWEEN.remove(this);
		_isPlaying = false;

		if (_onStopCallback !== null) {
			_onStopCallback.call(_object, _object);
		}

		this.stopChainedTweens();
		return this;

	};

	this.end = function () {

		this.update(_startTime + _duration);
		return this;

	};

	this.stopChainedTweens = function () {

		for (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {
			_chainedTweens[i].stop();
		}

	};

	this.delay = function (amount) {

		_delayTime = amount;
		return this;

	};

	this.repeat = function (times) {

		_repeat = times;
		return this;

	};

	this.repeatDelay = function (amount) {

		_repeatDelayTime = amount;
		return this;

	};

	this.yoyo = function (yoyo) {

		_yoyo = yoyo;
		return this;

	};


	this.easing = function (easing) {

		_easingFunction = easing;
		return this;

	};

	this.interpolation = function (interpolation) {

		_interpolationFunction = interpolation;
		return this;

	};

	this.chain = function () {

		_chainedTweens = arguments;
		return this;

	};

	this.onStart = function (callback) {

		_onStartCallback = callback;
		return this;

	};

	this.onUpdate = function (callback) {

		_onUpdateCallback = callback;
		return this;

	};

	this.onComplete = function (callback) {

		_onCompleteCallback = callback;
		return this;

	};

	this.onStop = function (callback) {

		_onStopCallback = callback;
		return this;

	};

	this.update = function (time) {

		var property;
		var elapsed;
		var value;

		if (time < _startTime) {
			return true;
		}

		if (_onStartCallbackFired === false) {

			if (_onStartCallback !== null) {
				_onStartCallback.call(_object, _object);
			}

			_onStartCallbackFired = true;
		}

		elapsed = (time - _startTime) / _duration;
		elapsed = elapsed > 1 ? 1 : elapsed;

		value = _easingFunction(elapsed);

		for (property in _valuesEnd) {

			// Don't update properties that do not exist in the source object
			if (_valuesStart[property] === undefined) {
				continue;
			}

			var start = _valuesStart[property] || 0;
			var end = _valuesEnd[property];

			if (end instanceof Array) {

				_object[property] = _interpolationFunction(end, value);

			} else {

				// Parses relative end values with start as base (e.g.: +10, -3)
				if (typeof (end) === 'string') {

					if (end.charAt(0) === '+' || end.charAt(0) === '-') {
						end = start + parseFloat(end);
					} else {
						end = parseFloat(end);
					}
				}

				// Protect against non numeric properties.
				if (typeof (end) === 'number') {
					_object[property] = start + (end - start) * value;
				}

			}

		}

		if (_onUpdateCallback !== null) {
			_onUpdateCallback.call(_object, value);
		}

		if (elapsed === 1) {

			if (_repeat > 0) {

				if (isFinite(_repeat)) {
					_repeat--;
				}

				// Reassign starting values, restart by making startTime = now
				for (property in _valuesStartRepeat) {

					if (typeof (_valuesEnd[property]) === 'string') {
						_valuesStartRepeat[property] = _valuesStartRepeat[property] + parseFloat(_valuesEnd[property]);
					}

					if (_yoyo) {
						var tmp = _valuesStartRepeat[property];

						_valuesStartRepeat[property] = _valuesEnd[property];
						_valuesEnd[property] = tmp;
					}

					_valuesStart[property] = _valuesStartRepeat[property];

				}

				if (_yoyo) {
					_reversed = !_reversed;
				}

				if (_repeatDelayTime !== undefined) {
					_startTime = time + _repeatDelayTime;
				} else {
					_startTime = time + _delayTime;
				}

				return true;

			} else {

				if (_onCompleteCallback !== null) {

					_onCompleteCallback.call(_object, _object);
				}

				for (var i = 0, numChainedTweens = _chainedTweens.length; i < numChainedTweens; i++) {
					// Make the chained tweens start exactly at the time they should,
					// even if the `update()` method was called way past the duration of the tween
					_chainedTweens[i].start(_startTime + _duration);
				}

				return false;

			}

		}

		return true;

	};

};


TWEEN.Easing = {

	Linear: {

		None: function (k) {

			return k;

		}

	},

	Quadratic: {

		In: function (k) {

			return k * k;

		},

		Out: function (k) {

			return k * (2 - k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k;
			}

			return - 0.5 * (--k * (k - 2) - 1);

		}

	},

	Cubic: {

		In: function (k) {

			return k * k * k;

		},

		Out: function (k) {

			return --k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k + 2);

		}

	},

	Quartic: {

		In: function (k) {

			return k * k * k * k;

		},

		Out: function (k) {

			return 1 - (--k * k * k * k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k;
			}

			return - 0.5 * ((k -= 2) * k * k * k - 2);

		}

	},

	Quintic: {

		In: function (k) {

			return k * k * k * k * k;

		},

		Out: function (k) {

			return --k * k * k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k * k * k + 2);

		}

	},

	Sinusoidal: {

		In: function (k) {

			return 1 - Math.cos(k * Math.PI / 2);

		},

		Out: function (k) {

			return Math.sin(k * Math.PI / 2);

		},

		InOut: function (k) {

			return 0.5 * (1 - Math.cos(Math.PI * k));

		}

	},

	Exponential: {

		In: function (k) {

			return k === 0 ? 0 : Math.pow(1024, k - 1);

		},

		Out: function (k) {

			return k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			if ((k *= 2) < 1) {
				return 0.5 * Math.pow(1024, k - 1);
			}

			return 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);

		}

	},

	Circular: {

		In: function (k) {

			return 1 - Math.sqrt(1 - k * k);

		},

		Out: function (k) {

			return Math.sqrt(1 - (--k * k));

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return - 0.5 * (Math.sqrt(1 - k * k) - 1);
			}

			return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);

		}

	},

	Elastic: {

		In: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);

		},

		Out: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			k *= 2;

			if (k < 1) {
				return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);
			}

			return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;

		}

	},

	Back: {

		In: function (k) {

			var s = 1.70158;

			return k * k * ((s + 1) * k - s);

		},

		Out: function (k) {

			var s = 1.70158;

			return --k * k * ((s + 1) * k + s) + 1;

		},

		InOut: function (k) {

			var s = 1.70158 * 1.525;

			if ((k *= 2) < 1) {
				return 0.5 * (k * k * ((s + 1) * k - s));
			}

			return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);

		}

	},

	Bounce: {

		In: function (k) {

			return 1 - TWEEN.Easing.Bounce.Out(1 - k);

		},

		Out: function (k) {

			if (k < (1 / 2.75)) {
				return 7.5625 * k * k;
			} else if (k < (2 / 2.75)) {
				return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;
			} else if (k < (2.5 / 2.75)) {
				return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;
			} else {
				return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;
			}

		},

		InOut: function (k) {

			if (k < 0.5) {
				return TWEEN.Easing.Bounce.In(k * 2) * 0.5;
			}

			return TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;

		}

	}

};

TWEEN.Interpolation = {

	Linear: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.Linear;

		if (k < 0) {
			return fn(v[0], v[1], f);
		}

		if (k > 1) {
			return fn(v[m], v[m - 1], m - f);
		}

		return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);

	},

	Bezier: function (v, k) {

		var b = 0;
		var n = v.length - 1;
		var pw = Math.pow;
		var bn = TWEEN.Interpolation.Utils.Bernstein;

		for (var i = 0; i <= n; i++) {
			b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);
		}

		return b;

	},

	CatmullRom: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.CatmullRom;

		if (v[0] === v[m]) {

			if (k < 0) {
				i = Math.floor(f = m * (1 + k));
			}

			return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);

		} else {

			if (k < 0) {
				return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);
			}

			if (k > 1) {
				return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);
			}

			return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);

		}

	},

	Utils: {

		Linear: function (p0, p1, t) {

			return (p1 - p0) * t + p0;

		},

		Bernstein: function (n, i) {

			var fc = TWEEN.Interpolation.Utils.Factorial;

			return fc(n) / fc(i) / fc(n - i);

		},

		Factorial: (function () {

			var a = [1];

			return function (n) {

				var s = 1;

				if (a[n]) {
					return a[n];
				}

				for (var i = n; i > 1; i--) {
					s *= i;
				}

				a[n] = s;
				return s;

			};

		})(),

		CatmullRom: function (p0, p1, p2, p3, t) {

			var v0 = (p2 - p0) * 0.5;
			var v1 = (p3 - p1) * 0.5;
			var t2 = t * t;
			var t3 = t * t2;

			return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;

		}

	}

};

// UMD (Universal Module Definition)
(function (root) {

	if (typeof define === 'function' && define.amd) {

		// AMD
		define([], function () {
			return TWEEN;
		});

	} else if (typeof module !== 'undefined' && typeof exports === 'object') {

		// Node.js
		module.exports = TWEEN;

	} else if (root !== undefined) {

		// Global variable
		root.TWEEN = TWEEN;

	}

})(this);

/* crc: C1DF5B24E7680E62F64D7F90143866C4 */
